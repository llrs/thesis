[["index.html", "Data integration in inflammatory bowel disease Preface", " Data integration in inflammatory bowel disease Llus Revilla Sancho 2022-04-25 Preface The main topic of the thesis is data integration applied in the inflammatory bowel disease (IBD) research. This disease is complex, for instance it is not known if the cause behind Crohns disease and ulcerative colitis is the same. There are hypothesis pointing that the microbiome is a major factor in the disease, which together with an aberrant immune response is the dominant theory. In order to find robust relationships between the microbiome and the immune system it is important to consider all the relevant variables that influence a disease. On this thesis we seek these relationships using data from different sequencing technologies and the observed or reported phenotype of the patients. The thesis was carried out on the Institut dInvestigacions Biomdiques August Pi i Sunyer (IDIBAPS) research institute and funded by Centro de Investigacin Biomdica en Red (CIBER). The thesis was done on the IBD unit which is a translational team of biologist, microbiologists, veterinaries, bioinformaticians, doctors and nurses (at Hospital Clnic) in a multidisciplinary team. The leading doctor of the unit was Julian Pans whose interest on the disease made possible this thesis. The thesis is on the doctoral programme in biomedicine of the University of Barcelona (UB). My thesis directors were Juanjo Lozano and Azucena Salas, my boss, who helped as bioinformatician and disease expert respectively. They provided advice and guidance on how to analyse the data and where to focus on the different experiments/analysis. This thesis, available on https://thesis.llrs.dev is licensed under the Creative Commons Attribution 4.0 International License (CC-BY). "],["abstracts.html", "Abstracts English Spanish Catalan", " Abstracts English Introduction: Inflammatory bowel disease is a complex intestinal disease with several genetic and environmental factors that can influence its course. The ethiology and pathophysiology of the disease is not fully understood. There is some evidence that microbiome can play a role. Finding relationships between microbiome and hosts mucosa could help advance prevention, diagnosis or treatment. Methods: We based our analysis on intestinal bacterial 16S rRNA and human transcriptome data from biopsies from multiple timepoints and intestine segments. We extended regularized generalized canonical correlation analysis to find models that are coherent with previous knowledge on the disease taking into account the samples information. Multiple inflammatory bowel disease datasets on different treatments and conditions were analysed and the models defining those dataset were compared. The results were compared with multiple co-inertia analysis. Results: Splitting sample variables into different blocks results in models of these relationships that show differences on the genes and microorganisms selected. The models generated using our new method inteRmodel outperformed multiple co-inertia analysis to classify the samples according to their location. Despite being used on datasets of different sources the resulting models show similar relationships between variables. Discussion: Comparing multiple models helps find out the relationships within datasets. Our method finds how strong are the relationships between the microbiome, transcriptome and environmental variables. On different datasets genes selected were common. This approach is robust and flexible to different datasets and settings. Conclusion: With inteRmodel we found that the microbiome relates more closely to the sample location than to disease, but the transcriptome is highly related to the location of the sample on the intestine. There is a common transcriptome between datasets while microorganisms depend of the dataset. We can improve sample classification by taking into account both bacterial 16S rRNA and host transcriptome. Spanish Introduccin: La enfermedad inflamatoria intestinal es una enfermedad intestinal compleja con factores genticos y ambientales que pueden influir en su curso. La etiologa y la fisiopatologa de la enfermedad no se conocen por completo. Existen evidencias que el microbioma puede desempear un papel relevante. Encontrar relaciones entre el microbioma y la mucosa del husped podra ayudar a avanzar en la prevencin, el diagnstico o el tratamiento. Mtodos: Basamos nuestro anlisis en el ARNr 16S bacteriano intestinal y en datos de transcriptomas humanos de biopsias de mltiples puntos temporales y segmentos intestinales. Extendimos el anlisis de correlacin cannica generalizada regularizado para encontrar modelos coherentes con el conocimiento previo sobre la enfermedad teniendo en cuenta la informacin de las muestras. Se analizaron mltiples conjuntos de datos de enfermedad inflamatoria intestinal en diferentes tratamientos y condiciones y se compararon los modelos que definen esos conjuntos de datos. Los resultados se compararon con anlisis de coinercia mltiple. Resultados: Dividir las variables de la muestra en diferentes bloques resulta en modelos de estas relaciones que muestran diferencias en los genes y microorganismos seleccionados. Los modelos generados con nuestro nuevo mtodo, interRmodel, superaron el anlisis de mltiples coinercias para clasificar las muestras segn su ubicacin. A pesar de ser utilizados en conjuntos de datos de diferentes fuentes, los modelos resultantes muestran unas relaciones similares entre las variables. Discusin: La comparacin de varios modelos ayuda a descubrir las relaciones dentro de los conjuntos de datos. Nuestro mtodo encuentra cun fuertes son las relaciones entre el microbioma, el transcriptoma y las variables ambientales. En diferentes conjuntos de datos, los genes seleccionados eran comunes. Este enfoque es robusto y flexible para diferentes conjuntos de datos y configuraciones. Conclusin: Con inteRmodel descubrimos que el microbioma se relaciona ms estrechamente con la ubicacin de la muestra que con la enfermedad, pero el transcriptoma est muy relacionado con la ubicacin de la muestra en el intestino. Hay un transcriptoma comn entre los conjuntos de datos, mientras que los microorganismos dependen del conjunto de datos. Podemos mejorar la clasificacin de las muestras teniendo en cuenta tanto el ARNr 16S bacteriano como el transcriptoma del husped. Catalan Introducci: La malaltia inflamatria intestinal s una malaltia intestinal complexa amb diversos factors gentics i ambientals que poden influir en el seu curs. Letiologia i fisiopatologia de la malaltia no es conix del tot. Hi ha evidncies que el microbioma pot tenir un paper rellevant. Trobar relacions entre el microbioma i la mucosa de lhoste podria ajudar a avanar en la prevenci, el diagnstic o el tractament. Mtodes: Vam basar la nostra anlisi en dades dARNr 16S bacteriana intestinal i de transcriptoma hum de bipsies de mltiples punts de temps i segments intestinals. Hem ampliat lanlisi de correlaci cannica generalitzada regularitzada per trobar models coherents amb el coneixement previ sobre la malaltia tenint en compte la informaci de les mostres. Es van analitzar diversos conjunts de dades de malaltia inflamatria intestinal sobre diferents tractaments i condicions i es van comparar els models que defineixen aquest conjunt de dades. Els resultats es van comparar amb lanlisi de coinrcia mltiple. Resultats: Dividir les variables de la mostra en diferents blocs dna com a resultat models daquestes relacions que mostren diferncies en els gens i els microorganismes seleccionats. Els models generats mitjanant el nostre nou mtode intermodel van superar lanlisi de coinrcia mltiple per classificar les mostres segons la seva ubicaci. Tot i utilitzar-se en conjunts de dades de diferents fonts, els models resultants mostren relacions similars entre variables. Discussi: La comparaci de diversos models ajuda a esbrinar les relacions dins dels conjunts de dades. El nostre mtode troba com de fortes sn les relacions entre el microbioma, el transcriptoma i les variables ambientals. En diferents conjunts de dades, els gens seleccionats eren comuns. Aquest enfocament s robust i flexible per a diferents conjunts de dades i configuracions. Conclusi: Amb inteRmodel vam trobar que el microbioma es relaciona ms estretament amb la ubicaci de la mostra que amb la malaltia, per el transcriptoma est molt relacionat amb la ubicaci de la mostra a lintest. Hi ha un transcriptoma com entre conjunts de dades, mentre que els microorganismes depenen del conjunt de dades. Podem millorar la classificaci de les mostres tenint en compte tant lARNr 16S bacteri com el transcriptoma hoste. "],["introduction.html", "Chapter 1 Introduction 1.1 Inflammatory bowel disease 1.2 Integration studies in IBD 1.3 Integration 1.4 Summary", " Chapter 1 Introduction Inflammatory bowel disease (IBD) involves Crohns disease (CD) and ulcerative colitis (UC). It generally affects the terminal ileum and the colon but it can involve any segment of the gastrointestinal tract. UC is a recurrent, chronic and continuous inflammation of the colon and rectum while the CD is not a continuous inflammation and affects the whole gastrointestinal tract causing transmural inflammation. IBD etiology is unknown. However, once it has initiated the most prevalent hypothesis of its chronicity suggests an aberrant immunological response to antigens of the commensal microbiome. To diagnose IBD doctors use endoscopy and/or magnetic resonance imaging and histologies. Treatments provided for IBD include, noninflammatory drugs, suppressors and biologics, i.e, anti TNF- anti-IL2, 23, anti-integrin \\(\\alpha4\\beta7\\). The therapeutic options can induce remission in some patients, but they often need continuous treatment to avoid recurrence. Nevertheless, many patients are refractory or intolerant to those therapies and need to undergo surgery or other strategies like dietetic and psychological support [1] . 1.1 Inflammatory bowel disease IBD includes the CD and UC which are characterized by alternating periods of remission and clinical relapse that mainly affect the gastrointestinal tract. CD is a progressive relapsing disease that can affect all the gastrointestinal tract but shows mostly on both terminal ileum and colon with a discontinuous inflammation. UC is a colonic relapsing disease characterized by continuous inflammation of the colon. Both of them have different risk factors, clinical, endoscopic an histological characteristics (see sections 1.1.2 and 1.1.3 ). Around 3.5 million individuals have IBD in Europe and North America combined [2]. IBD is more commonly found in industrialized and developed regions, suggesting that environmental factors might greatly influence IBD occurrence. In addition, the incidence of IBD is increasing in areas, such as Asia or Eastern Europe, where the number of cases was relatively low hitherto [3]. The dysregulation of the inflammatory response observed in IBD requires interplay between host genetic factors and the intestinal microbiome. Several studies support the concept that IBD arise from an exacerbate immune response against commensal gut microorganisms. Nonetheless, the disease could result from an imbalanced microbial composition leading to generalized or localized dysbiosis1. The role of the gut microbiome in IBD is an active ongoing field of research. Several authors are currently studying the alterations reported in IBD of the intestinal microbiome. However, it is still unclear the cause-effect relation between dysbiosis and IBD. Partly due to the multiple variables already identified that have been linked to IBD; for instance, age, diet, usage of antibiotic, tobacco, and socioeconomic status [4, 5]. The relationship between host and microbiome has been proposed to play a fundamental role in maintaining disease. For instance, some Proteobacteria species which have adherent and invasive properties might exploit host defenses and promote a proinflammatory environment, altering the intestinal microbiota in favor of dysbiosis [6]. The epithelium is often damaged and might present ulcers or other inflammation symptoms. A segment of the gastrointestinal tract might recover if the patient receives treatment or due the natural cycles of the disease. But once a segment is affected by the disease it can be considered as involved, as some damage remains even if the tissues is no longer inflammed. 1.1.1 Etiology and pathogenesis Several mechanisms have been proposed to drive IBD pathogenesis [7, 8]. Some of them are based on a relationship between the immune system and the microbiome [9, 10]. It is also unclear if CD and the UC share the same origin considering their different symptoms. There is also evidence of some genetic component on the onset of the disease, specially if the disease appears very early (less than 2 years old patients) [11, 12]. Disease can be classified based on age at onset as very early, early or adult on-set disease [12]. Genome-wide association studies (GWAS) have linked IBD to over 100 genetic loci, including a NOD2 gene, but so far there is not any known mechanism how polymorfism on this genes are driving the disease [13]. On early pedriatic and adult disease the genetic component is lower than on very early on set and it is thought that the environmental factors are the main cause of the disease at those ages. On the following sections we will explore the role of several of the possible factors involved on the pahtogenesis, starting with the genetics. 1.1.1.1 Genetics IBD is not an heritable disease, except for very early onset IBD, but it has some genetic influence that predisposes people to have it. This has lead to look for genetic factors in IBD both on general population and on the early cases. Genome wide association studies (GWAS) are one of the most common genetic studies performed, together with methylation studies. To discover through linkage desequilibrium genetic variations linked to phenotypes and regulatory transcription changes, respectively. With GWAS several allels on protein coding loci have been found, rising to around 300 genetic variants [14]. Particularly, the NOD2 gene is highly relevant for the disease on European patients, as it is a risk alleles for CD loci but show significant protective effects in UC [15, 16]. The mechanism of how this gene protects from UC has not been confirmed yet [13]. Many of the relevant genetic loci related to IBD are not on protein coding fragments of the genome. Recently expression quantitative trait loci (eQTL) particularly showed [11] that locis are on enhancers or promoters like e.g. H3K27Ac or promoter e.g. H3K4me1 marks as found by chromatin immunoprecipitation sequencing (ChIP-Seq). 1.1.1.2 Microbiome The human intestine is a large reservoir of co-existing microorganisms (bacteria, fungi, viruses, and unicellular eukaryotes) . This microbiome community exerts different functions in the human body influencing nutrients metabolism, the maturation of the immune system while suppressing the growth of harmful microorganisms [17]. The role of the gut microbiota has been proposed to play a role in IBD pathogenesis. IBD has been characterized by a breakdown in the balance between beneficial and harmful bacteria that are present in the human gut compared to healthy individuals [18, 19]. Indeed, many studies show that patients with IBD have less biodiversity. Biodiversity is measured on \\(\\alpha\\) (alfa) and \\(\\beta\\) (beta) diversity. \\(\\alpha\\)-diversity is a measure of the species present on a single sample and its abundance while \\(\\beta\\)-diversity compares the diversity between samples. There are some reports of taxonomic changes and increase on Enterobacteriaceae sp, Escherichia coli (specially the invasive strain) at the mucosal layer of IBD patients [20]. At the same time there is often a reduction of protective species like Bifidobacterium, Lactobacillus and Faecalibacterium which might be able to protect individuals from mucosal inflammation via several mechanism such as a downregulation of proinflammatory cytokines or the stimulation of IL-10 and antiinflammatory cytokines [20]. Specially Faecalibacterium prausnitzii is one microorganism of interest [21, 22]. In fact, it has been recently proposed that several unique microbial species can distinguish healthy controls from UC and CD patients [23, 24]. Figure 1.1: The microbial composition in the gut. On the left healthy gut is represented as having a high microbiome diversity and no damage on the epithelial barrier. On the right the IBD gut were microbiome diversity is lower and some bacteria is in physical contact with the damaged epithelium One of the proposed mechanism of crosstalk between bacteria and host is through bacterial metabolites. They interact with the cells and modulate the state of the intestine. One example of such metabolite is butyrate which has been linked to microorganisms presents on healthy intestines and shown to interact with intestine cells and help regulate some genes [25]. As previously mentioned, adherent invasive Escherichia coli, a proteobacteria specie, has been associated with IBD [26]. Adherent invasive strains are mainly found in ileal and colonic samples of CD patients and their presence in UC is less clear. These adherent invasive cells enter through the epithelium of the more permeable cells and live on their cytosol. The metabolic cocktail composed of soluble factors secreted by life probiotic bacteria, living microorganisms which, when administered in adequate amounts, confer health benefits on the host [2731] or any bacterial-released molecule capable of providing health benefits through a direct or indirect mechanism, has been collectively known as postbiotics since 2012 [27]. 1.1.1.3 Immune response As explained previously the immune system plays a role in IBD pathogenesis and pathophysiology. Loss of tolerance to commensal bacteria has been suggested as the underlying mechanism triggering the inflammation on the intestine. The immune response involves many different cells lines and regions, which are important to know how they organize for a better understanding of the disease. Figure 1.2: The intestinal epithelial barrier. From the luminal side of the intestine, the first layer is the mucosa (See sections 1.2 or 1.1). In the colon the mucus is organized in two layers: the inner layer, a firm mucus layer; and the outer, loose mucus layer [32]. The intestinal epithelium is a single layer of cells organized into crypts and villi (and circular folds on the large intestine) that carries out a diverse array of functions besides digestion performed by specialized cell lineages. Immune response in the intestinal mucous is mainly excreted by the gut associated lymphoid tissue [33]. Genetically predisposed patients when exposed to certain environmental factors activate immune responses against microbials or self-antigens which in turn, may impair the mucosal barrier of the intestinal mucosa, the first physical barrier on the mucosal surface. Both the adaptive and the innate immune cells are present in the intestine, right below the epithelium. In IBD due to antigen translocation into the lamina propria, the immune response leads the adaptive cells to generate immune response to harmless components of the intestinal microbiota. This initial response induces a local increase in the production of pro-inflammatory cytokines and mediators which damages the mucosa. Therefore, the loss of integrity on this barrier enables the intestinal luminal bacteria to access the intestinal epithelium and to interact with the immune system underneath it more directly [34]. The intestinal epithelium is another line of defense against bacterial invasion. Intestinal epithelial cells play a key role in controlling the integrity of the physical barrier to the intestinal microorganisms [34] not only physically but also secreting antimicrobial peptides and defensins, both of which are altered in IBD patients [35]. The intestinal epithelium also plays a key role on the intake and diffusion of metabolites from the intestinal lumen to the lamina propia. Damaging or increasing the permeability of the intestinal epithelium results on a response from the immune system. Detecting signals of any foreign particle can also trigger the immune system. On the intestine this starts with the identification of these signals by intestinal epithelial cells have pattern recognition receptors. There are two main pattern recognition receptors: toll-like receptors (TLR), which are present on the surface, and nucleotide-binding oligomerization domain-like receptors (NOD-like receptors), present on the cytoplasm of the cells. These receptors upon recognition of pathogen associated molecular patterns (PAMPs) start an amplifying signaling producing chemokines and cytokines which activates the transcription and translation of pro-inflammatory mediators to ensure an effective immune response. Initially the innate response is triggered but the cells also increase the antigen presentation to T cells and thus activate the immune adaptive response [36]. Other cell types, such as monocytes, macrophages and dendritic cells also present the pattern recognition receptors. From those, macrophages and dendritic cells are antigen presenting cells too and secrete several cytokines to activate other immune cells. Usually CD patients express higher amounts of TLR than healthy individuals, which might trigger a stronger immune response. This response is driven by CD4+ T cells proliferation in secondary lymphoid tissues to T helpers in the presence of the antigens and cytokines nearby. T helpers (Th) differentiate depending of the cytokines at which they are exposed. Th type 1 are driven by exposure to IL-12 secreted primarily by dentritic cells. Th2 are driven by cytokines secreted by macrophages. The imbalance between Th1 and Th2-promoting cytokines determines the intensity and duration of the inflammatory response in experimental colitis [37]. Th17-promoting cytokines are less well characterized in human. Treg cells differentiate after exposure to cytokines IL-10, IFN-\\(\\gamma\\) and TGF-\\(\\beta\\). Overall the presence of certain cytokines and the response to self-antigens are factors leads to an inflammation and damage that is related to the onset and establishment of IBD On these kind of diseases autologous hematopoietic stem cell transplantation has shown some benefits in IBD [38]. The benefit of hematopoietic stem cell transplant (HSCT) in autoimmunity is thought to originate from the depletion of auto-reactive cells regardless of their specificity. However, due to its associated risk this therapy is only given when patients are refractory to all available therapeutic options. 1.1.1.4 Environmental Chronic inflammatory disorders and neoplasms have become the main cause of morbidity and mortality in the countries with high standards of personal cleanliness. A decrease in human exposure to microbes or hygene which might affect the proper maturation of the immune system so that it provides less immune response or exacerbated response towards friendly microbes [39, 40]. From other environmental factors related to IBD such as tobacco, diet, certain drugs and stress; tobacco is the most influential environmental factor. Surprisingly, it has an opposite effect on UC and CD: in CD tobacco is a risk factor that increases the risk of relapse and/or surgical intervention. In UC, it has been observed that smoking cessation worsens the disease [41]. Pharmacological treatments such as oral contraceptives, non steroidal anti-inflammatory drugs are also related to develop or relapse the disease [42, 43]. The psychological welfare of people also plays an important role in the disease progression, stress, anxiety and depression might be important in relapse and deterioration of the disease [44]. Other environmental factors have been linked to IBD but without enough evidence to support a causative effect in the development of the disease. 1.1.2 CD physiology As previously introduced, CD is a chronic inflammatory disorder characterized by a discontinuous inflammation of the gastrointestinal tract. Inflammation on the gastrointestinal tract is transmural and can affect from the mouth to the anus, but mainly it manifests on the ileum and colon [10]. It is frequently associated with extraintestinal manifestation and/or concomitant immune-mediated diseases. The disease itself manifest an heterogeneous symptoms that can involve, diarrhea, weight loss, abdominal pain, fever, anorexia and malaise. Other less frequent co-occurring manifestations are arthritis, primary sclerosing cholangitis, skin disorders venous or arterial thromboembolism and/or pulmonary involvement [45] . These symptoms make it hard to correctly diagnose the disease by non-specialists, in addition there is not a non invasive easy procedure to diagnose it. All these can lead to delays on correct diagnosis of the disease. The detection of parasites or bacteria, such as Clostridium difficile, have been associated with CD [46]. The detection of fecal calprotectin, is generally a good marker of endoscopic activity with sensitivity above 70% and specificity above 80% [47, 48]. Usually the best diagnosis method is to perform a colonoscopy, whether there is inflammation on the gastrointestinal tract on discontinuous regions then is CD. This inflammation could also present ulceration with rectal sparing and histological lesions which also help to diagnose the patients [49]. Usually on CD a granulome, that is a region with big multinucleous cells, can appear on any intestinal layer. In addition to the inflamed location(s), mosaic zones (patches of inflamed and non-inflamed areas) are more characteristic of CD [50]. The Montreal classification aims to classify patients according to their age of disease onset, standardized anatomical disease location an disease behavior. This classification assumes that the location of CD remains stable over time after diagnosis but behavioral phenotypes change. Other scores consider area affected: Montreal classification allows for early onset of disease to be categorized separately those with age of diagnosis at 16 years or younger, diagnosis at 1740 years and &gt;40 years, respectively [12]. SES-CD: simple endoscopic score for CD [51]. Score based on size of ulcers, ulcerate surface percentage, affected surface and presence of narrowing on the bowel. CDAI: CD Activity Index takes into account weight, ideal body weight, sex, and events on the last week such as liquid stools, abdominal pain, general well-being and if anti-diarrhea drug usage, as well as knowing if there are fistulas, fever, and other complications [52] To some extent, there is a disassociation between clinical symptoms and the endoscopy finding. Often patients report feeling better despite lack of muscular healing [53]. To overcome this disassociation and be able to compare the well-being of patients several scores and thresholds are used on research and by physicians that will be described later. In the early stages of the disease the relapsing and remitting course is more frequent. Often relapses are accompanied by clinical symptoms, and few have prolonged clinical remission (without treatment) [54]. When there is clinical remission, there can still remain some other lesions and often subclinical inflammation persists. Frequently the damage caused by the disease evolves to fibrostenotic stricture or penetrating lesions (fistula and abscess). Damage of the disease might not be apparent to patients and might be only seen several years later than the first detection [53]. Mucosal healing is a first step towards the healing of deeper layers of the inflamed bowel wall on the CD. Patients might progress from an inflammatory phenotype to a stricturing or penetrating one [12]. Stricturing is a narrowing of a part of the intestine often because of scar tissue and fibrosis in its wall. Penetrating is when the epithelium has some holes or tubes. If these tubes result in an abnormal connection between two body parts it is a fistula, it might also result in an abcess, a collections of pus, often developed in the abdomen, pelvis, or around the anal area. 1.1.3 UC physiology As previously introduced, UC is a chronic inflammatory disorder characterized by a continuous inflammation of the colon. Depending on the inflamed segments of the intestine it is classified in several phenotypes. Around a third of the patients with UC suffer proctitis, the inflammation of the rectum. If the segments from rectum to the sigmoid colon are affected is a distal colitis, if it affects the left colon then it becomes a left colitis. If the inflammation continues to the descending colon it is then an extensive colitis until it affects the whole colon when it becomes a pancolitis. The extension of UC is inversely related to the frequency. However, the extension and severity of the disease correlates: the prognosis is worse the more extended it is [55]. In addition, the damage usually consists in many neutrophil in the lumen crypt [50]. The goal of the clinical care is to recover. As a first step, the symptoms of IBD have to lessen to the point that they are mostly absent, gone, or barely noticeable, this is known as clinical remission. However, this is not enough as the mucosa might be still inflamed and thus the reconstitution of the structure and function of the intestinal mucosa is not complete. Other lesions, might aid to the progression to other phenotypes such as fibrostenotic stricture or penetrating lesions or primary sclerosing cholangitis [56]. To prevent and avoid further damage several procedures are followed: When there is dysplasia, an abnormal development of cells within tissues or organs (which is considered a precedence before colorectal cancer growth [57]), or the damage on the colon has been too big a surgical procedure to remove part or all of the colon must be done. Patients that undergo a colectomy need to have their bowel reconnected with a procedure called ileoanal anastomosis (also know as J-pouch by the shape it takes) surgery. Often the lining of the pouch created during surgery becomes inflamed on what is known as pouchitis [58]. Many scores have been proposed for several purposes, from quality of life to disease severity or patient status. Among the scores most used are the following: Mayo: A score designed to be simple to calculate based on stool frequency, bleeding, mucosal appearance at endoscopy and physicians assessment [59]. IBDQ: A 32 questionnaire used to assess the quality of life grouped into four categories: bowel, systemic, social and emotional [60]. UCEDIS: An endoscopic score based on vascular pattern, internal bleeding and erosion and ulcers [61]. Other measured parameters include, weight, effective weight, fecal calprotectin, C reactive protein and hemoglobine. 1.1.4 Treatment Current treatment attempt to induce and keep the remission of patients and reduce secondary effects of the disease instead of revert the pathogenic mechanisms. As standard of care corticosteroids, aminosalicylates and immunosuppressor and some other drugs like antibiotics or metronidazol are util in some cases. Acid 5-aminosalicylic (5-ASA or mesalazina, pentasa) can be given in a topic way (either liquid, enemas, or suppository) or in oral form (pills or dilutions). In CU it helps in the clinic remission but it does not always mean that there is remission (is twice much likely than placebo to reach remission) [62]. On CD the effects are not so stark and generally it does not produce changes on the disease [63]. Antibiotics, such as metronidazol and ciprofloxacina, are effective to deal with secondary effects of IBD such as abscess and bacterian overgrowth in CD [64, 65], but they do not seem effective on UC [65]. Corticosteroids can be taken orally, such as prednisolona, prednisona and Budesonide; intravenous, hidrocortisona, metilprednisolona; or via enemas and suppositories. Budesonide is not absorved well and has a limited biodistribution but it has good therapeutic benefits with a reduced systemic toxicity in IBD [54, 66]. These drugs work very well as antiinflammatory for mild or severe IBD but do not work well as maintenance drug [67, 68]. Thiopurines (Azathioprine, mercaptopurina) are immunosuppressants drugs that deactivate key process of limphocytes T that might trigger the inflammation. As a side effect they are toxic due to their interaction with nucleic acids [69]. on CD they are useful to induce and keep remission [70], while on UC they are used to keep the remission [71]. In the last two decades IBD treatment has moved from aminosalicylates, corticosteroids and immunomodulators to anti-TNF\\(\\alpha\\). Anti-TNF\\(\\alpha\\) drugs has changed IBD treatment as it reduced the hospitalization associated with previous treatments, reducing medical costs and risk of surgery as well as induce a better mucosal healing and quality of life for patients [72]. However, 20-30% of patients have no response to this treatments and another 30-40% lose response in a year [73]. Recently a new wave of drugs has been developed targeting different molecules such as vedolizumab, targeting anti-integrin\\(\\alpha 4 \\beta 7\\), ustekinumab, targeting both IL-12 and IL-23, risankizumab an anti IL-23, tofacitinib an inhibitor of JAKs, infliximab an anti-TNF\\(\\alpha\\). Patients might become refractory to drug. Thus, drugs do not have the same effect as previously and the dose might need to be increased with the risk of more secondary effects [1]. Surgery resection might be needed on these patients. Close to 35% of patients with UC will need to have a surgery resection, either due to complications or because the inflammation can not be controlled. Surgery usually removes the inflamed segment of the colon. The most common procedure used is a colectomy (whole colon removal), with ileostomy [74]. CD patients usually require surgery associated to complications like stenosis, abscess, and fistulas ) between 70% and 90% at some point of their lives [75]. Usually the surgery is limited to removing the inflamed segment but occasionally an ileostomy is required [76]. If the drugs fail to contain the inflammation and heal the mucosa doctors might recommend a different procedure. In some cases HSCT is recommended which have shown to improve the life of the patients [77]. This is a new procedure given only to the most extreme cases to reset the immunological state of the patient. To reset or hugely modify the microbiota fecal microbiota transplantation between different people is currently being explored [78]. 1.1.5 Summary IBD is a complex disease that impacts the health of many people for long time and with lasting impact on their quality of life. Current clinical care in some cases is enough to have a sustained clinical and endoscopic remission but most often is not enough and relapse is expected. Several factors, such as becoming refractory to drugs, intermittent course of the disease and lack of validated predictors of disease course or response to therapy make the treatment complex. Lack of knowledge of what are the factors cause of the disease make those treatments and drugs to be addressed to block further inflammation and damage, but cannot prevent it and often they do not stop it completely. 1.2 Integration studies in IBD Many studies have looked up to the origin of the disease. As seen, one of the hypothesis behind the maintenance of the inflammation involves the microbiome and the host epithelium. This has been studied using several data sources, mostly from sequencing data. The technical methods used to obtain the data of the inflamed tissue differ between extracted from biopsied samples at colonoscopy or from surgical samples. Those samples are usually used later on to diagnose or for research purpose. To obtain research-quality data it usually imply using techniques such as immunohistochemistry, histopathology, immunohistochemistry, fluorescence in situ hybridization and polymerase chain reaction. These techniques allow to measure or visualize where are the cells expressing certain proteins or genes, thus helping with the analysis validation. Furthermore several studies have been carried out to discover links between microbiome and the inflammation, followed by those looking for some relationship between genetics and the disease and more recently the metabolome. These studies, known as integration, multi-omic or interaction studies, usually use multiple sequencing assays as the bases of the analysis [79]. However, confirming causal interactions of the variables of each essay is difficult. To find relationships some articles use correlation [80], there are others that use a combination of methods from correlations, partial correlations to integrative methods [8183] and network integrations [82]. Very rarely there is an experimental confirmation of the relationships between variables of the different assays because it is complicated to test an interaction and to set up the right conditions for the many variables that are accounted for on the integrations. One of the few methods published that shows an interaction between genes and microorganisms in IBD is to expose the ex-vivo sample or cell lines with microbiomes or supernatant of at their culture [84]. 1.2.1 Type of data used for integration analysis According to the data used, we can classify the studies: 1.2.1.1 Transcriptome Most of the integrations refer some other source of data to the transcriptomics of the patient. The transcriptome of patients derived samples has been extensively studied since the existence of microarrays. There are known marker gens of inflammation and many research focus on identifying prognosis predictors and treatment response prediction based on gene expression [8587]. Recently single-cell RNA-seq technology has enabled to estimate cell populations of the samples with better degree of success than bulk RNA-sequencing. Single cell technologies are starting to be used for integration. 1.2.1.2 Microbiome Many of the integration analysis in IBD are done between host transcriptome and the microbiome. These studies use datasets from IBD patients usually stratified by disease activity or severity of inflammation or location of the disease. Most of them are based on correlation analysis between the microbiome and RNA-seq [80]. Conclusions of these integrations range from finding differences on the correlation depending on the type of disease ([80]) to finding relationships with inflammatory genes [81]. 1.2.1.3 Genetics Genetics is the next most common data source used to integrate data in IBD. Most studies on genetics and IBD are genome-wide association studies. The genetic component is specially important in IBD that starts on children [14, 83, 88]. When using genetic data to integrate it with transcriptomics it is usually to understand how a genetic variant is affecting a gene expression. This has lead to the identification of expression quantitative trait loci (eQTL) [8992]. 1.2.1.4 Metabolome More recently there have been an increased interest on the study of the metabolic stat of IBD patients, given that microorganisms interact with the host also via their products and metabolites. There is evidence some of these metabolomic products come from the microbiome [25, 84]. Some studies have integrated the metabolome with the RNAseq and state of the epithelium [93, 94]. 1.3 Integration The term data integration is widely used with varying meanings. According to the dictionary integration is defined as: the process of combining two or more things into one  Cambridge Dictionary Other words used are integration, and if specific to data from sequencing technologies, multi-omics or pluri-omics. Here integration will be used as it is the more general one and not restricted to omics or sequencing technologies. Since the beginning of the integration methods there have been many methods proposed [95]. Some of the early methods were initially used for surveying the agreement of different evaluating systems [96], others were developed for agricultural sciences [97] or food industry [98]. Some of these methods are specific for one application or data type while others are more generally applicable. Lately, the access to bigger datasets with more variables and often from the same samples has increased the focus of the research community on the methodologies available on several disciplines but mainly on biological sciences. The explosion of data on biological sciences has been driven by the new sequencing technologies that allow to measure thousand of variables of many samples at the same time. If done with multiple sequencing technologies it is usually referred as multi-omics methods, which usually only uses omic data. It is crucial to classify, review and compare tools available, as well as, to benchmark these tools against the same dataset as a way to provide clear recommendations to anyone wishing to use them [99]. Part of these efforts use the methods strategies to classify them [100, 101]. Following this view we will review the available integration methods according to several axes: type of data used, aim of the method, relationships between variables, relationships between samples, relationship between variables and samples, input data, mathematical framework and results of the method. 1.3.1 Classification of integration methods Integration methods have very different properties that allow them to be classified and compared [102]. Here we classify those meant to be used with omics datasets, with references to concrete methodology and in occasionally to articles using them. Figure 1.3: Unsupervised data integration methodology. Figure 1 from Huang 2017. 1.3.1.1 Data type: numeric or categorical The most important distinction in integration methods is what kind of data are combined. In general data can be divided between categorical and numeric variables, which are usually found in several fields. Sometimes clinicians want to understand the relationship between a phenotype they observe and the underlying mechanism. Usually this involves looking how metabolites, gene expression, methylation, number of variants a gene has, and other numeric variables are related to the observed phenotype (i.e.pain). Depending on the methods aim it handles numeric and categorical data types or just one. Often they are used differently. The most common way to handle different types of data is converting the categorical values to a mock or dummy variable. For each categorical factor there is a new variable whose value is 1 if that sample had this factor and 0 otherwise. For instance, if the categorical variable has three values (A, B, C) it would be converted to A (1, 0, 0) B (0, 1, 0) and C (0, 0, 1). Often the number of variables created is one less than the number of factors that existed, on this example only A and B would be kept. This transformation allows to use categorical values as numeric variables. If the method only accepts categorical data but you want to provide numeric values usually those values are categorized. For example if a variable is (0.123, 0.25, 0.56, 0.78) one could make to categorical values like (&lt;0.5, &lt;0.5, &gt;0.5, &gt;0.5). The number of categories to use and how the numeric value splits depends on each case. Very rarely methods allow to use both data types as they are. If they allow so, it is usually for classification purposes only. 1.3.1.2 Objective The objective of any method is one of its most important defining properties. Data integration can be classified according to the (biological) question they try to answer. In general all of them aim to provide a better understanding of the relationships between the omics types. Often a single method is not enough and several methods are used on the same dataset. This is specially relevant when a potentially relationship between omics is discovered. For instance, checking that in a particular case or condition a given relationship is present, might require experimental confirmation. Most of the times one (or several) of the following results are expected from integration methods: Classification of the patients or samples One of the purposes of integration might be to use multiple sources of data to accurately describe how do samples or patients fit on a predefined possibles states. The objective here might be to accurately describe whether a patient has one or other related disease of a possible subset of diseases or phenotype [103]. An overview of the role of each individual omic in a biological system Sometimes the question is which omic method is the best describing a disease. This knowledge could prevent performing expensive tests and replace them by more affordable or easier technique that has enough predictive power or is sensitive enough and specific for the task. An example of this is the search of markers on blood to identify links between different cell populations [81, 104]. Finding a molecular signature A signature is usually a group of features that describe/are representative of a cell type, a process or a stage. Identifying a subset of variables from the omics that are related is often a desired goal because it reduces the amount of variables allowing to perform experiments on the bench on just those that might be important. In other fields, such as machine learning, selecting the important variables is known as feature selection. There are several methods that are used to do this [100]. An example of this is when performing eQTL analysis, where a locus is related to a change in gene expression [8992]. A predictive model Predictive models usually require a very good understanding of the current and/or past relationships, as well as, a good feature selection procedure. If a good model on previous data exists it might be used to predict future events. Sometimes, models are only built to predict events without being able to accurately understand the underlying mechanism. This kind of methods are used to improve treatment selection, diagnosis and prediction of prognosis [105]. Impute values Some methods aim to accurately guess the values of missing data given some other information. Missing values can happen for a variety of reasons from practical ones, like a sample not being available, to technical ones, such as laboratory mistake [106]. However, this is often a intermediate step to other goals. To complete these goals it is important to have enough statistical power to determine the significance of tests performed (if any) and to understand how complete are the data sources used on the integration [107]. Having more statistical power helps identifying the relationships one seeks when using this methods. 1.3.1.3 Relationship between variables and samples Depending on the amount of variables and samples used in studies can be classified in two types. Traditionally for each sample few variables are measured, for instance on a biopsy with RT-PCR only a few genes are measured, however with the new omics techniques (transcriptomics, metabolomics, methylomics, genomics), thousands of variables are measured for the same sample. This has lead to the following situation: More variables than samples For a single sample of RNA around 50k genome identifiers (genes, long non coding RNAs, iRNA, pseudogenes,) can be measured. Which leads to the case where there are many more variables than samples. Thus high-throughput data analysis typically falls into the category of \\(p \\gg n\\) problems ( big p, little n), where the number of genes or proteins, \\(p\\), is considerably larger than the number of samples, \\(n\\). With such high number of variables the identification of the relevant variables is hard because variables will co-variate. When many variables are tightly correlated, discovering which one is important using just numerical methods is challenging. This is even more difficult when looking for causal relationships. More samples than variables This was the usual case when for instance, from a cohort of patients the temperature is measured along the stage of a disease: two variables, time and temperature for each sample. If there are more than 2 patients, then the number of samples is greater than the number of variables studied. This is described in the literature as \\(n \\gg p\\) (or big n, little p). Nowadays this is less frequent on the bioscience world, and does not causes trouble analyzing it because the high number of samples allows to accurately estimate the dispersion of variables. There are several methods available to estimate the number of samples required [108]. Having just the enough samples for the desired statistical power, however, might not be enough in case some samples are not correctly processed. In addition, variables might be separated on different blocks of variables. These blocks might be just of the same source or from multiple methods. Depending on the method this blocks might have special meaning: when all the data is joined in a single block it is known as superblock. 1.3.1.4 Relationship between samples Depending on the relationship between the samples, the questions answerable and the methods that work on them differ. A sample can have multiple or one data source, for instance we could have RNA-seq and 16S data from the same sample. In a study if all the samples have all the data from multiple data sources it is a complete case. If some samples have data from some data sources but not from others the study is not a with a complete case. Sometimes because the sample is not enough, or there are some technical or organizational problems a source of data for a sample (which is known as an incomplete case) might be lost. This results in a new source of variation that has to be dealt with, which complicates the conclusion one can draw from the studies of these kind of data. Even when all the cases of a patient are complete the samples can come from several sites of the same individual or with different combinations of variables, which makes it relevant to understand the relationships between the different samples. There is no easy classification of this as each experiment might be designed differently. In general, experiments are designed to be as consistent as possible but in face of adverse events that become a variation of the design the analysis complicates. Either some data is imputed or some samples are omitted for the analysis. This can happen with samples taken at different timepoints as patients for instance if they miss a follow up visit. Time As mentioned above, time is one of the factors that sometimes cannot be controlled, despite having programmed visits every two weeks, for instance, some patients might come early or later due to multiple reasons. Sometimes, the objective of the study is precisely to analyze the relationships at different time, or to asses how the relationships change with time. To discover causality between two variables the cause must precede the consequence, which highlights the importance of time. Being aware of the time differences and time scales is crucial in most cases. During in vitro experiments, conditions can be reproduced even if they are at different time. However, when using patients material replicates can not usually be performed like in vitro experiments. This makes it harder to study time-related change on patients. Lastly, time between the collection of a fresh samples and its processing also influences the readings of the samples of the omics technology, specially RNA-seq [109, 110]. Some genes are more influenced by time than others but as they are measured at the same time in all samples this might distort the data. Keeping track of the time that it takes to process samples is also hard to due and requires a highly coordinated effort [111]. 1.3.1.5 Relationship between variables Once data is collected, the next step is to understand the relationship between the variables present. As mentioned earlier, some variables influence others which can affect the outcome in complex ways. With many variables present in a dataset it is important to be aware of known relationships between variables. Even in a simple dataset, like an RNA-seq dataset, it is important to be aware of the relationships between variables. Since the discovery of the lactose operon it is known how some genes regulate each other [112]. However, it is not know how other variables are related between them. For instance, how does the increase in expression of a gene affects the growth of a microorganism? Usually the relationships between variables are mediated by many factors or interactions. One of the best examples of such interactions is when some variables correlate. Their correlation can be used to reduce the number of variables being analyzed by ignoring the relationships between them and using the most representative variable (less widely correlated and with more variation). This step is usually done by dimension reduction methods. However, sometimes this is not desirable or feasible as the correlation does not explain the direction of the causality of the interaction between the variables (if there is any). Network approaches relate the variables to each other [113]. These approaches are fairly new and growing in popularity partly because they can address the direction of the interaction. In partial correlations the effect of other variables on the two being under study are taken into account [114]. They assumes a linear relationship between the co-occurring variables and those of interest. However, it is computationally expensive when there are thousands of variables. 1.3.1.6 Input data We have classified the studies according to the data they use (as seen previously ). But, some methods to account for relationships of variables only work when a dataset is complete while other do not: Data from the same samples: These methods do not handle well or at all missing data. They need complete cases/data of the samples in order to be able to integrate the results. These methods include Regularized Generalized Canonical Correlation Analysis (RGCCA) [115, 116], Multiple co-inertia analysis (MCIA) [117], Multi-Study Factor Analysis (MSFA) [118], Multi-Omics Factor Analysis (MOFA) [119] and STATegRa [120]. Data from different samples: These methods do not need data from the same sample. They draw their conclusions generalizing from the data available. Some of them handle missing data, while others do use the data at face value. These method includes MetaPhlAn2 [121], HUMAnN,[122] and LEfSe [123]. Furthermore, some methods are designed to integrate specific types of datasets, (usually because they make some assumptions that are only met on that kind of data). For instance, HCG, 16S rRNA-seq, RNA-seq and metabolomics do not share the same data distribution, and are different between them. Also even with the same data depending on the processing of the data they can have very different properties: OTUs (operational taxonomic unit) properties are not the same as ASV (amplicon sequence variants) when analyzing 16S rRNAseq data. 1.3.1.7 Mathematical framework Methods use different mathematical frameworks to process the data. Here we briefly describe some common mathematical frameworks, some of which have previously appeared: Networks Networks methods were mentioned because they use and find information about the interaction of variables. Multilayer networks, including the multiplex, Molti-C-DREAM [124], Random Walk with Restart on Multiplex and Heterogeneous Biological Networks RWR-MH, Random walk with Restart on Multiplex RWR-M [125]. Network embedding MultiVERSE are some of the methods using networks [126]. Bayesian approaches are also quite frequent, these methods use the Bayes theorem to see the relationships between variables. The Bayes theorem explains that the conditional probability of a variable is related to the prior knowledge of conditions that might be related to the event [127]. Some methods that use these approaches are Reconstructing Integrative Molecular Bayesian Network (RIMBANET) [128] and Bayesian Consensus Clustering (BCC) [129]. Dimensional Reduction These methods focus on finding just a few variables and summarizing them using a function that has some desired property such as the correlation between thre transformed variables is maximal while the components are orthogonal.s The selection of variables is usually done with L1 or Lasso Regression regularization technique or L2 also known as Ridge Regression. L1-regularization adds a penalty equal to the absolute value of the magnitude of coefficients which might leads to some coefficients becoming zero and the variable eliminated from the model. On the other hand, L2-regularization does not result in elimination of coefficients or sparse models and can only be used when there is multicollinearity as it works well to avoid over-fitting. Several tools use this approach, Momix [130], regularized canonical correlation analysis (RGCCA) [131], mixOmics [132] and STATegRa [120]. Other methods use bayesian approches like the Bayesian Group Factor Analysis [133]. Active module identification Multi-omic objective genetic algorithm (scores based in two metrics; node score and density of interactions score). An example of a method using this approach is Multi-Objective Genetic Algorithm to Find Active Modules in Multiplex Biological Networks (MOGAMUN) [134] Usually depending on the mathematical framework used, these methods return similar outputs. 1.3.1.8 Output results According to the output the integration methods can be classified in several groups: For the network methods the following output is usually returned: Connections between the variables/nodes, a measure of how strong is the connection (or simply if there is a connection or not). For dimensional reduction methods there are three possible outputs: Shared factor across the data, specific factors for each data or mixed factors. Shared factors: Integration results in a vector of the samples in a lower dimensional space that is shared by all the data set used to integrate. Such methods include iCluster, Multi-Omics Factor Analysis (MOFA) [119]. Specific factors: Integration results in several vectors of the samples in a lower dimensional space of each data set used to integrate. Such methods include Regularized Generalized Canonical Correlation Analysis (RGCCA) [115, 116], Multiple co-inertia analysis (MCIA) [117] and Multi-Study Factor Analysis (MSFA) [118]. Mixed factors: Integration results in both shared and specific factors, to each dataset and common to all them. Such methods include Joint and Individual Variation Explained (JIVE) [135] and integrative Non-negative Matrix Factorization (iNMF) [136]. 1.3.2 Interpretation How to interpret the results of applying the different methods is highly linked to understanding the method and its output. On a correlation between two variables, the interpretation of the analysis is clear, if one variable increase, the other one too. The implications of this correlation can be far reaching but the principles to understand them are simple. However, on more complex methods the interpretation becomes less clear. The interpretation of a canonical correlation analysis is much harder [137]. Also on more complex methods the number of parameters required increases so the time and intellectual effort to understand the relationships between the parameters is also higher. The interpretation also helps to discuss the results and relate it to other previously know information. Individually: Here we study how each variable relates to another. In the correlation analysis, the relationship between two variables under study. Or if looking by patient: how do interpret that in these patient variable A and B is X and Y? Globally: In a principal component analysis for instance how do we interpret that some variables have the same loading? What happens in a more complex method like canonical correlation analysis? There are some articles about how to interpret those methods on real datasets [138]. Others, to benchmark and to learn how to interpret propose analyzing a simulated dataset [139, 140]. Which is used to compare the results of the integration with the dataset of interest and to compare different tools. These datasets are created with some relationships that the tools are expected to find. There exists several methods to create synthetic datasets like MOSim [140], metaSPARSim [141], CAMISIM [142], ballgown [143], polyester [144] and even edgeR [145]. These methods are useful to compare different setup but they can miss some subtle not previously reported relations on real data. 1.3.3 Reviews The comparison and review of methods independently from original authors have become a crucial step for selecting the right tool to apply a given dataset and research question [130]. Some of these reviews focus on a specific type of data integration: metabolomics [100], genomics [11], microbiomics Others focus on the disease and the challenges of each omics and the need of an integrative approach to provide better therapies [107, 146, 147]. On this regard there are several efforts to integrate data in IBD but no comprehensive review to date is known to the author. The most comprehensive article to date is a very recent review identifying problems and providing recommendations for future work [148]. 1.3.4 Summary The field of integration is large and complex, with increasing interest over the last few years, specially in the psychology and omics fields. As a methodology they are quite complex and diverse but there is a growing interest on them to help answer complex questions without using other complex tools like deep neuronal networks or other machine learning approaches (despite not being incompatible). Methods to integrate have many characteristics, depending on the objectives and data that available. Regardless of the method used, interpretation and reporting is usually the main challenge. 1.4 Summary IBD is a gastrointestinal disease that includes two different diseases UC and CD. It affects preferentially the lower intestinal tract causing lesions on the epithelial barrier. Bacteria causes or use these lesions to further damage the patients. But this interaction is also influenced by many other variables. Data integration are methods to analyze datasets with data from multiple sources. They include a variety of methods and there are methods for several purposes. In IBD it has been used mostly sequencing data, disregarding the other variables known to be relevant. Data integration in IBD has been underexplored despite being known that many factors interact on the pathogenesis and maintenance of the disease. References "],["hypothesis-and-objectives.html", "Chapter 2 Hypothesis and objectives 2.1 Hypothesis 2.2 Objectives", " Chapter 2 Hypothesis and objectives 2.1 Hypothesis IBD is a gastrointestinal disease affecting preferentially the lower intestinal tract causing lesions on the epithelium. Bacteria interact with hosts epithelium and with many other variables. There are data integration methods for a variety of purposes, including finding relationships between variables. On IBD these methods have not been used much to find which bacteria is related to the hosts genes. We hypothesize that the expression state of the epithelium and the microorganisms present might identify whether patients are suffering IBD if environmental factors are taken into account. 2.2 Objectives The main objective of this thesis is finding the relationships between microbiome and gene expression in the intestinal mucosa. For this reason we identify microorganisms and genes related to IBD. Identify relationships between intestinal mucosal gene expression and microbiome presence on the intestine. Determine the influence in the microbiota and mucosa relationship of clinical variables such as location (colon and ileum), disease status, sex, age, treatment received, etc. in the microbiome and mucosa relationship. Identify groups of possible underlying mechanism interactions between the microbiome and mucosa in IBD. "],["materials-and-methods.html", "Chapter 3 Materials and methods 3.1 Datasets 3.2 Sample processing 3.3 Integration methods 3.4 Functional enrichment methods 3.5 Variance and diversity methods 3.6 Other methods", " Chapter 3 Materials and methods This chapter contains a brief description of the main characteristics of the different datasets used on this thesis . The complete processing protocol before obtaining the data of those dataset that were not generated at Hosptial Clnic can be found on their respective reference. Samples of the different cohorts collected in Hospital Clnic were collected similarly and described only once. Differences between protocols are noted on the respective datasets section. Here we describe all the methods used to analyze data from the multiple cohorts included in this thesis. The code used can be found on the links provided in the appendix. 3.1 Datasets 3.1.1 Pugets dataset The glioma dataset is the data provided as an example of biological data by the authors of RGCCA from a previous publication [149]. The data came from diffuse intrinsic pontine glioma patients whose transcriptome was analyzed with Agilent 44K Whole Human Genome Array G4410B and G4112F. The copy number variation of the samples was processed with the ADM-2 algorithm, and data from comparative genomic hybridization (CGH) analyzed using Mutation Surveyor software. In addition, this dataset contained information on age, localization of the tumor, sex and a numerical grading of the severity of the tumor [149]. Table 3.1: Characteristics of samples from the Pugets dataset. Characteristic Pugets Samples 53 Sex (female/male) 28/25 Location (cort/dipg/midl) 20/22/11 3.1.2 HSCT dataset Samples from the HSCT dataset used in this thesis were from a cohort of patients with severe refractory CD undergoing HSCT. Patients were treated in the Department of Gastroenterology (Hospital Clnic de Barcelona Spain). The protocol was approved by the Catalan Transplantation Organization and by the Institutional Ethics Committee of the Hospital Clinic de Barcelona (Study Number HCB/2012/7244). All patients provided written consent following extensive counselling about being included on the study and using their data on publications. Colonic and ileal biopsies were obtained at several time points during ileo-colonoscopy, at inclusion and every 6 or 12 months after HSCT up to 4 years after the start of the treatment. Samples were obtained when possible from both uninvolved and involved areas. In addition, biopsies were taken from the ileum and colon regions of 19 non-IBD controls consisting of individuals with no history of IBD and who presented no significant pathological findings following endoscopic examination for colon cancer surveillance (Hospital Univesitari Mtua de Terrassa Spain). The protocol was approved by the Institutional Ethics Committee of the Hospital Univesitari Mtua de Terrassa (Study Number NA1651). At least one biopsy was collected and fresh-frozen at -80C for microbial DNA extraction. The remaining biopsies were placed in RNAlater RNA Stabilization Reagent (Qiagen, Hilde, Germany) and stored at -80C until total RNA extraction. In total 158 samples with both RNA and DNA extraction of the same segment and time were available 3.2: Table 3.2: Characteristics of samples from the HSCT dataset. Characteristic HSCT Sex (female/male) 22/15 Age at diagnostic (&lt;17/&lt;40/&gt;40 years) 7/11/0 Duration (in years): mean (min-max) 14 (8-28) Age: mean (min-max) 44 (23-70) Disease status (non-IBD/CD) 51/107 Sample location (ileum/colon/unknown) 48/108/2 Local simple endoscopic score for CD: mean (min-max) 2.15 (0-12) CDAI: mean (min-max) 120 (0-450 3.1.3 Hslers dataset An IBD-related dataset was obtained by Prof.Dr.Rosentiel and Prof.Dr.Robert Hsler [80]. Biopsies were obtained endoscopically during routine diagnosis RNA and DNA were extracted using standard procedures. DNA from the 16S rRNA gene was amplified with primers 319F and 806R. Both RNA and DNA was then sequenced on HiSeq 2000 and MiSeq respectively. These biopsies included samples from the terminal ileum and sigma from CD, UC, infectious disease-controls and healthy non-IBD. The dataset included information about gender, location, age, and the status (inflamed or non-inflamed) of the region from which the biopsy was taken. Table 3.3: Characteristics of samples from the Hslers dataset. Characteristic Hslers Disease status (non-IBD/IBD) 33/26 Sex (female/male) 42/17 Sample location (ileum/colon) 30/29 3.1.4 Morgans dataset A previously published dataset from a pouchitis study was analyzed [150]. In this study patients having undergone proctocolectomy with ileal pouch-anal anastomosis for treatment of UC or familial adenomatous polyposis at least 1 year prior to enrollment were recruited at Mount Sinai Hospital (Toronto, Canada) excluding individuals with a diagnosis of CD. The dataset has a total of 255 samples from 203 patients, containing data for both host transcriptome and intestinal microbiome. On some cases several biopsyes were collected from the same patients. This dataset included anonymous identifiers for patients, whether the sample was from the pre-pouch ileum (PPI) or from the pouch, the sex, the outcome of the procedure and an inflammation score. The pouch ileum might be inflamed or not. Table 3.4: Characteristics of samples from the Morgans dataset. Characteristic Morgans Samples (n) 255 Sex patients (female/male) 101/102 Sample location (Pouch/PPI) 59/196 3.1.5 Howells dataset This dataset included a cohort of 66 treatment-nave children at diagnosis of their IBD, along with 30 age- and sex-matched non-inflammatory control children, recruited at the Paediatric Gastroenterology unit at Addenbrookes Hospital (England) [151]. Data from 77 samples that had both RNAseq and 16S data was used. There are 10 non-IBD samples, 11 with CD and 11 with UC. Data has the following characteristics: disease, age at diagnostic, age at time of study, sex, sample location, and disease activity: Table 3.5: Characteristics of samples from the Howells dataset. Characteristic Howells Disease (non-IBD/CD/UC) 11/10/11 Age at diagnostic (&lt;17/&lt;40/&gt;40 years) 32/0/0 Age: mean (min-max) 12 (6-15) Sex (female/male) 10/22 Segment (ileum/colon) 31/46 Clinical history (inflammation/no inflammation) 24/53 3.2 Sample processing 3.2.1 RNA sequencing Total RNA from mucosal samples (HSCT cohort) was isolated using the RNAeasy kit (Qiagen, Hilde, Germany). RNA sequencing libraries were prepared for paired-end sequencing using HighSeq-4000 platform. Samples with good enough quality as recommended by FastQC were processed with cutadapt (version 1.7.1 [152]) for quality filtering. Later, the libraries were mapped against the human reference genome using the STAR aligner (2.5.2a) with Ensembl annotation (release 26 of GENCODE, GRCh38.p10 or superior) [153]. Read counts per gene were obtained with RSEM (version 1.2.31) [154] as previously described [155]. 3.2.2 Microbial DNA sequencing Biopsies from the HSCT CD cohort were resuspended in 180 \\(\\mu\\)l TET (TrisHCl 0.02M, EDTA 0.002M, Triton 1X) buffer and 20mg/ml lysozyme (Carl Roth, Quimivita, S.A.). Samples were incubated for 1h at 37C and vortexed with 25 \\(\\mu\\)l Proteinase K before incubating at 56C for 3h. Buffer B3 (NucleoSpin Tissue KitMacherey-Nagel) was added followed by a heat treatment for 10 min at 70C. After adding 100% ethanol, samples were centrifuged at 11000 x g for 1 min. Two washing steps were performed before eluting DNA. Concentrations and purity were checked using NanoDrop One (Thermo Fisher Scientific). Samples were immediately used or placed at -20C for long-term storage until DNA sequencing. 3.2.2.1 DNA sequencing Microbial cells were disrupted by mechanical lysis using FastPrep-24. Heat treatment and centrifugation were conducted after adding a cooling adaptor. Supernatants were treated with RNase to eliminate RNA. Total DNA was purified using gDNA columns as described in detail previously [156]. Briefly, the V3-V4 regions of 16S rRNA gene were amplified (15x15 cycles) following a previously described two-step protocol [157] using forward and reverse primers 341F-ovh/785R-ovh [158]. Purification of amplicons was performed by using the AMPure XP system (Beckmann). Next, sequencing was performed with pooled samples in paired-end modus (PE275) using an MiSeq system (Illumina, Inc.) according to the manufacturers instructions and 25% (v/v) PhiX standard library. Library preparation and sequencing of the HSCT dataset were performed at the Technische Universitt Mnchen. Briefly, volumes of 600\\(\\mu\\)L DNA stabilization solution (STRATEC biomedical) and 400\\(\\mu\\)L Phenol:choloform:isoamyl alcohol (25:24:1, Sigma-Aldrich) were added to the aliquots. 3.2.2.2 Microbial profiling For the HSCT dataset the processing of raw-reads was performed by using the IMNGS (version 1.0 Build 2007) [159] pipeline based on the UPARSE approach [158]. Sequences were demultiplexed, trimmed to the first base with a quality score &lt;3 and then paired. Sequences with less than 300 and more than 600 nucleotides and paired reads with an expected error &gt;3 were excluded from the analysis. The 5 nucleotides from each end of the remaining reads were trimmed to avoid GC bias and non-random base composition. Operational taxonomic units (OTUs) were clustered at 97% sequence similarity. Taxonomy assignment was performed at 80% confidence level using the RDP classifier and the SILVA ribosomal RNA gene database project. Later the data was normalized using the same method as for RNA-seq described above. The microbiome was visually inspected for batch effects in PCA; none were found. The resulting OTUs table was normalized using edgeR (Version 3.28 or later) [145]. For all the other datasets dada2 [160] (Version 1.14 or later) was used to analyze microbiome data. It creates amplicon sequencing variants from the 16S sequencing data, without merging similar sequences at any threshold. It is an alternative to the use of OTUs which allows to compare results between studies and provides more resolution to identify differences on the fragment of 16S amplified. We used Silva v138.1 to annotate the 16S fragments whenever possible [161]. If we did not have access to the direct ASV we used the annotation provided by the original authors of the dataset. Figure 3.1: Workflow of the main analysis process of the thesis. Created with BioRender.com 3.3 Integration methods The main method used on this thesis has been regularized generalized canonical correlation analysis (RGCCA) a method derived from the canonical correlation. Canonical correlation is a method that uses data about the same unit but from different origins to find how much the different sources agree. Regularized generalized canonical correlation analysis is implemented on the homonymous package RGCCA [131] which was used here. The method and implementation will be explained in detail in the next section. Figure 3.2: Multi-omic relationships on different datasets. Integration methods focus on relationships within datasets. Common relationships between datasets are used as confirmation/validation. Created with BioRender.com 3.3.1 Regularized generalized canonical correlation analysis To understand the regularized canonical correlation analysis we first provide a brief description of principal component analysis. Principal component analysis defines a new orthogonal coordinate system that optimally describes variance in a single dataset. It does so by decomposing the numerical matrix into the eigenvalues and eigenvectors with decreasing variance. Its results include new variables (the eigenvectors) and a vector of loadings or weight indicating the importance of the original variables for these new variables. Typically, data is normalized and standardized to avoid that a variable with higher variance and different scale dominate the results. The canonical correlation analysis [97, 162] is a method to find agreement between two, or more, scorers (as it was first introduced on the literature) or sources. It extends the PCA to a two sources of data. It provides a similar output, new variables and weights of the existing variables indicating their importance. The function it maximizes is: \\[ \\rho = \\underset{a, b}{\\text{argmax}} (\\text{cor}(a^T X, b^T Y)) \\] On this equation \\(a\\) and \\(b\\) are random variables that given \\(X\\) and \\(Y\\), the two data sources, maximize the correlation between \\(a^T X\\) and \\(b^T Y\\), the first canonical variables, the new variables. \\(a\\) and \\(b\\) are also known as weights or loadings of the variables. Over several years of progress on the field of canonical correlations [115, 116, 163167], regularized generalized canonical correlation analysis (RGCCA) emerged with a generalization from canonical correlations extending the procedure to more than two sources of data [R-RGCCA?] and being made more flexible generalizing from other proposed methods. 3.3.1.1 Description RGCCA works with numeric matrices that can be as big as needed, as it is designed for datasets with more variables than samples ( \\(p \\gg n\\)). However, for each sample it needs to have a complete case with no missing values (at the time of writing this thesis there is an in-development version, not released on CRAN2 yet, that replaces any missing value by a 0) and in which time is not considered as a special variable. It uses a dimensional reduction approach to relate the different blocks of data between them and produce specific factors for each dataset. The objective function is: \\[ \\underset{a_1,a_2, \\dots,a_J}{\\text{maximize}} \\sum_{j, k = 1}^J c_{jk} g( \\text{cov}(X_j a_j, X_k a_k)) \\text{ s.t. } (1-\\tau_j)var(X_j a_j)+\\tau_j \\Vert a_j \\Vert^2 = 1, j=1, \\ldots, J \\] Being \\(X_j\\) the values from sample \\(j\\), the weights of the variables of said sample are represented by \\(a\\). While \\(g\\) is a function that can take the form of \\(x\\), also known as Horst method, \\(|x|\\) known as centroid method, \\(x^2\\) known as factorial method, or any user-supplied function. \\(C\\) is a symmetric matrix describing the network between blocks. The shrinkage parameter is defined as: \\[ \\widehat{\\lambda}^{\\star} = \\dfrac{\\sum_{i\\neq j}\\widehat{Var}(r_{ij})}{\\sum_{i \\neq j}r_{ij}^2} \\] Where the \\(r_{ij}\\) are the correlation coefficients of the matrix between variables \\(i\\) and \\(j\\) . Where the variance is defined as: \\[ \\widehat{Var}(S_{ij}) = \\dfrac{n^2}{{(n-1)}} \\widehat{Var}({w}_{ij}) = \\dfrac{n}{{(n-1)}^3} \\sum_{k=1}^n ( w_{kij} - \\overline{w_{ij}})^2 \\] And its components are: \\(w_{kij}=(x_{ki}-\\overline{x}_i)(x_{kj}-\\overline{x}_j)\\) and \\(\\overline{w}_{ij}=\\frac{1}{n}\\sum_{k=1}^nw_{kij}\\) representing \\(x_{ij}\\) the values of a sample \\(j\\) on a variable \\(i\\). The authors realized that there is a special problem due to sparsity on biological data which could be handled using first another normalization to improve the stability and success of the canonical correlation methodology. The method to perform the dimensional reduction using the sparse method consists on maximizing the same equation but with a different constraint: Specifically, RGCCA with all \\(\\tau_j = 1\\), combined with an L1-penalty that gives rise to SGCCA: \\[ \\underset{a_1,a_2, \\dots,a_J}{\\text{maximize}} \\sum_{j, k = 1}^J c_{jk}g( \\text{cov}(X_j a_j, X_k a_k)) \\text{~~s.t.~~} \\Vert a_j \\Vert_2 = 1 \\text{ and } \\Vert a_j \\Vert_1 \\le s_j, j=1,\\ldots,J \\] The \\(s_j\\) controls the sparsity estimated of the data, the smaller it is, the higher the sparsity of \\(X_j\\) is. As \\(s_j\\) is closer to 0, more features are selected as it looks to optimize covariance; while if it is closer to 1, less features are selected and the function resembles the correlation. The values of \\(s_j\\) were estimated using the Schfer method [168] when the block included 16S data or RNAseq, otherwise 1 was used. As previously mentioned, there are different \\(g\\) functions that could be used; but the centroid method was chosen to detect both positive and negative relationships. Categorical data was encoded as binary (dummy) variables for each factor except one to keep degrees of freedom, where 0 indicates not present and 1 indicates present. One level was omitted to avoid overfitting the data. Each block, regardless if it had continuous numeric variables or dummy variables was standardized to zero mean and unit variance. Later, it was divided by the square root of the number of variables of the block for an unbiased estimation. 3.3.1.2 Output RGCCA, as other dimensional reduction techniques, provides specific weights for each variable on each dimension and a sample score on each dimension, together with quality scores. The most important output are the canonical components of each block. For each block there can be as many canonical components as the number of variables of a block minus 1. These canonical components represent a block by the largest source of variation on that block that satisfies the constrains explained below. To measure the quality of the model, the implementation provides indicators based on the Average Variance Explained (AVE). RGCCA returns an AVE score for each block, which measures how the variables of the block correlate with the dimension component of the block. It also provides two AVE scores of the whole model: the inner, which measures how each dimension accounts for the variance, and the outer, which measures how variables correlate with the dimension components. The closer the inner AVE is to 1, the better the model adjusts to the data. However, that mathematically fits better to the data does not guarantee that the model provides more insights into the biology. It can also generate results as other related methods based on the maximization of a function of correlations: SUMCOR (sum of correlations method) [169], SSQCOR (sum of squared correlations method) [170], SABSCOR (sum of absolute values of the correlations method) [171]. Others methods are based on the maximization of a function of covariances: SUMCOV (sum of covariances method), SSQCOV (sum of squared covariances method), SABSCOV (sum of absolute values of the covariances method). The following table summarizes the equivalent parameters needed on RGCCA to work: Table 3.6: Equivalences of RGCCA to other methods Method Scheme Normalization Shrinkage SUMCOR Horst \\(Var(X_j a_j) = 1\\) 0 SSQCOR Factorial \\(Var(X_j a_j) = 1\\) 0 SABSCOR Centroid \\(Var(X_j a_j) = 1\\) 0 SUMCOV Horst \\(\\Vert a_j \\Vert = 1\\) 1 SSQCOV Factorial \\(\\Vert a_j \\Vert = 1\\) 1 SABSCOV Centroid \\(\\Vert a_j \\Vert = 1\\) 1 There are other methods that can be performed with RGCCA, for example: The classical canonical correlation analysis would be equivalent to data variance equal to 1 and shrinkage of 0. Partial least squares (PLS) regression, which maximizes covariance, would be equal to data variance of 1 and shrinkage of 1 in RGCCA. Finally, redundancy analysis could be performed where one blocks weight normalized value is 1 and the variance of the other equals to 1. 3.3.1.3 Models There is no formal definition of what constitutes a block of data on multi-omics tools. Most multi-omics and integration tools assume one block for each type of data, such as an essay a survey or an experiment. We decided to split the block with the variables about the samples to separate independent variables. The hypothesis we made was that more blocks with highly related variables but independent from the other blocks would fit better the data and thus help to identify causal or dependent variables. To model what might be the relationships within datasets current practices include using a pre-selected model of relations between blocks (See figure 3.2). However, this model might not be an accurate representation of the relations between blocks and several models might need to be fitted. To help find the fitting model for the data we created an R package, named inteRmodel, which helps finding the right model for the dataset via a bootstrapping procedure. This method was applied to the previously described datasets to find the relationship between microorganisms and the disease. Following this method; to provide a ground truth, a model with only the relationships between the two experimental obtained data is analyzed, on what it is called the model 0. The next models analyzed consisted on relationships between the two experimental blocks and a block with all the metadata of the samples. These models are denoted by 1.Y, where 1 denotes the family 1 and Y is used to label some of the models of this family. Later instead of a big metadata block, following our theory we split this metadata block on several ones, having a block for time related variables, another one for location and the other about the people on the study. This allows to design a model with an expected relationships between these blocks and makes more interpretable the relationships. These models are from the family 2 denoted by the name 2.Y, where 2 denotes the family of the model and Y change for particular models with different relationships between the blocks change. For each family of models we tested all possible relationships with weights between 0 and 1 by 0.1 intervals to find the best model on each datasets according to the AVE score. The final models were further validated using a bootstrap approach to measure their accuracy and likelihood on the data available. 3.3.2 Other 3.3.2.1 MCIA Multiple co-inertia analysis, also known as MCIA, is a method to examine covariant gene expression patterns between two blocks [172]. It is implemented on the package omicade4. On its core MCIA maximizes the following formula: \\[ \\sum_{k=1}^K w_k {cov}^2 (X_k Q_k u_k, v) \\] where \\(K\\) is the total number of matrices, \\(X_k\\) the transformed matrices and \\(Q_k\\) is a square matrix with \\(r_{ij}\\) in diagonal elements indicating the hyperspace of features metrics, \\(u_k\\) are auxiliary axes, \\(v\\) the reference structure and w the weights of the matrices. This can be used to obtain a dimension of \\(P_k^d=u_k^d(u_k^d Q_k {u_k^d}^T)^{-1} u_k^d Q_k\\) given that for each dimension the residuals are obtained following \\(X_k^{d-1} = X_1^d- X_1^d P_1^{d-1}\\) where \\(d\\) are the dimensions needed. MCIA was used as a baseline method to compare the RGCCA integration. 3.3.2.2 STATegRa We used STATegRa To explore how much do different blocks of a dataset have in common [173]. It is a framework for integrating datasets with two data types using parametric and non-parametric methods. The methods used are omics component analysis based on singular value decomposition (SVD) of the data matrix. There are three different methods provided to this end: DISCO-SCA, JIVE and O2PLS. DISCO-SCA uses: \\[ X_k = TP_k ^ T + E_k \\] Where \\(T\\) is the \\(I \\times R\\) matrix of components scores that is shared between all blocks and \\(P_k\\) the \\(J_k \\times R\\) matrix of components loadings for block \\(k\\). Let \\(X_1,X_2, \\dots X_i\\) be blocks of data and \\(X=[X_1,X_2, \\dots X_i]\\) represent the joint data, then the JIVE decomposition is defined as: \\[X_i=J_i+A_i+\\epsilon_i \\text{, }i = 1,2, \\dots\\] where \\(J=[J_1,J_2, \\dots J_i]\\) is the \\(p \\times n\\) matrix of rank \\(r&lt;rank(X)\\) representing the joint structure, \\(A_i\\) is the \\(p_i\\times n\\) matrix of rank \\(r_i &lt; rank(X_i)\\) representing the individual structure of \\(X_i\\) and \\(\\epsilon_i\\) are \\(p_i \\times n\\) error matrices of independent entries. Finally, the O2PLS approach uses multiple linear regression to estimate the pure constituent profiles and divides the systematic part into two, one common to both blocks and one not. The O2PLS model can be written as a factor analysis where some factors are common between both blocks. \\[ \\begin{aligned} &amp; \\text{X model : } X = TW ^ T + T_{\\text{Y-ortho}} P ^ T_{\\text{Y-ortho}} + E \\\\ &amp; \\text{Y model : } Y = UC ^ T + U_{\\text{X-ortho}} P ^ T_{\\text{X-ortho}} + F \\\\ &amp; \\text{Inner relation : } U = T + H \\end{aligned} \\] Each model is built similarly by adding the subtraction of the projected values of the other component keeping the relationship between them as stated on the third line. 3.4 Functional enrichment methods 3.4.1 Over representation analysis Functional enrichment methods are those methods that aim to provide with more information about the variables besides their numerical value measured. They can be very different in nature but they all use the numeric values of the variables and other information, being it from the same experiment data collection or from external data sources. Many functional enrichment methods are based on an over representation analysis, where a group of elements is tested for their mesure in other groups. This can be done with clusterProfiler which tests genes enrichment for functionality based on information on pathway databases [174] that it is used in several publications [175]. clusterProfiler checks the enrichment of features of a given group on the (background) list provided. \\[ \\begin{aligned} H_0 : P_{subset} \\leq P_{overall} \\\\ H_1 : P_{subset} &gt; P_{overall} \\end{aligned} \\] The statistical test used is usually the fisher test, the hypergeometric test or the proportion test. We describe the hypergeometric test and the proportion test below. 3.4.1.1 Fisher test The fisher test calculates how independently are two categories. Say if genes in category X are independent of category Y, if we use the contingency table Table 3.7: Fisher contingency table In category X Not in category X Row total In category Y \\(a\\) \\(b\\) \\(a+b\\) Not in category Y \\(c\\) \\(d\\) \\(c+d\\) Column total \\(a+c\\) \\(b+d\\) \\(a+b+c+d = n\\) Given this contingency table 3.7, the probability of X and Y being independent can be calculated with: \\[ \\begin{aligned} P &amp; = \\dfrac{ \\binom{a+b}{a} \\binom{c+d}{c} }{\\binom{n}{a+c}} \\\\ &amp; = \\frac{(a+b)!~(c+d)!~(a+c)!~(b+d)!}{a!~~b!~~c!~~d!~~n!} \\end{aligned} \\] 3.4.1.2 Hypergeometric test The hypergeometric distribution describes the probability of \\(k\\) successes (when the object drawn has a specified feature) in \\(n\\) draws3, from a finite population of size \\(N\\) that contains exactly \\(K\\) objects with that feature, wherein each draw is either a success or a failure. In this context \\(N\\) is the number of genes being used and \\(n\\) the number of genes on a pathway. It can be used to compare the genes found on a pathway (\\(k\\) genes) compared to the expected \\(K\\) numbers of the distribution using the following equation: \\[ P_X(k) = P(X = k) = \\frac{\\binom{K}{k} \\binom{N - K}{n-k}}{\\binom{N}{n}} \\] This looks like the fisher test, because hypergeometric test assesses the extremeness of observing \\(k\\) or more of that overlap (\\(a\\) on ) and thus it is the same as a one-sided Fishers exact test. 3.4.1.3 Proportion test The overrepresentation of a given group of elements can also be tested with the proportion test, which is sometimes also used on clusterProfiler. The proportion test uses the \\(\\chi^2\\) distribution to test if the observed frequency (\\(O_i\\)) is close to the expected frequency (\\(E_i\\)): \\[ \\chi^2 = \\sum_{i =1}^n \\dfrac{(O_i - E_i)^2}{E_i} \\simeq \\chi_{n-p}^2 \\] As this is usually done on a 2x2 contingency table it is equivalent to the Z-test of proportion. Sometimes, the expected frequency is so low that a correction must be done to the estimation: \\[ \\chi_{\\text{Yates}}^2 = \\sum_{i =1}^n \\dfrac{(|O_i - E_i | - 0.5)^2}{E_i} \\] This increases the \\(p\\)-value as it raises the Chi-square statistic. 3.4.2 Gene Set Enrichment Analysis There are other methods that test if some variables show an unexpected importance according to a statistic like fold change or value, such as gene set enrichment analysis (GSEA) [176]. GSEA is a computational method originally developed to determine whether a priori defined set of genes shows statistically significant and concordant differences between two biological states. This methods check if a group of variables present in an ordered list shows a skewed distribution and it compares it against a random group of similar size. It has been widely used since its original publication, also in IBD [177]. This method calculates the rank of genes \\(rank(g_j)=r_j\\) where each \\(g\\) is a gene, and then it calculates the following functions: \\[ \\begin{aligned} &amp; P_{hit}(S, i) = \\sum_{g_j \\in S, j \\leq i}\\dfrac{|r_j|^p}{N_R} \\text{, where } N_R = \\sum_{g_j \\in S}|r_j|^p \\\\ &amp; P_{miss}(S, i) = \\sum_{g_j \\not \\in S, j \\leq i}\\dfrac{1}{N - N_H} \\end{aligned} \\] With these values the enrichment score (ES) defined as: \\(ES=max(|P_{hit}(S, i)-P_{miss}(S, i)\\vert)\\) is calculated from the walk. At least 1000 permutations are usually used but a high number of permutations are required for an accurate estimation of the enrichment score. However, when more than one pathway (\\(S\\)) is evaluated in order to compare between their enrichment scores, they must be normalized by dividing the scores by the mean of all the ES. When power \\(p\\) is 0 it is equivalent to the standard KolmogorovSmirnov statistic, though it is usually set to 1. For testing GSEA we used fgsea [178] implementation for its speed and integration with other methods used in this thesis. Gene pathways from the REACTOME database were tested on the weight of different models or on the comparisons performed [179]. 3.4.2.1 GSVA To estimate the expression of the pathways and compare their expression levels between conditions gene set variation analysis as implemented on GSVA was used [180]. It is a method that summarizes the variables numerical value changing the space of \\(\\text{variable x sample}\\) to \\(\\text{group x sample}\\) . This enables other methods to use this new space instead of the original variables, which provides a successful way to look into data [181]. GSVA was used (again from the REACTOME database) to find the relationships between the pathways and the microbiome at different taxonomic levels. This is done via an estimation and a comparison with a discrete Poisson kernel: \\(i\\) indicates the gene from a total of \\(k\\) genes, and samples are indicated by \\(j\\) from \\(n\\) number of samples. \\[ z_{ij}=\\hat{F_r}(x_{ij}) = \\frac{1}{n}\\sum_{k=1}^n\\sum_{y=0}^{x_{ij}}\\dfrac{e^{-(x_{ik}+r)}(x_{ik} + r)^y }{y!} \\] \\(r = 0.5\\) is used to set the mode of the Poisson kernel at each \\(x_{ik}\\), that is, similar to the expression of a gene for a given sample. Later this is converted to ranks \\(z_{(i)j}\\) for each sample and normalized: \\(r_{ij}=|\\frac{p}{2}-z_{(i)j}|\\) to make the distribution of ranks symmetric around zero to later compare with a normal distribution using a Kolmogorov-Smirnov-like random walk statistic: \\[ v_{jk}(l)=\\dfrac{\\sum_{i=1}^l|r_{ij}|^{\\tau}I(g_{(i)}\\in \\gamma_k)}{\\sum_{i=1}^p|r_{ij}|^{\\tau}I(g_{(i)} \\in \\gamma_k)} - \\dfrac{\\sum_{i=1}^lI(g_{(i)} \\not \\in\\gamma_k)}{p-|\\gamma_k|} \\] Here \\(\\tau\\) describes the weight of the tail in the random walk (default is set to 1). \\(\\gamma_k\\) is the k-th gene set and \\(I(g_{(i)}\\in \\gamma_k)\\) is the indicator function whether the gene ranked i-th belongs to the gene set \\(\\gamma_k\\) . \\(|\\gamma_k|\\) indicates the ordination of the gene set, the number of genes of the gene set and \\(p\\) the number of genes in the dataset. This difference is later converted to enrichment score for each gene set for each sample, similar to GSEA. This score can be calculated as a difference of hits and misses or the maximum deviation from zero of the random walk (which allows to detect gene sets that have genes with different opposing expression patterns). 3.5 Variance and diversity methods 3.5.1 PERMANOVA The PERMANOVA method [182, 183], provided by the vegan package on the adonis function, was used to test if microbiome data variance is due to other variables when using distances metrics. It uses the residual sum of squares such as: \\[ SS_W = \\frac{1}{n} \\sum_{i=1}^{N-1}\\sum_{j=i+1}^N d_{ij}^2\\epsilon{ij} \\] When using euclidian distances (\\(d\\)) it is equivalent to MANOVA. Here \\(\\epsilon_{ij}\\) takes the value of 1 if the observation \\(i\\) and the observation \\(j\\) are in the same group, otherwise it takes the value of 0. This can be later used to test which variance is bigger, inter-groups or intra-groups by using the following formula: \\[ F = \\dfrac{SS_A/(\\alpha -1)}{SS_W/(N-\\alpha)} \\] Where \\(SS_A\\) is the among group sum of squares, representing the intra-group variance. \\(N\\) is the number of samples and \\(\\alpha\\) the number of different groups. This allows to test if the variables are related to the variance of the data as it can be compared with the \\(F\\) statistic after a high number of permutations. 3.5.2 globaltest It is a method for testing complex hypothesis and calculate the influence of each variable on a given outcome [184]. We tested which variables, (sex, age, location, time since diagnosis, treatment) are important on the datasets with globaltest (Version 5.40 or later). This method provides a general statistic to test hypothesis against a high dimensional dataset. \\[ S = \\sum_{i=1}^p x_i^{&#39;} x_i g(t_i^2) \\] The global test performs a test statistic on the transformed t-test, where if \\(p\\), the number of variables, is large the test is more powerful on average over all possible sparse alternatives of general functions \\(g\\). It was performed with variables individually and also with interactions between the different variables. 3.5.3 Diversity indices Microbiome diversity was measured using vegan and phyloseq methods [185]. \\(\\alpha\\)-diversity is a measure of how much a given microbiome at a taxonomic level is present on a sample. Several measures exists, on the thesis we used the effective Simpson or effective Shannon diversity index to compare diversity between samples and conditions. The effective Simpson (also known as inverse Simpson) and the effective Shannon are: \\[ \\begin{aligned} &amp; D_{\\text{effective Simpson}} = \\dfrac{1}{\\sum_{1=1}^Sp_i^2} \\\\ &amp; D_{\\text{effective Shannon}} = \\dfrac{1}{-\\sum_{i =1}^S p_i \\log_e{p_i}} \\end{aligned} \\] Where \\(p_i\\) is the proportion of species \\(i\\) and \\(S\\) is the number of species. \\(\\beta\\)-diversity is a diversity index that compares how similar are two samples. It was calculated using the phyloseq package for exploratory analysis. 3.6 Other methods 3.6.1 Statistics Differential expression analysis was performed with the limma-trend method [186, 187] and edgeR [145] (Bioconductor version 3.10 or superior) packages. Data was normalized using the trimmed mean of M-values and log-2 transformed into counts per millions following the workflow previously described using voom [188]. This approach assumes tests for each gene that: \\[ H_0 : \\mu_{X} = \\mu_{Y} H_1 : \\mu_{X} \\neq \\mu_{Y} \\] Limma assumes that \\(E(y_g) = X \\alpha_g\\), and \\(var(y_g) = W_g \\sigma_g^2\\) where X is a design matrix and \\(\\alpha_g\\) is an unknown coefficient vector and \\(\\sigma_g^2\\) is the gene-variance and \\(W_g\\) is a known non-negative definite weight matrix. The design matrix of limma can be combined with contrast estimators defined such that \\(\\beta_g = C^T \\alpha_g\\) where \\(C^T\\) is a constant vector typically defining how a given variable is related to a sample. These statistics are later estimated via bayesian method whose prior is defined as: \\[ \\dfrac{1}{\\sigma_g^2} \\sim \\dfrac{1}{d_0 S_0^2} \\chi_{d_0}^2 \\] This results on a moderated t-test: \\[ \\widetilde t_{gj} = \\dfrac{\\hat \\beta_{gj}}{\\tilde S_g \\sqrt{v_{gj}}} \\sim t_{d_g + d_0} \\] Were \\(\\hat \\beta_g\\) can be interpreted as the difference of the effect of two factors. As gene comparisons are done along many genes there is an increase probability to have a type I error. Multiple testing correction method have been designed to correct this kind of family-wise comparisons. To correct for multiple testing, the false discovery rate was estimated using the method of Benjamini and Hochberg [189]. A gene was considered differentially expressed when it was significant at 5% FDR. Special attention was given to those genes that showed a fold-change higher than |1.5|. 3.6.2 WGCNA To look for relationships between the microbiome and the RNAseq we used weighted gene co-expression network analysis. We used weighted gene co-expression network analysis as implemented on WGCNA [190] as well as correlations. The Spearman rank correlation coefficient is: \\[ R_s(X,Y) = \\dfrac{\\sum_{i=1}^n (R_i - \\bar{R}) (S_i - \\bar{S} )}{\\sqrt{\\sum_{i=1}^n (R_i - \\bar{R})^2}\\sqrt{\\sum_{i=1}^n (S_i - \\bar{S})^2}} \\] Being \\((X_1 , Y_1 ),\\dots, (X_n , Y_n)\\), assign a rank where \\((R_1 , S_1 ), \\dots , (R_n , S_n )\\) for \\(n\\) being all the variables where \\(\\bar{R}=\\dfrac{1}{n}\\sum_{i=1}^n R_i\\) and likewise \\(\\bar{S}=\\dfrac{1}{n}\\sum_{i=1}^n S_i\\). The distribution of the Spearman correlation coefficient is symmetric around 0 and can be approximated to a normal distribution as \\(\\sqrt{n-1}R_{s(X,Y)} \\sim N(0,1)\\) which can be used to calculate the p-value of a given estimation. 3.6.3 BaseSet BaseSet was developed and used to find which variables are really involved on the interaction and how likely they were to be together. It is a package that uses fuzzy set logic to calculate the probability to belong to a group, in this case, those genes and bacteria selected by the model that interact with the other. Under the standard fuzzy set logic a set \\(S\\) is a group of elements for which each element \\(e\\) has an \\(\\alpha\\) membership to that set [191, 192]. \\(\\alpha\\) is usually bounded between 0 and 1: \\(\\alpha \\in [0, 1]\\) . A given element \\(e\\) can belong to more than one set. Assimilating the membership function to probability we can calculate the probability of a given element \\(e\\) to belong to a set \\(S\\) and not any other set: \\(P(e \\in S|e \\not \\in S^c)\\). Which applied to the data and the case at hand, it is the probability that a given variable is associated with a given outcome and not with any other outcome. The membership function was derived from the bootstraps used for each model on the thousand iterations of the integrative method applied to give an estimation of how probable is a given gene and bacteria to be selected as relevant for the model. The bootstraps of the models where used to calculate the probability of a variable to be selected by RGCCA. This probability was used to calculate (via set_size) the genes and bacteria that are specific of the model that allows to separate the transcriptome by its location and the microbiome by the disease status. 3.6.4 experDesign experDesign was developed [193] to prevent and quantify if a given experiment has batch effect due to the batches used to measure the values or other known variable. It might help to detect a bad design of the experiment. On pseudo code the core of the program can be described as: for each index: for each batch pick size(batch) samples if samples are in another batch pick other samples for each batch calculate some summary statistics compare with the summary statistics of all the samples keep the index with less differences between the index and all the samples Summary statistics taken into account are the median, the variance, the range, the number of missing values, and the entropy of the categorical variables. It can take into account spatial distribution and, given the number of samples that fit on a batch, provide which technical replicates4 are best to use. 3.6.5 ROC- AUC To estimate if the selected features (genes or microorganism) by the integration methods have some biological meaningful contribution we measured if they can classify features, such as, which gastrointestinal segment is each sample from, or which type of disease does each patient have. To compare between different models the area under the curve (AUC) of the receiver operating characteristic (ROC) was calculated with the pROC package [194]. It is based on the following formulas, where \\(\\text{FP}\\) is false positive, \\(N\\) is a negative, \\(P\\) is positive, \\(\\text{TP}\\) is true positive and \\(\\text{FN}\\) is false negative: \\[ \\begin{aligned} FPR = \\frac{FP}{N} = \\dfrac{FP}{FP+TN} \\\\ TPR = \\frac{TP}{P} = \\dfrac{FP}{FP+FN} \\end{aligned} \\] The ROC curve is that where the true positive rate (TPR) or sensitivity, recall or hit rate is represented against the false positive rate (FPR) on the abscissa. The area under this curve is a measure of how good such classifications performs overall, being 0.5 as good as a random selection. The closer it is to 1 the better as it classifies incorrectly less samples and accurately classify more. References "],["results.html", "Chapter 4 Results 4.1 Packages/methods 4.2 Analysis", " Chapter 4 Results 4.1 Packages/methods 4.1.1 experDesign experDesign package built in R was released for the first time on CRAN on 2020-09-08 after nearly a year after the initial release made on github. After peer review it was published on a journal on 2021-11 [193]. The package uses functional programming to create and modify objects and the features used. The package bases its performance on the large body of work made by the R core team. It adds the information to the introduced data.frame or returns an vector with the appropriate information. experDesign functions are divided into several categories: Helper functions to aid on deciding how many batches are or how many samples per batch. There are some also that report how good a given distribution of the samples felt for a given dataset. Functions generating indexes. Functions distributing the samples on indexes Figure 4.1: experDesign functions and workflow. Workflow for users of the package showing which functions can be used depending on the experiment design they have. Regarding time related variables experDesign will use them as factors, while issuing a warning to the user. Since its development it has been used on a couple of RNA sequencing experiments that required a batch design, one of organoids bulk RNA-seq (data not related to this thesis) and another one of biopsies bulk RNA-seq from the BARCELONA cohort (See appendix section D.1). It was also used to check if there is any observable batch effect on the datasets analyzed. On the designed datasets experDesign avoided batch effects from the sequencing process. However, on the organoids dataset, a change on the matrigel used to produce them introduced a batch effect that made it impossible to compare samples before and after that change (there were not any shared sample before and after the change of matrigel). On the BARCELONA cohort there were other problems described on the appendices (section D.1). Since its release on CRAN it has had a median of ~400 downloads each month from RStudio repository mirror, showing the interest the community have on solutions like this. 4.1.2 BaseSet BaseSet package, built in R, was released for the first time on CRAN on 2020-11-11, nearly two years after the initial work started on github. The package uses both functional programming and object oriented program to create and modify the TidySet S4 object defined5. Mixing it with S3 generic functions it provides a powerful interface compatible with the tidyverse principles, a group of packages following the same design. The package provides a new class to handle fuzzy sets and the associate information. BaseSet methods are divided into several categories: General functions to create sets of the TidySet class or convert from it to a list or about the package. Set operations like adjacency cartesian product, cardinality, complement, incidence, independence, intersection, union, subtract, power set or size. Functions to work with TidySets to add relationships, sets, elements or some complimentary data about them. Remove the same or simply move around data or calculate the number of elements, relations and sets. Functions to read files from formats where sets are usually stored in the bioinformatician field: GAF, GMT and OBO formats. Last, some utility functions to use set name conventions and other auxiliary functions. The package had a long development process with initial iterations based on GSEABase package which was later abandoned (GSEAdv) to also include some uncertainty on the relationship of a gene with a given gene set. The package formed part of an exploration of the Bioconductor community (project to develop, support, and disseminate free open source software that facilitates rigorous and reproducible analysis of data from current and emerging biological assay) for more modern and faster handling of sets than GSEABase. There were three different packages created as part of this process, BaseSet, BiocSet released on Bioconductor and unisets, available on github. The three different approaches were presented at a birds of feather on BioC2019, the annual conference of Bioconductor on 2019. The package passed the review on the rOpenSci organization (See review) and is now part of the packages hosted there too. Since its release on CRAN it has had a median close to ~400 downloads each month from RStudio package manager. 4.1.3 inteRmodel The package was build once the method used to find accurate models of the relationships of the data available of a dataset using RGCCA was established. Using the package on github simplifies the process and makes easier to redo the model optimization used on this thesis. The package has functions that can be grouped in three categories: Look for models and evaluate them: To search for a model given some conditions, such as that all the blocks are connected, and check the models via bootstrapping or leave one out procedures. Reporting: To make better reports by improving handling of names or simplifying the objects or how to calculate scores. Building: To easier build correct models on RGCCA, simplifying the process to create a symmetric matrix. Currently it is only available on github, so the number of downloads and usage is unknown but since its release a user has contacted to keep it up to date with development versions of RGCCA. Currently, it is compatible with the next release of RGCCA being prepared6. The functions analyze helps to analyze code of a single integration, providing the results on a tidy format for further processing. To create the connections between blocks the function weight_design is available. It creates all the possible matrices given a number of blocks and a number of weights. Optionally it can create just a subset of those based on a numeric vector. However, it does not provide a way to have the design named. If the user wants to create their own design matrices, they can use symm and modify the design of the model with subSymm. symm, takes an initial matrix to pick up the row and column names. It is recommended that the user checks the design matrix is fully connected, which the package facilitates with the function correct. This is also recommended even if the design matrices are created with weight_design. To search models search_models starts with a initial connectivity of the blocks and creates all the combinations of connections given. For the bootstrap procedure there is the function boot_index to create the bootstrapped index of samples to be used by boot_index_sgcca. boot_index randomly selects as much samples as specified by the arguments to create as much indices as the required by the second argument. If the bootstrapped samples used is not important one can use boot_samples_sgcca. If the users want to perform a leave-one-out procedure they can use looIndex. Figure 4.2: inteRmodel functions and workflow. Functions provided by the inteRmodel package to search and validate models of relationships using RGCCA. Created with BioRender.com For more information, you can access the manual online or once it is installed. The package cannot choose which variables use from the block with information to split into several blocks. However, it provides the model_RGCCA function to make it easy to prepare such variables for RGCCA input. The inteRmodel procedure will only be useful if the user should decide which variables are independent from others and split them into different blocks. To asses this the user can use the methods we used, as described on the above section 3.5. It is important to keep in mind the possible causal relationships on users data [196]. 4.2 Analysis On the following sections the main results of analyzing each dataset are presented. 4.2.1 Pugets dataset On this dataset the different parameters and capabilities of RGCCA were tested. The three different methods, centroid, factorial or horst were tested and compared. The main result of this comparison was that the differences of the selection of the variables mattered more than the number of variables selected with each method. The models were tested with different weights on all three schemes: horst, centroid and factorial. The horst and the centroid scheme were similar while the factorial resulted in the most different AVE values (see S1 Data of [197]). The centroid scheme was selected because it takes into account all the relationship regardless of the sign of the canonical correlation between the blocks. It is similarity to horst scheme. The effect of the sparsity value was measured by its effect on the inner AVE scores and the combination of the different values for each block as can be seen on Figure 4.3. Figure 4.3: Effect of tau on the inner AVE on Pugets dataset. The suggested tau value is the column between the regular grid, on the ordinate axis the ys tau values and on the abscissa the gene expression (GE) on the left and the comparative genomic hybridization (CGH) on the right. The highest inner AVE is with high tau values for y and middle to upper values for GE and CGH. The first model of the family of models 1 can be seen on Table 4.1: Table 4.1: Model 1 for Pugets dataset. Relationships between the different blocks in the Puget dataset for model 1. 0 indicates no relationship and 1 indicates a strong relationship. Model 1 GE CGH Localization GE 0 0 1 CGH 0 0 1 Localization 1 1 0 When looking for the model that adjust better following this structure we arrived to model 1.2, described below (Table 4.2) : Table 4.2: Model 1.2 for Pugets dataset. Relationships between the different blocks in the Puget dataset for model 1. 0 indicates no relationship and 1 indicates a strong relationship. Model.1.2 GE CGH Localization GE 0 0.0 1.0 CGH 0 0.0 0.1 Localization 1 0.1 0.0 On model 2 we split the invariable variables from those related to the location (Table 4.3): Table 4.3: Model 2 for Pugets dataset. Relationships between the different blocks in the Puget dataset for model 1. 0 indicates no relationship and 1 indicates a strong relationship. Model.2 GE CGH Invariable Localization GE 0 1 1 1 CGH 1 0 1 1 Invariable 1 1 0 0 Localization 1 1 0 0 Following this split, the model that has higher inner AVE for these blocks is the following (Table 4.4): Table 4.4: Model 2.2 for Pugets dataset. Relationships between the different blocks in the Puget dataset for model 1. 0 indicates no relationship and 1 indicates a strong relationship. Model.2.2 GE CGH Invariable Localization GE 1 1/3 0 1 CGH 1/3 0 1/3 0 Invariable 0 1/3 0 0 Localization 1 0 0 0 If we added a superblock with all the data of the different blocks from model 1 we started with the standard relationship between blocks (Table 4.5): Table 4.5: Relationships between the different blocks in the Pugets dataset for model superblock. 0 indicates no relationship and 1 indicates a strong relationship. Model.superblock GE CGH Superblock Localization GE 0 0 1 0 CGH 0 0 1 0 Superblock 1 1 0 1 Localization 0 0 1 0 But when the best model with the superblock that had highest inner AVE is quite different (Table 4.6): Table 4.6: Relationships between the different blocks in the Pugets dataset for model superblock.2. 0 indicates no relationship and 1 indicates a strong relationship. Model.superblock GE CGH Superblock Localization GE 1 1/3 0 1 CGH 1/3 0 1 0 Superblock 0 1 0 0 Localization 1 0 1 0 Exploratory analysis with the superblock model was done. The first two components of the superblock did not help to explain the biology or classify the tumors (See 4.4): Figure 4.4: First components of the superblock which has all the data of the samples on the Pugets dataset. The same data was used to look for a good model from the data itself including a model with a superblock but looking at the first component of the CGH and transcriptome block. This allowed to visually inspect if each models components helped to classify the samples (Figure 4.5): Figure 4.5: Different RGCCA models in the Pugets dataset. The different models with the same data showing the sample position on the first components of the CGH and the transcriptome block. Model 1 and 1.2 with transcriptomics, CGH data and all the data about the samples together. Model 2 and 2.2 with transcriptomics, CGH data and all the data bout the samples on different blocks. Model superblock and superblock.2 have all the data in different blokcs and one block with all the data. The first components of the CGH and the transcriptomics blocks of the superblock.2 model show better classification than that of the superblock. However, the other models show a better classification of the samples with much simpler models. To find these models the three blocks with the best tau and the centroid scheme were analyzed by changing the weights between 0 and 1 by 0.1 intervals. According to the inner AVE, the best model was the one in which the weights (1) between the host transcriptome and location, (2) the host transcriptome and the CGH, and (3) the CGH block were linked to variables related to the location with weights of 1, 0.1 and 0.1, respectively. When we added a superblock to the data, there was a slight increase of 0.01 on the inner AVE of the model (See Table 4.7). The model with the superblock that explained most of the variance was that in which the weights of the interaction within (1) the host transcriptome, (2) between the superblock and the CGH, (3) between the host transcriptome and the localization, and (4) between CGH and the host transcriptome were 1, 1, 1 and 1/3, respectively (See table 4.6. To see if the superblock could classify the sample by location, we plotted the first two components of the superblock. We can clearly see that they do not classify the samples according to the location of the tumor, which is known to affect the tumor phenotype [149]. Adding one block containing the age of the patient and the severity of the tumor to the model, decreased the inner AVE. The best model with these blocks, according to the inner AVE, was that in which the interactions (1) within the host transcriptome, (2) between the host transcriptome and the localization, (3) between the host transcriptome and(4) the CGH and between the CGH and the other variables were 1, 1, 1/3 and 1/3, respectively. The first components of each model can be seen in the figure: We can observe on the figure 4.5, the strong dependency between gene expression and location since the first model while the weaker relationship with the CGH assay [149]. On the other hand, the major difference is the dispersion on the CGH component on each model. The effect of the superblock and weights on different models to the inner AVE. There are significant differences between having the superblock and not having it. Figure 4.6: Effect of superblock and weights on the inner AVE on Pugets dataset. Designs with the superblock showed higher inner AVe scores than without it. Interaction yes/no indicates RNA and RNA interaction. The different models resulted on the following AVE values as reported on 4.7: Table 4.7: AVE values of RGCCA models in the Pugets dataset. Values for both inner and outer AVE of the first canonical component of models 1, 1.2, 2 2.2 and superblock and superblock.2 are shown. Model inner AVE outer AVE 1 0.6333592 0.0692097 1.2 0.8512360 0.0692319 2 0.2791546 0.0738695 2.2 0.6902329 0.0692707 superblock 0.7055847 0.0734578 superblock.2 0.8047477 0.0695821 4.2.2 HSCT dataset The permanova analysis was performed on this dataset to estimate which were the variables that are more relevant. From the many variables the location, sex, patient id and others were found to be related to the variability of the microbiome or the transcriptome on this dataset. With the permanova analysis we found that more of the 50% of the variance of normalized RNA-seq data and microbiome data respectively is explained by the variables of location, disease, sex, and the interaction between disease and sex. On the transcriptome the most important factor is location which is more than 15% of the variance, while on the microbiome data the most important factor is the patient id followed by location of the sample. Table 4.8: Permanova analysis of transcriptome. The variables and their interactions (shown with :) and the \\(R^2\\) values and the associated p-value. The higher the \\(R^2\\) the more variance is explained by that factor. Factor R p-value Location 0.18057 0.00020 IBD 0.03120 0.00020 Sex 0.01306 0.00120 IBD:Sex 0.01279 0.11798 Location:IBD 0.02427 0.11458 Location:Sex 0.00816 0.03519 Location:IBD:Sex 0.00486 0.52190 Residuals 0.72508 Table 4.9: Permanova analysis of microbiome. The variables and their interactions (shown with :) and the \\(R^2\\) values and the associated p-value. The higher the \\(R^2\\) the more variance is explained by that factor. Factor R p-value Location 0.06061 0.0002000 IBD 0.04967 0.0002000 Sex 0.01712 0.0003999 IBD:Sex 0.01091 0.6604679 Location:IBD 0.02089 0.8476305 Location:Sex 0.01139 0.0075918 Location:IBD:Sex 0.00289 0.9994001 Residuals 0.82652 With globaltest the results were similar: sex, ibd, location, age and time since diagnosis were able to explain the SESCD score (p-value \\(5.7 \\cdot 10^{-21}\\) ). The resulting p-value was well below the 0,05 threshold defined for RNA-seq data on the models including the segment of the sample, sex and treatment. On the microbiome data the results were similar but the p-value was considerably higher but still below the threshold. Figure 4.7: Microbiome diversity in the HSCT dataset. On the upper section the Shannon effective and on the lower row the Simpson effective diversity splitted by colon and ileum and controls and CD. Diversity indices of the samples were explored and compared for several subsets. Splitting by location of the sample and disease provided the highest differences and the diversity index along time did not change much. The PCA didnt show any pattern on the microbiome according to the location, as can be seen on the first dimensions of the PCA on figure 4.8: Figure 4.8: PCA of the 16S data of the HSCT dataset. Samples colored by location of the segment. There are no clear patterns according to the location. The PCA on the transcriptome shows a clear pattern splitting by location of the sample on the first dimension (see figure 4.9). Figure 4.9: PCA of the RNAseq data of the HSCT dataset. Samples colored by location of the segment. The samples separate according to the location. Weighted gene co-expression network analysis did not provide relevant links between bacteria and transcriptome as it failed to find an acceptable scale free degree. As can be seen on the Figure 4.10, the scale free topology does not reach the recommended threshold of 0.9 and the mean connectivity is also very low even for the first power. Figure 4.10: Power evaluation of WGCNA of the HSCT dataset. On the ordinate the power on the abscissa on the left the scale free topology model fit; on the right the mean connectivity. There is a low fit even on large power and the mean connectivity is below 100 from the very first value. STATegRa was used between stool 16S data and intestinal 16S data under the assumption that there is a shared common factor without influence of other categorical variables. However, it did not find a good agreement between these two data sources and 16S data source was not longer used on the analysis. In addition, the model is fixed, so it did not allow to find new or other relationships that are not one to one. With RGCCA we could select different models and use all the data available without much assumptions. The models with the highest inner AVE of the family 1 and the family 2 models were similar to those on the Hsler dataset. Figure 4.11: Models in the HSCT dataset. On the abscissa the transcriptome, on the ordinate the Microbiome. Each square represents a different model of the HSCT dataset. On panel A colored by disease status, on panel B colored by sample location. Model 0 has only transcriptome and microbiome data, models 1 to 1.2 with data about the samples and models 2.1 to 2.3 with data about the samples split in 3 blocks. The weights of these models can be observed here: Table 4.10: Relationships between the different blocks in the HSCT dataset for model 0. 0 indicates no relationship and 1 indicates a strong relationship. Model 0 Transcriptome Microbiome Transcriptome 0 1 Microbiome 1 0 If we include the information about the samples all together in a block called metadata we can start from this model on 4.11: Table 4.11: elationships between the different blocks in the HSCT dataset for model 1.1. 0 indicates no relationship and 1 indicates a strong relationship. Model 1.1 Transcriptome Microbiome metadata Transcriptome 0 0 1 Microbiome 0 0 1 metadata 1 1 0 When looking for the model that adjust better following this blocks we arrived to model 1.2 thanks to inteRmodel, described below on table 4.12: Table 4.12: Relationships between the different blocks in the HSCT dataset for model 1.2. 0 indicates no relationship and 1 indicates a strong relationship. Model 1.2 Transcriptome Microbiome metadata Transcriptome 0 0.0 1.0 Microbiome 0 0.0 0.1 metadata 1 0.1 0.0 On model two we split the invariable variables from those related to the location: Table 4.13: Relationships between the different blocks in the HSCT dataset for model 2. 0 indicates no relationship and 1 indicates a strong relationship. Model 2 Transcriptome Microbiome Demographic Location Time Transcriptome 0 1 1 1 0 Microbiome 1 0 1 1 0 Demographic 1 1 0 0 1 Location 1 1 0 0 0 Time 0 0 1 0 0 Following this split, we used inteRmodel (See section above 4.1.3) to find the model that has higher inner AVE for these blocks is the one on table 4.14: Table 4.14: Relationships between the different blocks in the HSCT dataset for model 2.2. 0 indicates no relationship and 1 indicates a strong relationship. Model 2.2 Transcriptome Microbiome Demographic Location Time Transcriptome 0 0.0 0.0 1.0 0.0 Microbiome 0 0.0 0.2 0.1 0.0 Demographic 0 0.2 0.0 0.0 0.6 Location 1 0.1 0.0 0.0 0.0 Time 0 0.0 0.6 0.0 0.0 We also tested specifically a model from the family 2.3, which can be seen on table 4.15: Table 4.15: Relationships between the different blocks in the HSCT dataset for model 2.3. 0 indicates no relationship and 1 indicates a strong relationship. Model 2.3 Transcriptome Microbiome Demographic Location Time Transcriptome 0.0 0.1 0.0 1.0 0 Microbiome 0.1 0.0 0.1 0.1 0 Demographic 0.0 0.1 0.0 0.0 1 Location 1.0 0.1 0.0 0.0 0 Time 0.0 0.0 1.0 0.0 0 The best model of the family 2 confirmed a relationship between the host transcriptome and the location-related variables, while the microbiome was associated with the demographic and location-related variables (see figure 4.11 and S2 data of [197]). Overall, we see that the relationships in the model affected the distribution of samples on the components of both the host transcriptome and the microbiome. Table 4.16: The models in the HSCT and their AVE values. For each model the inner AVE and the outer AVE is presented. Model inner AVE outer AVE 0.0 0.3999234 0.1001689 1.0 0.6230190 0.0842333 1.1 0.5678189 0.0848714 1.2 0.7043881 0.0775766 2.0 0.2517363 0.0982050 2.1 0.6940253 0.0940266 2.2 0.8187640 0.0941628 2.3 0.7761846 0.0943938 The different models selected different variables, some of which are shared between models. The most similar models are those that have split the metadata into 3 blocks, followed by those that have the metadata in a single block. In order to analyze the accuracy of the models, one thousand bootstraps were used to integrate the data from the HSCT CD dataset. Each bootstrap had its own dispersion on the variables according to the samples selected, the distribution of the bootstraps used are represented here: Figure 4.12: Dispersion of the bootstraped samples on age and percentage of colon and controls samples. Evaluating the same model on each bootstrap lead to a dispersion on the inner AVE of the model. The lower the dispersion, the more robust the model was to different conditions than in the initial testing. Figure 4.13: Bootstrap of the models 0, 1.2 and 2.2. The point with the black circle is the AVE of the original data. The dispersion is shown by the ellipses. Model 0 and 1.2 have lower inner and outer AVE score, model 2.2 has lower outer score but higher inner value than the bootstrapped. With the bootstrapped models we used BaseSet to estimate the probability that each variable to be relevant for the association with a disease. However, due to big amount of small probabilities when using the BaseSet package to calculate which variables are more relevant it could not provide a good estimation on time. MCIA was applied as a baseline of the integration, the first two components were represented similarly to those of the blocks when using RGCCA 4.14. Figure 4.14: MCIA dimensions in the HSCT dataset. MCIA first two synthetic variables. In red circles the colon and in blue triangles the ileum. The AUC of classifying the transcriptome in colon or ileum segments was compared between the models (see 4.15 and with MCIA. Figure 4.15: AUC of the RGCCA models in the HSCT dataset. The classification of the localization of the sample according to the first component of the gene expression of the models generated with RGCCA on the HSCT dataset. These models have the following AUC to classify the location of the sample according to the first component of the transcriptome block. Table 4.17: AUC values of RGCCA models of the HSCT dataset classyfing the location of the sample according to the first component of the transcriptome block. From model 0 to model 2.3, the best classification is achieved with model 2.1. Note that this is removing two samples for which the location is unkown. Model AUC 0 0.4537037 1 0.4309414 1.1 0.4639275 1.2 0.5958719 2 0.9450231 2.1 0.9988426 2.2 0.9980710 2.3 0.9969136 On MCIA the AUC for the classification of ileum or colon samples is of 0.9851 once those two samples with unknown location are excluded. This is on par with the models of family 2 as can be seen on the table 4.17. The different models selected different variables as can be seen below: Figure 4.16: Upset plot of variables selected in the HSCT dataset. The variables selected on each model from 0 to 2.3 showing the intersection between them regarding genes, panel A, and OTUs, panel B. Differences and similarities between the selected features of each model can be observed on Figure 4.16. Genes are very similar between model 0 to 1.2 and between 2 to 2.3, while OTUs are very unique on model 0 and others shared between most models. 4.2.3 Hslers dataset If we look at the dataset 16S, the PCA doe not show a pattern as can be seen on figure 4.17: Figure 4.17: PCA of 16S of Hslers dataset colored by the location of the samples. The PCA on the transcriptome shows a distinction between colon and ileum according to the first dimension of the pca that can be seen on 4.18: Figure 4.18: PCA of RNAseq of the Hslers dataset. The samples are colored by location sigma and ileum. There are two clear groups according to the location. In this dataset, the parameter tau behaved slightly differently than with the previous dataset but the value from the Schfers method for tau was close to the best value. Figure 4.19: Changes on tau on the centroid scheme in the Hsler dataset affect the inner AVE score on the model 1. The panel A shows on the ordinate the RNAseq tau value, the panel B on the right, shows the tau of the microorganism; both of them show the ys tau on the abscissa. Models for Hsler dataset are: Table 4.18: Model 0 of Hsler dataset. 0 indicates no relationship and 1 indicates a strong relationship. Model 0 RNAseq micro RNAseq 0 1 micro 1 0 The first model for family 1 is on table 4.19: Table 4.19: Model 1.1 of the Hsler dataset. 0 indicates no relationship and 1 indicates a strong relationship. Model 1.1 RNAseq micro meta RNAseq 0 0 1 micro 0 0 1 meta 1 1 0 The after optimization of the model of family 1, the best one is on table 4.20: Table 4.20: Model 1.2 of the Hsler dataset. 0 indicates no relationship and 1 indicates a strong relationship. Model 1.2 RNAseq micro meta RNAseq 0 0.0 1.0 micro 0 0.0 0.1 meta 1 0.1 0.0 The first model for family 2 is on table 4.21: Table 4.21: Model 2.1 of the Hsler dataset. 0 indicates no relationship and 1 indicates a strong relationship. Model 2.1 RNAseq micro Location Demographic Time RNAseq 0 0.0 1.0 0 0 micro 0 0.0 0.5 1 0 Location 1 0.5 0.0 0 0 Demographic 0 1.0 0.0 0 1 Time 0 0.0 0.0 1 0 After optimization of models of family 1 the best model according to the inner AVE score is on table 4.22: Table 4.22: Model 2.2 of the Hsler dataset. 0 indicates no relationship and 1 indicates a strong relationship. Model 2.2 RNAseq micro Location Demographic Time RNAseq 0.0 0.1 1 0.0 0.0 micro 0.1 0.0 0 0.1 1.0 Location 1.0 0.0 0 0.0 0.0 Demographic 0.0 0.1 0 0.0 0.1 Time 0.0 1.0 0 0.1 0.0 On table 4.23, we can see here the AVE scores of each of the previous models: Table 4.23: AVE values of RGCCA models in Hslers dataset. The inner and the outer AVE scores of multiple models tested on the Hsler dataset are shown. The model with the hightest inner AVE is model 1.2. Model inner AVE outer AVE 0 0.8217371 0.0961236 1.1 0.7461423 0.1024148 1.2 0.8349410 0.1025486 2.1 0.4980681 0.1008395 2.2 0.7513065 0.1009915 In contrast to the HSCTs dataset (table 4.16), the model with the highest inner AVE was model 1.2 but model 2.2 was close to it (see table 4.23). Model 2.2 has a relationship of 0.1 between microbiome and the host transcriptome and of 1 between the location and the host transcriptome. The microbiome block is also related by a factor of 0.1 with the demographic block and of 1 with the time block. Lastly, the time and the demographic block are related by a factor of a 0.1. In either case the family 1 and family 2 models can correctly separate by sample location (colon or ileum) but not by disease type or inflammation status as can be seen on figure 4.20. Figure 4.20: Models from inteRmodel in the Hslers dataset. Model 0 with just the transcriptome and microbiome data. Models 1.1 to 1.2 with transcriptome, microbiome and sample data in a single block. Models 2.1 and 2.2 with transcriptome, microbiome and sample data in multiple blocks. On the A panel colored by disease on the B panel colored by location of the sample. There is no observable cluster of IBD samples and the other samples, showing that on this dataset the differences of the microbiome between the different type of samples are less stark. The classification of samples was very accurate in all the models, specially on model 2.2, see figure 4.21: Figure 4.21: AUC of models with RGCCA in the Hslers dataset. The classification of the localization of the sample according to the first component of the gene expression of the models generated with RGCCA on the Hslers dataset. This accuracy resulted on high AUC values for all the models, as can be seen on table 4.24: Table 4.24: AUC of the RGCCA models in Hslers dataset. The AUC was calculated with the first dimension of the gene expression block ability to predict location of the sample. Model AUC 0 0.8011494 1.1 0.9781609 1.2 0.9977011 2.1 1.0000000 2.2 1.0000000 MCIA was applied as a baseline of the integration and compared to the different models to know which one separates best colon and ileum samples. The result on the first two dimension is shown on figure 4.22: Figure 4.22: MCIA dimensions in the Hslers dataset. MCIA first two dimensions of the dataset colored by state, the shape is according to the location of the samples. Shows two vertical groups on the first syntethic dimension according to the location of the samples. MCIAs AUC results was as high as the model 2.2 to classify samples according to their location. It was even better to classify the samples according to the type of sample they are: 0.6248 vs 1 the best AUC from RGCCA that corresponds to model 1.2. 4.2.4 Morgans dataset To explore this dataset that is different from the others with IBD. The PCA didnt show any pattern on the microbiome according to the location, see figure 4.23. Figure 4.23: PCA of 16S of the Morgans dataset. The sample are colored by location. The PCA on the transcriptome did not show a clear distinction between the prepouch ileum and the pouch on figure 4.24 but there is a pattern: Figure 4.24: PCA of RNAseq of the Morgans dataset. The sample are colored by location. We tested if results of inteRmodel were consistent on this dataset with the other datasets. The first model we tried is model 0 as in table 4.25: Table 4.25: Relationships between the different blocks in the Morgans dataset for model 0. 0 indicates no relationship and 1 indicates a strong relationship. Model 0 Transcriptome Microbiome Transcriptome 0 1 Microbiome 1 0 We then added the data about the samples as provided 3.1.4, on a simple model as in table 4.26: Table 4.26: Relationships between the different blocks in the Morgans dataset for model 1. 0 indicates no relationship and 1 indicates a strong relationship. Model 1 Transcriptome Microbiome metadata Transcriptome 0 0 1 Microbiome 0 0 1 metadata 1 1 0 When looking for the model that adjust better following this structure we arrived to model 1.2, described below: Table 4.27: Relationships between the different blocks in the Morgans dataset for model 1.2. 0 indicates no relationship and 1 indicates a strong relationship. Model 1.2 Transcriptome Microbiome metadata Transcriptome 0.0 0.1 0 Microbiome 0.1 0.0 1 metadata 0.0 1.0 0 On model two we split the invariable variables from those related to the location (see 4.28): Table 4.28: Relationships between the different blocks in the Morgans dataset for model 2. 0 indicates no relationship and 1 indicates a strong relationship. Model 2 Transcriptome Microbiome Demographic Location Transcriptome 0 1 1 1 Microbiome 1 0 1 1 Demographic 1 1 0 0 Location 1 1 0 0 The model that has higher inner AVE for these blocks is the following: Table 4.29: Relationships between the different blocks in the Morgans dataset for model 2.2. 0 indicates no relationship and 1 indicates a strong relationship. Model 2.2 Transcriptome Microbiome Demographic Location Transcriptome 0.0 0.1 1 0.1 Microbiome 0.1 0.0 0 0.0 Demographic 1.0 0.0 0 0.0 Location 0.1 0.0 0 0.0 Each model is different from previous models. After model 2.2 we looked on the model similar to model 2.3 in the HSCT dataset showed but it is the same as in model 2.2. However, it is kept on the further analysis. The different models were not able to separate the samples neither by location or sex. Figure 4.25: Models from inteRmodel in the Morgans dataset. First component of the transcriptome and microbiome of models on the Morgans dataset. Model 0 without sample data. Model 1 to 1.2 with all the sample data in a single block and models 2.1 to 2.3 with sample data in several blocks. Panel A shows samples colored by sex and panel B by segment of the sample. There is no clear classification neither by location nor sex on any of the models. Nevertheless, we compared the classification with the MCIA algorithm and still resulted that model 2.2 provide a better classification than MCIA. Table 4.30: AVE values of RGCCA for the Morgans dataset. The inner and the outer AVE scores of multiple models tested on the Morgan dataset are shown. The model with the hightest inner AVE is model 1.2. Model inner AVE outer AVE 0.0 0.4735601 0.1098639 1.0 0.6333592 0.1152280 1.1 0.2448234 0.1104746 1.2 0.7868443 0.0422660 2.0 0.4404123 0.1088730 2.1 0.6052598 0.1074900 2.2 0.6895661 0.1081315 2.3 0.6895661 0.1081315 When exploring the bootstraps of the data we found that model 1.2 is highly variable: Figure 4.26: Inner and outer AVE scores of the bootstrapped models 0 1.2 and 2.2. Model 0 does not have sample data. Model 1.2 has microbiome, transcriptonme and sample data in a single block and model 2.2 has microbiome, transcriptome and the sample data split in several blocks. In addition the model 2.2 usually has a lower inner AVE compared to model 1.2. Figure 4.27: AUC of RGCCA models in the Morgans dataset. The classification of the localization of the sample according to the first component of the gene expression of the models generated with RGCCA on the Morgans dataset. The area under the curve for these models is: Table 4.31: AUC for the Morgans dataset classificating the localization of the sample according to the first component of the gene expression of the models generated with RGCCA. Model AUC 0 0.4969734 1 0.7934971 1.1 0.8161536 1.2 0.5606192 2 0.8546351 2.1 0.8473712 2.2 0.8352646 2.3 0.8352646 With MCIA: Figure 4.28: MCIA dimensions in the Morgans dataset. MCIA first two dimensions of the dataset. The color and shape match the location of the sample. There is some separation between samples by location. If we quantify this separation by the first dimension of MCIA, the AUC is 0.818, which is slightly worst than the models of family 2. 4.2.5 Howells dataset The 16S of this dataset doesnt show any clear pattern regarding the location of the samples according to the firsts dimensions of the PCA on 4.29: Figure 4.29: PCA of 16S data of the Howells dataset. Samples are colored by location. There are no pattern on any of the first do dimensions. The PCA on the transcriptome shows a distinction between colon and ileum 4.30 there are almost two distinct groups according to location: Figure 4.30: PCA of RNAseq data of the Howells dataset. Samples are colored by location. There are two groups of samples according to their location. This dataset was processed to confirm the results on the previous datasets. As always first we started with model 0, connecting both the RNAseq and the 16S blocks: Later we look for the best model of family 1 (without looking at any previous model of family 1). This resulted on the following model 4.32: Table 4.32: Relationships between the different blocks in the Howells dataset for model 1.2. 0 indicates no relationship and 1 indicates a strong relationship. Model 1.2 RNAseq 16S metadata RNAseq 0.0 0.1 1 16S 0.1 0.0 0 metadata 1.0 0.0 0 Model 1.2 4.32 was the best according to the AVE score but perform worse when attempting to recreate known biological differences via classifying samples as we can see below 4.31: Figure 4.31: Models from inteRmodel in the Howells datset. The three main models, model 0, 1.2 and 2.2 on the Howells dataset colored by section colon, ileum and shape according to the disease: square, ulcerative colitis; triangle, normal; circle, Crohns disease. Model 0 has just trancriptomic and microbiome data, model 1.2 has transcriptomic, microbiome and sample data and model 2.2 has transcriptomic, microbiome and sample data split in different blocks. Model 2.2 was selected for further analysis as it describes more accurately the biology of the dataset it. Model 2.2 can be seen on 4.33. Table 4.33: Relationships between the different blocks in the Howells dataset for model 2.2. 0 indicates no relationship and 1 indicates a strong relationship. Model 2.2 RNAseq 16S demographics location RNAseq 0 0 0.0 1.0 16S 0 0 1.0 0.0 demographics 0 1 0.0 0.1 location 1 0 0.1 0.0 Model 1.2 has a 0.1 relationship between the ASV and the transcriptome and 1 between transcriptome and metadata. While model 2.2 has a relationship of 1 between location and transcriptome and demographics and ASV but only of 0.1 between demographics and location. Table 4.34: AVE values of RGCCA for the Howells dataset. The inner and the outer AVE scores of multiple models tested in the Howell dataset are shown. The model with the hightest inner AVE is model 1.2. Model inner AVE outer AVE 0.0 0.7180980 0.1112390 1.2 0.8972258 0.1660267 2.2 0.8433274 0.1659844 Figure 4.32: Bootstrap of models in Howells datset. Bootstrap of the different models on the inner and outer AVE: Model 0 has just trancriptomic and microbiome data, model 1.2 has transcriptomic, microbiome and sample data and model 2.2 has transcriptomic, microbiome and sample data split in different blocks. The bigger points are the models on the original dataset. The bootstrapping showed that model 1.2 has indeed higher inner AVE values than model 2.2 and is more stable than model 1.2. While model 0 shows a high variation according to which samples are selected. Figure 4.33: MCIA dimensions on the Howells dataset. The first dimensions separates by location. If we look at the classification of the models on figure 4.34, we can see that models 1.2, 2 and 2.2 classify perfectly the samples by the transcriptome into the location of the sample. Figure 4.34: AUC of the RGCCA models in the Howells dataset. The classification of the localization of the sample according to the first component of the gene expression of the models generated with RGCCA on the Howells dataset. The AUC of each model can be seen on 4.35: Table 4.35: AUC of the RGCCA models in the Howells dataset. The classification of the location of the sample according to the first componenent of the models shown. Model 0, 2 and 2.2 have a perfect classification of the samples to their respective location. model AUC 0 0.6255259 1 0.5974755 1.2 1.0000000 2 1.0000000 2.2 1.0000000 In this dataset we also focused on the most important ASV according to the model 2.2 that were present in more than 2 samples that in total were present in the whole dataset. These ASV were summarized to a single value and then used to calculate the AUC, which was 0.85. The dot product of the ASV and genes were also calculated and used to find out which ASV are related to which genes. 4.2.6 Between datasets The HSCT genes were compared to the Howells genes from model 2.2. There are 3580 selected on model 2.2 in the HSCT dataset and 2189 genes on the Howells dataset. From them the 1228 genes in common were analyzed for which GO terms and pathways they are enriched. The results is represented on 4.35. Figure 4.35: Significance of pathways on common genes in HSCT and Howells dataset ordered by p-value, size according to the number of genes on the pathway found on the dataset and color blue for pathways and red for gene ontologies of biological process. References "],["discussion.html", "Chapter 5 Discussion 5.1 Preliminary steps 5.2 Designing models 5.3 Evaluating models 5.4 Implications", " Chapter 5 Discussion In this chapter we will summarize the main findings in relation to the broad research community and other work as well as the impact of the results on further research in or clinical practice. 5.1 Preliminary steps The quality of the initial RNAseq and 16S data is crucial for a valid integration analysis. In sequencing data, it is very important to avoid contamination and have enough amount of data for the analysis. To avoid contamination it is very important to control the protocol used to process the samples before the sequencing. In addition control samples can be added, a blank to correct for extraneous material and a sample with known content to confirm that the sequencing worked correctly. Our lab uses a well established protocol to isolate and sequence RNA (Described on methods section 3.2) and we rarely encounter problems during this phase. In contrast, DNA extraction and 16S sequencing had to be established and optimized, initially with the guidelines and support from collaborators especially Dr.Ilias Lagkouvardos. Indeed, as we encountered some problems we added blank samples to control for bacterial contamination during sample pre-processing or sequencing. We initially processed the 16S data to obtain OTUs. OTUs were the standard some years back [198]. However, OTUs are not comparable between studies even those that use the same primers. For this reason, and after a suggestion from a reviewer (on the review process of [197]), we moved to process later 16S sequencing datasets to obtain ASV. ASV allow the comparison of the taxonomic imputation between studies using the same primers. However, comparing 16S taxa ASV or OTUs is hard and selecting the right tool to compare them is important [199]. It is also worth keeping in mind that several species have variable number of 16S rRNA genes. Higher sequence counts of certain 16S might not mean higher abundance of that species compared to another with lower 16S counts. However, the exact copy number status may change even within the same bacterial species, making the correction difficult [200]. It is however possible to accurately correct for copy number variation on mock populations where the species and the genomes are known (or at least the 16S rRNA), but harder or impossible on samples whose composition is unknown. To our knowledge there is no available method yet to do this. Furthermore, the precision of 16S sequencing for classification of taxa is not enough to understand its role in the gut. Adherent invasive cells, are bacteria share genetic content with but show different behavior [201]. These bacteria are known to be more abundant on patients with IBD [201]. Thus, bacteria with the same complete sequence can play a different role in vivo. Most of these steps were, however, out of my control as they were performed by a lab teammate or by collaborators. Other concerns, like primers used, 16S regions amplified are currently unavoidable. 5.1.1 The datasets There is not an established methodology to calculate the size of cohorts for interaction or multi-omic studies. Indeed, there are no clear rules on which alpha power or which kind of relations can be tested. This might be due to the lack of mathematical background and modelization of the relevant relations in biology. Further research in this area might help finding which kind of relationships can be expected given certain dataset sizes. Usually size of the datasets is determined based on practical reasons: either costs or access to patients. There have been some efforts to create artificial multi-omic datasets [140145, 202, 203]. This could allow benchmarking different tools, impute missing data and do pilot studies. These efforts usually focus on RNA-seq, ATAC-seq (DNase-seq), ChIP-seq, small RNA-seq, Methyl-seq or proteomics but not 16S, microbiome or metagenomics data. In addition, they have also focused on finding relationships between samples missing relationships within cells (regulated DNA, protein recruitment, transcription factors, siRNA regulation, etc. ) and between cells (immune response, adherence, cytokines signaling, etc.) that might surface at the sample level. To my knowledge there is no accurate artificial method to create 16S datasets or related microbiome datasets. This made impossible to simulate and compare different tools on a synthetic dataset with known relationships on this thesis to evaluate performance of different methods. There is also no reference dataset for integration in IBD that accurately represents the disease. There is a large consortium effort with many samples [4], but this does not contain 16S and RNAseq data from the same location at the same time for as many samples as the datasets used on this thesis. In order to validate results of methods we are limited to compare their results on different datasets. However, each dataset is collected with different goals and processed differently. In addition, authors upload their data to different, not centralized, data repositories, such as, gene expression omnibus (GEO), European Genome-Phenome Archive (EGA), European Nucleotide Archive (ENA), among others. Authors might also provide the processed data as supplementary material on their articles. Some projects whose primary purpose is providing data for the community establish their own dedicated sites to store the data [4]. There is not a resource were datasets of publications are collected with their characteristics, age, sex, sample location, extraction method, sequencing protocol, etc.. Finding different datasets with comparable data is thus challenging. Furthermore when pooling together datasets batch effect correction will most likely be necessary. There are tools to overcome this, but currently only work if the datasets share some features or samples in common [204]. These methods usually require datasets with similar RNA sequencing procedures. In this thesis there were two in house datasets collected and sequenced: the HSCT and the BARCELONA dataset. In addition, we looked up for the most similar datasets published to confirm our results outside our own cohorts. We found several with intestinal 16S and RNAseq data from the same location, to compare with our own datasets. As explained in the methods section 3.1.2, the HSCT dataset is a very unique cohort of CD patients undergoing hematopoietic stem cell transplant. This treatment is reserved to patients for which all the other treatment failed and this may be the only way to reach remission. These patients are closely monitored and followed up for several years. This treatment is not indicated for UC, so this dataset includes only CD patients. The BARCELONA dataset (See appendix section D.1) includes samples from CD and UC collected prospectively in patients starting biological treatment and followed up for up to a year. Patients had shorter disease duration but were not refractory to biologic treatments and may even be naive to any biologic. Thus, analysis of this cohort could have provided us with a better understanding on the initial relationships between the microbiome and the mucosa of IBD patients. Unfortunately, the 16S microbial sequence data from the BARCELONA cohort was not of enough qualtiy to make reliable analysis and confidently extract hypothesis or relationships (See appendix section D.1). It is not clear what happened and therefore we cannot hypothesize how to avoid such problems in the future. It could have been a problem with the DNA sample and/or of the sequencing process which did not include both positive and negative controls. Nevertheless, sample sequencing was repeated in an independent sequencing facility to overcome the limitations of the first dataset but problems persisted rendering this data suboptimal for further analysis. What happened with the BARCELONA dataset highlights the importance of data quality checks. In the BARCELONA cohort despite no batch effect as checked with experDesign on the second sequencing, the low diversity indices suggested that there was some problem with the microbiome data. Caution and communication between all team members (i.e, clinicians, technicians and bioinformaticians) is important to discover this kind of problems and ensure the quality of the data. Other datasets used from published sourced were assumed they had already passed enough controls and were of good quality. Nevertheless, they were screened to avoid quality issues by visually inspecting several principal components colored by several factors, checking gene expression and the microbiome profile and looking for known gene markers and microbiome taxonomy that might indicate quality problems. RNAseq data was usually compared using previously described methods on 3.6.1. The Pugets dataset provided a good benchmark to test the methods and performance of RGCCA works. CNV/CGH is not comparable to microbial data, but the microarray data is similar to the RNAseq data from other datasets. We were not as much interested on the biology as on learning about the RGCCA method and its applicability to integrate different omics. The Hsler IBD dataset was obtained using the same sequencing techniques from endoscopic biopsies as our dataset HSCT and BARCELONA. The 16S data was very similar to the HSCT dataset. We could confirm that the inteRmodel approach works on more than one dataset. The taxonomy analysis of the different datasets was done differently. On HSCT following our collaborators advise we used IMNGS to annotate its microbiota data [159]. Afterwards we used SILVA database to annotate the microbiome data on their corresponding taxa. The Morgan pouchitis dataset was also related to IBD but it included patients that underwent colectomy and samples are specific of the pouch or pre-pouch ileum. No healthy samples are included and there is no follow up. Thus, it was unlikely that a classification of the location could be achieved and that classification of the samples according to the microbiota could not be based on the disease (as all of them had undergone the same procedure and had the same disease type). Nonetheless, there seems to be a partial separation by location on the models on 4.25 that could partially be explained by different degrees of inflammation. The Howell dataset includes both pediatric CD and UC (and non-IBD) samples. It is very similar to our BARCELONA dataset. As expected, time of the disease duration of these patients is lower, however, they were not followed up at different time points. Overall, while challenging we were able to identify a few published datasets that were used to validate and compare the different models. Running such tests is essential to establish the best approach for data integration in the future an validate its results. 5.1.2 The methods As seen on the introduction there are many different methods available and new tools and methods are frequently being released. The most up to date list of tools can be added to a collaborative list that was created with the purpose of providing access to the growing list of methodology of the scientific community. Methods differ in their quality, usage and the quality of the software. Some of them have been tested on several datasets but the most important validation process a method has to undergo is the mathematical validation. With the increase of available analytical tools side by side comparison has become increasingly important. There are reviews that apply different tools to the same datasets [130], some are more theoretical [205], others are focused on a different area like metabolomics [100]. Few of these methods have been applied in IBD datasets. However, recently there has been a review focused on integration in IBD [148]. In this publication the authors suggest that one must be mindful of the gap between the experimental conditions and the real world. It also encourages to collect more data about the exposome (the environment patients are exposed to). It ends up advising to set up guidelines for multi-omic studies tailored to the field, coordinate a global framework to prevent redundant studies and to ensure efficient funding and resources and disseminate training and education on computational approaches to analyze multi-omic datasets. Current methodological approaches focus on comparing tools on (several) previously published datasets [130], an approach that we have taken too. This approach was not used to compare different tools, but to validate findings of one dataset in other datasets. This is especially important due to the lack of golden datasets or a way to reliable simulate datasets as discussed on the previous section 5.1.1. In IBD, many studies focus on finding some genes or bacteria to answer a narrow question they have in mind, like which bacteria are related to inflammation [81] or disease activity. In this thesis, the focus was on finding a good representation of the relationships that identify groups of genes and bacteria that were relevant to the disease in an orchestrated manner. We made the assumptions that the microbiome composition and the hosts transcriptome were related. This assumption is backed up by several other previous studies supporting this relationship [41, 42, 206208]. Tools that relate the variance of a block with other variables, both numeric and categoric, are needed to search which variables are important. PERMANOVA and globaltest served that purpose, but they do not give any insight into which specific microbial species are driving the association between the microbiome and the variables [209]. In addition, we could be missing some other important variables. It is known that other factors beyond the omics data collected, mainly environmental factors, genetic susceptibility and the immune response may play a role [210]. Sudhakar et. al. [148] recommend being conscious of the gap between the data available and the biological process. One variable we did not keep track was the microbial load which is linked to the guts microbiome community variation [211]. This needs to be quantified at the time of DNA isolation and most studies, including our own lack this data. We tried to find which genes and bacteria are correlated between them using WGCNA, a tool designed to find common co-occurring patterns based on correlations. It requires homogeneous samples, with a minimum of 12 samples per condition. However, when applied to the whole dataset there might be too much variance in order of WGCNA to find the proper signal. As we have patients of different ages and samples from different intestinal segments, both variables are highly related to the intestinal microbiota, this might be the reason why this method failed to achieve a good fit on the scale free topology with around 100 of mean connectivity. In addition, having microbiome and RNASeq in the same matrix, would probably be hard for the process to find good relationships if we applied the same normalization process to both of them without escalation. We could have tried to make smaller groups and then compare the modules between them but groups may have been too small since samples were from multiple segments and conditions. We briefly considered using STATegRa. However, it is not possible to model specific interactions between blocks. The method implemented on STATegRA might be useful for cases where there is a great agreement between blocks or were environmental factor do not play a huge role on any of the blocks of data. To identify related variables other methods use correlations between the variables [212]. On our dataset we visually explored the correlations for all the datasets, but the significant correlations were usually driven by an outlier, or there was not a good fit of the data due to missing data (data not shown). We tried filtering those correlations identified by the models, being less restrictive by removing those samples that did not have microbiome presence on at least 5 samples, and removing those samples without that microbiome presence, separating based on intestinal segment and a combination of all. None of these variations provided a clear insight over which genes were correlated to which bacterial signatures. This is in contrast to other publications that relied purely on the Spearman \\(\\rho\\) metric [80]. We developed and applied BaseSet to find these relationships using a different approach. However, it failed because it is computationally expensive to calculate the likelihood of 1500 variables; there are too many combinations. In addition, the numeric precision of said calculations suffers from the floating point problem and must be carefully considered [213]. To support multiplying more than 1000 float numbers a different strategy such as using log values might be better. We could not come up with a better strategy to find all the combinations needed, perhaps a better method exists that could be used to find which are the terms more influential to the end result. During the peer-review process of the package for its acceptance on rOpenSci, some concerns were raised about conflating probabilities with fuzzy-sets. For all these reasons this approach was no longer pursued. However, the package was mentioned as top 40 packages added on CRAN that month and it will be useful under other circumstances or when less combinations are possible. The development of the experDesign package helped us to avoid batch effects on the sequencing step. However, as seen in the previous section, batch effects were not completely prevented. As discussed in the related publication [193], there are several tools already focused on this problem: OSAT ([214]), anticlust ([215]) and Omixer ([216]). But these tools have some shortcomings, that are covered by experDesign: OSAT cannot handle missing values and does not work well for arbitrary batches, anticlust only accepts numerical variables but it is based on a powerful mathematical theorem and Omixer has bugs that prevent comparing with the other tools with no possible workaround. In addition, experDesign received requests to have a new feature for expanding experiments. This might help improve the quality of bigger datasets to ensure they can be extended in several sequencing runs. This feature would be useful for multi-omics datasets or in big cohorts to minimize batch effects associated with long running collection of samples. We selected MCIA as a baseline to compare our method because it works well on a wide range of datasets, has a good documentation as well and it is widespread used. The method was developed after RGCCA and recently there have been publications that show that it outperforms other methods on its versatility on different contexts [130]. On the dataset analyzed we found that it performed similarly to inteRmodel but this will be discussed on section 5.3. 5.2 Designing models Previous publications using RGCCA in IBD have focused on validating genes DUOX2 and APOA1 as inflammation predictors ([81]) from previously published articles [217]. Some publication tried to summarize the existing relationships in IBD [80], but none were focused on finding the relationships in IBD using RGCCA as we did. There are many variables outside transcriptomics and the microbiome that may be relevant in disease homeostasis. These variables should be included on the models to find which genes and bacteria are truly related and not confounded by other factors. In addition, the relationships between the blocks are unknown on both the strength and interaction. To model the relationships the connections between blocks had to be selected on RGCCA. Last, the variables that belong to a block should be carefully considered as the assumption is that the whole block is correlated with other blocks connected. If one has preexisting theories about the data, a specific model can be used stating these known or hypothetical relationships. However, if new relationships are being explored or no prior assumptions on the data are held the models should be created with random links between blocks, and evaluate which model is better. The connections tested required that all models should have all blocks indirectly connected to other blocks with no blocks left unconnected. This avoids optimizing two different networks of blocks that are not connected between them, thus, forcing the model to represent all the information. Typically blocks are defined by each omic data origin and no other information is included. However, we knew that the transcriptome is mainly related to the location of the samples, as we have seen it on the PCAs, and we expected that the microbiome would be more related to the patients demographic characteristics and influenced by dietary and other environmental factors. This is especially important because in our datasets we have samples from the same patient and time from multiple locations. On other studies there are less samples per individual and timepoint (if there are several timepoints) [80, 150, 151]. On models of family 2, variables were grouped according to type into the Demographic block, Time block, and Location block (see tables on design of Pugets 4.4, 4.3; HSCT 4.13 4.14, 4.15; Hsler: 4.21, 4.22, Morgans 4.28, 4.29, Howells 4.33 models). The exploration of design on Pugets dataset, and the datasets analysis of HSCT, Hsler and Morgans datasets was published after peer review [197]. 5.3 Evaluating models To evaluate a model RGCCA provides the inner and outer average variance explained (AVE); (see section 3.3.1.2). As the inner AVE measures how good does the data fit in the model, we used it to evaluate and compare the models. Furthermore, bootstrapping was used to evaluate the fitness of a design on a diverse collection of datasets. Although on inteRmodel there is the option to use a leave-one-out procedure, we did not use it to evaluate the fitness of the models. Using an external cohort to validate the same model, or using a different method to see if it finds the same relationships or explains the data as accurately is also a common approach to evaluate and validate models. Using the same approach on different data helps to ensure the replicability of the results [218]. Figure 5.1: Reproducibility matrix indicating the terminology used between using the same method and the same data. Figure from The Turing Way: A Handbook for Reproducible Data Science (Version v1.0.1). We used the same approach on four different cohorts, with different origins and types of samples, but all related to the IBD popultation including 16S data and intestinal transcriptome. Some of them have multiple samples from the same individuals while others do not [80]. We also compared our method with a different one to see how generalizable are the results. Of the multiple methods available we used MCIA [219]. We compared it with inteRmodel by looking at the area under the curve for classifying the samples with the canonical component of the transcriptome data according to their location. The procedure of separating independent variables in their own block of data and later search the best model that fits the data provides a good strategy that should be considered for integration efforts. The procedural method of searching a model and testing it is implemented on inteRmodel. But the most important thing is to consider which variables are independent of which and if they can be separated into a block for later usage on the modeling (See [220]). If not done properly it can lead to undesired conclusions like the effect known as Simpsons paradox [221]. Unfortunately this cannot be automated and it is left for the practitioner. Splitting the variables of each sample into several blocks forces RGCCA to adjust for a new canonical dimension. The omics block such as gene expression and 16S data could be split, as the expression of some genes influence other genes, such as transcriptor factors (First mentioned on [222]) , miRNA [223], and siRNA [224]. All these interactions and regulations could distort the canonical correlations. However, the nature of this relationships is not linear and the interaction between them is multiple and very complex. Its complexity has prevented to accurately account for all subcellular reactions at speeds that could be useful (it has only been recently accomplished for a prokaryote cell [225]). In addition, these interactions are time dependent, not linear and are highly interconnected between many variables. For these reasons gene expression and 16S blocks were not split into several blocks. Besides comparing the results of different methods, these models need to be evaluated by the insights they provide on the biological system they are being applied to, in our case IBD. So far the models were only discussed on their technical merits. It is known that the mucosal transciptome is related to sample localization (of)i.e. small or large intestine) and disease activity [226]. This can be seen on the PCAs which separate colon an ileum on the first dimension: See the PCAs of the different datasets 4.9, 4.18 and 4.30. The difference is so great that many times the colon and ileum samples are analyzed separately. As such, it was a reasonable assumption to expect models to reflect these differences on the gene expression canonical component. The variability of microbiome difficults finding clear patterns (See the PCAs of the different datasets: 4.8, 4.17, 4.23 and 4.29). In healthy humans, it has been suggested that there is a shared microbial patterns among groups of individuals [227]. Such theory proposes three groups of similar microbiota composition, named enterotypes. However, the enterotypes classification is not unanimously accepted [228, 229]. Some suggest it is an artifact of the methodology used. There are many factors that influence the gut microbiome [230]. But the role of microbiome in IBD has gained a lot of attention in the last 10 years [17, 231, 232]. The microbiome has been associated for instance with treatment response in CD and suggested it could be useful for building an improved classifier for CD [233]. In addition, it is known that microbiome of patients in remission is different from non-IBD patients [234]. So even if two people are apparently healthy at a given time their microbiome might not be similar. The relapsing nature of IBD, suggests that at different time points the gene expression or the microbiome might be different. For this reason, time is an important variable when modelling the disease. If samples at multiple timepoints are available the time difference should be taken into account to identify the state of the disease for each patient. Even in healthy non-IBD patients, multiple samples with microbiota from the same patients could provide common microbiome signature, which can help identify altered microbiome states later on. Of the cohorts analyzed in this thesis, the HSCT and the Hsler dataset are the only ones including time related variables. However, the Hsler dataset only had age at date of sampling, and there were not several samples for the same patients at different timepoints. This leaves the HSCT dataset as the only one with multiple timepoints from the same patients. Having that many samples from the same patient might explain why the classification of the disease on this cohort works so well, despite being a cohort of complicated patients with several background treatments, refractory to all previous treatments, some of them having undergone surgery too and undergoing severe immunosupression during follow up. Despite all of this, there was large agreement in the genes and pathways identified as relevant between datasets (See figure 4.35). Comparing the microbiome between datasets is less straight forward. If the same primers are used the ASV could be directly compared. However, the ASV length might be different. In addition, in this thesis we used dataset obtained with different primers and also OTUs. For these reasons a direct comparison is not possible. A comparison of the taxonomy of the annotated microbiome on the datasets is the next possibility. However, some datasets used did not provide the annotation (Hslers and Morgans datasets). So we are are left with comparing OTUs (HSCT dataset) with ASVs (Howells). Despite the errors on ASV annotation ([235]), OTUs from the HSCT dataset can be compared to ASV from the Howells dataset. There were very few common taxonomic levels selected on both datasets (data not shown). This was not a surprise, as there are many factors that influence ones microbiome profile and the diversity indexes already showed high differences between samples of the same dataset. The microbiome of each dataset seemed capable to classify the samples according to the disease (data not shown). However, on further evaluation via bootstrapping this classification was not significant, as different relatively big amount of ASVs were able to classify the samples. This might be due to the uniqueness of microbial composition to each sample. In Howells and Hsler dataset, the best model based on AVE is 1.2; which separates the microbiome component by location too (See Figure 4.20 and table 4.23 for Hsler dataset and figures 4.31 and table 4.34 for Howell dataset). The 2.2 models according to the inner AVE were not that far away from models 1.2. This indicates that the relationship of the microbiome is stronger than with the location, but both factors should be considered when looking for relationships of genes with microbiome. 5.4 Implications On this thesis several methods has been developed to help multi-omic data integration. experDesign was implemented during the initial steps when moving from bench to in-silico analysis. BaseSets and inteRmodel are useful for computational analysis. BaseSets might help beyond integration analysis such as single cell annotation7. Some studies using host transcriptomics of fecal wash infer inflammation without colonoscopy [236]. This would help patients to avoid an unpleasant experience, and reduce the usage of clinical facilities. It could be possible that just sequencing the intestinal microbiome could be enough to identify the patients disease. However, this requires further validation to ensure that the diagnosis is accurate enough on a diverse and big population. There are already studies on this direction, not only for IBD or intestine but for several different human regions [4]. With our studies we hoped that we would provide which bacteria played a role on the disease, or which genes and bacteria are related in IBD. We obtained a list of putative genes and bacteria but not a clear pairing of which genes interact with which bacteria. This could mean that the microbiome community is related to all the genes. It could also mean that the methods are not powerful enough to find more tailored relationships as normalizations and generalizations present on RGCCA do not allow to subgroup or classify the variables already detected. Maybe a different method that would not depend on the same principles might be able to detect finer relationships on the variables selected. There is a disconnect between the computational side and the experimental side, driven by the difficulty to design and perform an experiment to test the new information that multi-omic experiments provide. This is referred as the gap in other publications [148]. Closing this gap between the computational methods and the data origin and practical usages would potentially require closer collaboration between clinicians, statisticians, bioinformaticians and research software engineers; in addition to creative ideas accounting for the standard procedure on hospitals and points of care. However, it is also possible that further developments or creatively applying statistical methods might help closing the gap. For instance, there are many combinations of possible interactions. These interactions between microbiome and genes are currently hard to explore statistically. Further research on how to reduce the space of possible combinations of bacteria or evaluate which combinations are more important might be useful on the future. This might involve using more network integration methods. Krassowskis et. al. ([95]) advise on software engineering and reproducibility practices to share awareness with new researchers in multi-omics for end-to-end workflow. In addition the recent recommendation about integration in IBD ([148]) suggests that there is still much to be done to increase the results on these projects and the effectivity. We agree with them and encourage other researchers to carefully consider the proposed methodology before starting their own projects. There seems to be a tendency of multi-omics projects to focus on metagenomics, metatranscriptomics and metaproteomics and abandon plain 16S sequencing [237]. This could be explained by the numerous problems that 16S sequencing has. Some of these are avoided or solved by using these other omics techniques. For instance the metatranscriptomics and metaproteomics of bacteria could help detect what is actively being produced by the microbiota and the metagenomics, what genes are actually there not just restricted to 16S rRNA sequences. But these methods also have their shortcomings. Metagenomics still does not detect adherent invasive cells and metatranscriptomics and metaproteomics can not explain which bacteria is expressing which genes (even if paired with metagenomics or 16S data). The single cell revolution might provide more insights in the future, but at the moment the first studies of single-cell multi-omics are being published. Perhaps as suggested in other publications network methods might be able to provide more detailed information about the relationships [238]. But, it is unclear how complete and valid these networks are. Current literature focus on already known and studied genes instead of on more novel and with higher relevant genes [239]. By extension, this translates in bias in networks and pathways resources available for pathway analysis and integration methods. This could explain why there are many genes selected by the models with few pathways or gene sets. To study complex systems, new technologies like organ-on-chip or more specifically gut-on-chip are being developed [240]. These systems expand on the already useful technique of using organoids to better mimic the epithelial cross-talk in the laboratory. Latest developments include the addition of separate environments and distinct flow on these environments. By introducing gut microbiota, these systems will help studying the interaction of the gut microbiota and the intestinal epithelium. However, it is not clear how accurately account for other factors such as the presence of inflammation. In summary, as shown with the PERMANOVA approach, several factors affect the disease and the relationship between guts microbiome and guts mucosa. Analysis or comparisons without taking them into account might provide misleading or false results. To our knowledge this is the first study using these variables as part of the integration study with canonical correlations. We hope this provides a first approximation to accurately understand the relationships between genes and bacteria in IBD. References "],["conclusions.html", "Chapter 6 Conclusions 6.1 Study 1: Multi-omic modelling of inflammatory bowel disease with regularized canonical correlation analysis 6.2 Study 2: Genes and microbiome relationship on inflammatory bowel disease", " Chapter 6 Conclusions In this doctoral thesis, we assessed the relationships between the microbiota and the gut transcriptome in inflammatory bowel disease. It allows us to conclude the following: 6.1 Study 1: Multi-omic modelling of inflammatory bowel disease with regularized canonical correlation analysis Applying methods that use information about the samples show better results than omitting this information. Correlations are not enough to identify relationship between genes and microorganisms. The inteRmodel method provides consistent connections between blocks on different datasets of inflammatory bowel disease. 6.2 Study 2: Genes and microbiome relationship on inflammatory bowel disease The hosts transcriptomics is heavily influenced by location and to a lesser degree by the type of activity. The microbiome composition relates better to the sample location than to the disease status but both are almost equally important Microorganisms highly tied to intestinal location might indicate the disease type, (Crohns disease, ulcerative colitis or non-IBD) of the patients, but microorganisms related to the disease are common in all the locations. "],["acknowledgments.html", "Chapter 7 Acknowledgments", " Chapter 7 Acknowledgments A la directora, tutora, jefa i tants papers que fas, moltes grcies Azu per haver estat a sobre de la tesis, he aprs molt de tot sobre com treballar amb intensitat i eficiencia, tocant de peus a terra. Tamb per preguntar i tenir presents sobre com es pot fer servir aix i com pot ajudar cada idea que tenia. Grcies Juanjo per donar-me la oportunitat dentrar a IDIBAPS i per tota la ajuda al llarg daquests anys per ser un bioinformtic independent. Sempre has estat disponible quan no sabia com seguir i aportaves alguna idea o paquet per probar. A tot el laboratori per el bon ambient que hi ha hagut fent les alegries ms grans al llarg de aquests anys i les adversitats ms lleugeres. Cadasc ho ha fet a la seva manera: a lAna per ser el complement perfecte de lequip bioinformtic i sempre estar disponible per aconsellar-me. LAlba pel seu optimisme i perseverancia, tambin por tu buen criterio diseando, espero que algo se me pegue. A lIsa pel seu detallisme i exemple de fer b les coses, les orquidies siempre estn preciosas! La Marisol per la seva senzillesa i estar sempre pendent dels petits detalls de la paperasa. La Elisa per la seva alegria i illusi que mai defalleixen i sencomanen. La Victria per la seva pacincia i consells sobre com descriure els projectes. LAngela per acceptar amb pacincia les meves sortides friquis. La Mriam perqu sempre ens toca moure trastos, a veure si algun dia montem el wallapop cientfic! i lIris que sempre t alguna cosa a aportar. Moltes grcies a totes, noms lamento no haver aprs ms de vosaltres. Hi ha persones que estan sempre com la Pepa, grcies per no tancar-me mai el email, i altres que marxen a altres projectes. Grcies per compartir una part daquest projecte amb m: lAida per tota lempenta que ha posat en aquests anys, moltes grcies per introduir-me en el mn de la microbiota! tamb per la teva acollida al lab. La Montse per organitzar els primers viatges fra i ensenyar-me a organitzar-me. La Nria per introduir-me en el grup i animar-me a fer el doctorat amb lAzu. Tamb en Daniel pel curset de processament de RNAseq. A tots de lequip de lhospital, per intentar entendre aquestes caixes negres de les tesis i ajudar a que no perdi de vista lobjectiu de la recerca; en especial al Juli, per fer sempre les millors preguntes i a la Maica per resoldre molts dubtes a linici. A tot lequip del Pau que em van acompanyar en els meus primers passos en la investigaci, la Bea, la Jlia, la Dlia, la Mar, en Luis, la Elisa Alguns que ja no estan per la planta 3 com en Josep o la Carolina. A tota la familia, els que estan ms aprop i els que estan ms lluny. Als pares per seguir amb inters tot el procs i procurar entendre alguna cosa. A la Maria per convidar-me sovint a casa seva a descansar. A la Maria del Mar per la teva alegria i plantejar reptes amb el python. A la Marta pels consells, el cotxe i les excursions. A lAna per seguir amb inters la investigaci i estar pendent dels avanos sobre la microbiota. A lAlbert per convidar-me a dinar sovint i conixer racons i histries de Barcelona o la familia. Als amics de Xaloc, en Mario per posar la casa tantes vegades al llarg de la tesis, un da tienes que venir a la ma! LAlbert Mateo per les refrescants sortides en bici i excursions, a ver si hacemos ms y con todos! A, lAlejandro que sempre ha estat un suport moral com a doctorand. En Bruno per acollir-me a casa seva (he de repetir la visita a Munich!). A lEdu per estar sempre disposat a acostar-me en cotxe o trobar un lloc fcil darribar en transport pblic. Als amics de la carrera, en Frederic per compartir molts dinars, penes i alegries. En Joan per marcar el cam, sempre has estat per davant! i lAleix, espero que la bioinformtica vagi a ms! Els amics dObenc, el Cristian per tantes aventures que em viscut aquests anys. En Daniel per ensenyar-me que el temps no es barrera per fer coses (Encara no mhas presentat els teus gossos!). A en Llus que tampoc no pares mai i mhas transms la teva gran ambici. A en Ricard per totes les discussions sobre el futur profesional, de la programaci, els jocs, pelcules i tantes coses, segur que trobes una manera de passar al seguent nivell! A en Joaqun per ensenyar-me el mn empresarial de software i tants detalls tcnics. A tots els que han vingut a ftbol, en especial al Josep M per ser lincansable impulsor i treure gent de sota les pedres i a en Josep per ser el ms constant, ja chutar ms sovint! I also received many help from numerous and anonymous people from several corners of the world. They might have shared some interesting tip, advice or tale on twitter, or answered my questions on Bioconductors support forum, Biostars, Bioinformatics SE or Stackexchange network. Also those that made and provided the software for free that made all this possible on your own time, R core, CRAN, Bioconductor and rOpenSci team, package developers and maintainers of the ~500 packages I use. Dr.Hsler for kindly providing data of the samples from their cohort and Dr.Cristian Hernndez and Dr.Mark S. Silverber for their collaboration and selfless sharing the data of their cohort. Last but not least, those without all this could not be possible. Thanks to all the patients that allowed clinicians to collect samples and data for research. I hope that the knowledge we gain with on this thesis and other studies will bring us closer to heal you. "],["references.html", "References", " References "],["online-resources.html", "A Online resources", " A Online resources Some links that we found useful on the thesis and could be useful if you are interested on the multi-omics field. Awesome multi-omics https://github.com/mikelove/awesome-multi-omics : An online repository of references to multi-omics methods. Reproduced here with their references 8: Table A.1: Integration methods available and their references. Method Publication SCCA [241] PCCA [242] PMA [243] sPLS [244] gesca [245] Regularized dual CCA [246] RGCCA [115] SNMNMF [247] scca [248] STATIS [249] joint NMF [250] sMBPLS [251] Bayesian group factor analysis [133] RIMBANET [128] FactoMineR [252] JIVE [135] pandaR [253] omicade4 [172] STATegRa [173] Joint factor model [254] GFAsparse [255] Sparse CCA [256] CCAGFA [257] CMF [258] MOGSA [259] iNMF [136] BASS [260] imputeMFA [261] PLSCA [262] mixOmics [263] mixedCCA [264] SLIDE [265] fCCAC [266] TSKCCA [267] SMSMA [268] AJIVE [269] MOFA [270] PCA+CCA [271] JACA [272] iPCA [273] pCIA [274] sSCCA [275] SWCCA [276] OmicsPLS [277] SCCA-BC [278] WON-PARAFAC [279] BIDIFAC [280] maui [281] SmCCNet [282] msPLS [283] MOTA [284] D-CCA [285] COMBI [286] DPCCA [287] MEFISTO [288] MultiPower [108] Bookdown: The book about how to write this type of books. Bioconductor: The project about bioinformatics on R mostly related to sequencing technologies. CRAN: The main archive of R extensions/packages for R. GitHub: Company which allows to freely host remote git repositories of many projects, including some used or developed on this thesis. References "],["software.html", "B Software B.1 STAR B.2 RSEM B.3 Listed B.4 By project/publication", " B Software Along the years of this thesis several pieces of software have been generated as well as packages. Here they are listed for easier retrieval. They are listed on two ways, one with a brief explanation and another one ordered by what software piece is used on each analysis. B.1 STAR The parameters and options used with STAR are: STAR \\ --outSAMtype BAM SortedByCoordinate \\ --outFilterIntronMotifs RemoveNoncanonical \\ --outSAMattributes All \\ --outReadsUnmapped Fastx \\ --outSAMstrandField intronMotif \\ --outFilterScoreMinOverLread 0.5 \\ --outFilterMatchNminOverLread 0.5 \\ --outFilterType BySJout \\ --alignSJoverhangMin 8 \\ --alignSJDBoverhangMin 1 \\ --outFilterMismatchNmax 999 \\ --outFilterMismatchNoverLmax 0.04 \\ --genomeDir &quot;$genome/STAR&quot; \\ --limitBAMsortRAM 10000000000 \\ --runMode alignReads \\ --genomeLoad NoSharedMemory \\ --quantMode TranscriptomeSAM \\ --outFileNamePrefix $output \\ --runThreadN &quot;$threads&quot; \\ --readFilesCommand zcat \\ --readFilesIn &quot;$file1&quot; &quot;$file2&quot; The $genome is the path to the location on the computer where the genome is, $output is the prefix of the output file, $threads is the number of threads used and $file1 and $file2 are the paired fastq files. B.2 RSEM Code used for RSEM where $threads is the number of threads used, $rseminp is the input file in BAM format, $genome is the path to the location on the computer where the genome is, and $rsem is the output file. rsem-calculate-expression \\ --quiet \\ --paired-end \\ -p &quot;$threads&quot; \\ --estimate-rspd \\ --append-names \\ --no-bam-output \\ --bam &quot;$rseminp&quot; &quot;$genome/RSEM/RSEM&quot; &quot;$rsem&quot; B.3 Listed An improved/tested version of RGCCA, some modifications on the internal functions to ease the maintenance as well as adding tests and sometimes improving the documentation. Also modified so that it is possible to provide a vector of models so that the model of the first dimension is not the same as the model on the second dimension (not sure if mathematically speaking makes sense but from a biological one we think might be interesting to have it). Designed to be used with RGCCA we wrote the package inteRmodel to ease the bootstrapping and model selection. A package to design batches to avoid batch effect experDesign and its website on GitHub. Explore the effects of the hyperparameters on RGCCA on the provided dataset of gliomaData (Originally provided here) there is this repository sgcca_hyperparameters. We used a pouchitis cohort published in this article[150] that was used to compare how performs our method in others dataset. The code used can be found in this repository. Some functions used to explore the TRIM dataset ended up in the integration package.This include functions for correlation, network analysis, enrichment, normalization of metadata We developed a package to analyze sets and fuzzy sets BaseSet (based on what we learned from a previous iteration of the package). This package was meant to be used with the probabilities that arise from bootstrapping the models. However, due to the long times of calculation that it would require it was not used. To analyze the BARCELONA cohort (also named antiTNF) a different repository was created to analyze the data using the previously developed packages. B.4 By project/publication All code of the analysis of the publications is available (in his messed state and complicated history) and a brief description as to why they were used: Multi-omic modelling of inflammatory bowel disease with regularized canonical correlation analysis: TRIM: Mangle with the sample, dataset, explore several methods Pugets: Explore the effects of the hyperparameters on RGCCA on the provided dataset. inteRmodel: Package for easy repeating the methodology developed on TRIM. Morgans: Work with the pouchitis cohort used in this article. Hslers: Work with the UC/CD dataset used in this article. integration: Package with functions that we wrote or used on different parts of exploring the TRIM dataset ended up here. BaseSet: BaseSet: Fuzzy logic implementation, available on rOpenSci too and its documentation website . experDesign: experDesign: Help design experiments in batches. It has a documentation website too. BARCELONA: BARCELONA: Code to analyze the BARCELONAs dataset Validation: Howells: Work with Howells 2018 dataset. Cristians: Work with Cristians 2020 dataset. References "],["articles.html", "C Articles C.1 Multi-omic modelling of inflammatory bowel disease with regularized canonical correlation analysis C.2 experDesign: stratifying samples into batches with minimal bias", " C Articles Articles published on peer-review journals about this thesis: C.1 Multi-omic modelling of inflammatory bowel disease with regularized canonical correlation analysis Article peer-reviewed published on 2021, freely available online. C.2 experDesign: stratifying samples into batches with minimal bias Article peer-reviewed published on 2021, freely available online. "],["other-datasets.html", "D Other datasets D.1 BARCELONA dataset D.2 Hernndez dataset", " D Other datasets D.1 BARCELONA dataset All patients with an established diagnosis of IBD, including Crohns disease, ulcerative colitis, unclassified IBD, indeterminate colitis, or pouchitis, starting treatment with a biologic agent were monitored following the schedule of clinical visits, laboratory tests, imaging procedures and biologic sampling at the beginning of their treatment with anti-TNF therapy and after 14 weeks and 46 weeks a biopsy from an ileocolonoscopy. The protocol was approved by the Institutional Ethics Committee of the Hospital Clinic de Barcelona (Study Number HCB/2012/7845 and HCB/2012/7956). Patients that were referred to the Hospital Clnic de Barcelona IBD unit, who had already started treatment with a biologic agent in another center, were also included adapting to the corresponding time-schedule of their treatment. In all patients, starting anti-TNF treatment will be decided before the protocol entry decision according to medical clinical practice. Anonymized identification of the patients, disease, sex age at diagnostic, age at the moment of the sample taking, time since the start of the treatment and sample segment was collected. Table D.1: Samples included from the BARCELONA dataset characteristics. Characteristic BARCELONA Individuals 62 Status (non-IBD/CD/UC) 8/33/21 Sex (female/male) 29/33 Age at diagnostic (&lt;17/&lt;40/&gt;40 years) 2/44/8 Years of disease: mean (min-max) 7.6 (0-32) Age: mean (min-max) 41 (18-68) Time (0/14/46 weeks) 41/40/32 Sample segment (ileum/colon) 39/87 The process of DNA extraction and sequencing was different for this dataset. We used different 16S-V3V4 primers pair 341f/806r on a MiSeq Nano sequencing by the RTSF Genomics Core at Michigan State University, United State of America. The sequence of the primers used was: 341f: 5-CCTACGGGAGGCAGCAG-3 806r: 5-GGACTACHVHHHTWTCTAAT-3 The result of MiSeq Nano were processed with bcl2fastq (v1.8.4). This dataset was processed as usual but as part of the quality controls of the dataset the diversity measures of the samples was analyzed on D.1: Figure D.1: Diversity indices of Barcelona according to the location and disease status. There is a lot of diversity between different groups but importantly the control samples overlap with the patients with inflammatory bowel disease. Control samples diversity should be lower and not on the same range as with samples of patients with IBD. The datasets 16S was sequenced several times by different platforms. Despite the pilots and the negative controls on the sequencing process, each time there were different problems: contamination, low quality and then this suspicious diversity. It does not seem to be a problem of the sequencing facility, so this data was abandoned as unreliable. D.2 Hernndez dataset This dataset was obtained from collaborators at Mount Sinai, Toronto, Canada [82]. Patients with UC, CD were recruited when attending regularly scheduled visits or surveillance. In addition, asymptomatic healthy controls (HC) were recruited during routine, age-related colorectal cancer screening by colonoscopy. 290 samples were collected together with information about the disease, age at diagnosis, age at the moment of the sampling, sex, sample location and smoking status. Table D.2: Characteristics of samples included from Hernndezs dataset. Characteristic Hernndez Disease (non-IBD/CD/UC) 46/54/66 Age at diagnostic (&lt;17/&lt;40/&gt;40 years) 29/73/18 Age: mean (min-max) 40 (17-71) Sex (female/male) 81/85 Smoking (never/ex/current) 115/34/16 Sample Location (ileum/colon) 97/193 D.2.1 Results It substitutes the BARCELONA dataset to confirm the results on the previous datasets. However, at the time of writing the process is not complete. References "],["models-output.html", "E Models output E.1 HSCT E.2 Hsler E.3 Morgan E.4 Howell", " E Models output ` The following appendices show the top variables for models of each dataset and their weight according to a model. E.1 HSCT E.1.1 Genes Table E.1: HSCT genes weight in model 0. Genes (with the ENSEMBL ID) and their weight on the first dimension of model 0 in HSCT dataset. Gens Weight ENSG00000266472.5 0.0456035 ENSG00000130332.14 0.0440667 ENSG00000137413.15 -0.0433810 ENSG00000143256.4 0.0433159 ENSG00000165502.6 0.0424198 ENSG00000129968.15 0.0423272 ENSG00000049239.12 -0.0419903 ENSG00000114480.12 -0.0419641 ENSG00000129559.12 0.0418544 ENSG00000160813.6 0.0416377 ENSG00000167565.12 0.0415899 ENSG00000278615.4 0.0412584 ENSG00000182117.5 0.0409828 ENSG00000125743.10 0.0409573 ENSG00000135108.14 -0.0407248 ENSG00000198937.8 0.0402243 ENSG00000108384.14 0.0400644 ENSG00000254505.9 0.0398580 ENSG00000184990.12 0.0397149 ENSG00000123144.10 0.0396117 ENSG00000172428.10 0.0395770 ENSG00000163257.10 -0.0394262 ENSG00000127445.13 0.0390458 ENSG00000232112.3 0.0390367 ENSG00000131381.12 -0.0390211 ENSG00000273730.1 0.0390062 ENSG00000274917.1 0.0390062 ENSG00000275215.1 0.0390062 ENSG00000275757.1 0.0390062 ENSG00000276700.1 0.0390062 Table E.2: HSCT genes weight in model 1.2. Genes (with the ENSEMBL ID) and their weight on the first dimension of model 1.2 in HSCT dataset. Gens Weight ENSG00000178084.1 -0.0649773 ENSG00000197444.9 -0.0610161 ENSG00000181577.15 0.0573638 ENSG00000186038.9 -0.0557866 ENSG00000136689.18 0.0537755 ENSG00000127588.4 -0.0535801 ENSG00000187714.6 -0.0528026 ENSG00000197119.12 0.0524631 ENSG00000100196.10 0.0518669 ENSG00000137709.9 -0.0515734 ENSG00000161647.18 0.0511345 ENSG00000163874.10 0.0498909 ENSG00000103647.12 -0.0487382 ENSG00000105732.12 -0.0484703 ENSG00000143819.12 -0.0477608 ENSG00000153561.12 -0.0475078 ENSG00000013392.7 0.0472729 ENSG00000186462.8 -0.0467112 ENSG00000258504.2 0.0465228 ENSG00000112902.11 -0.0454357 ENSG00000084710.13 -0.0450441 ENSG00000110619.17 0.0448852 ENSG00000154122.12 -0.0447928 ENSG00000169429.10 0.0447690 ENSG00000013375.15 0.0445391 ENSG00000140274.13 0.0439783 ENSG00000170381.12 -0.0439493 ENSG00000122565.18 0.0435753 ENSG00000133962.7 0.0435285 ENSG00000198346.10 -0.0434817 Table E.3: HSCT genes weight in model 2.2. Genes (with the ENSEMBL ID) and their weight on the first dimension of model 2.2 in HSCT dataset. Gens Weight ENSG00000256162.2 0.0390586 ENSG00000156222.11 0.0389785 ENSG00000163581.13 0.0389398 ENSG00000204978.2 0.0388415 ENSG00000278505.4 0.0386795 ENSG00000273777.4 0.0386249 ENSG00000114771.13 0.0385101 ENSG00000115255.10 0.0384254 ENSG00000165443.11 0.0383690 ENSG00000021488.12 0.0383220 ENSG00000007306.14 -0.0381505 ENSG00000138823.13 0.0379713 ENSG00000136305.11 0.0379486 ENSG00000131142.13 0.0378967 ENSG00000216588.8 0.0378897 ENSG00000120057.4 0.0378796 ENSG00000167588.12 0.0378474 ENSG00000115474.6 0.0377957 ENSG00000261012.2 0.0376443 ENSG00000110245.11 0.0375760 ENSG00000065154.11 0.0375487 ENSG00000213918.10 0.0374909 ENSG00000186862.17 0.0374837 ENSG00000023839.10 0.0374759 ENSG00000229005.2 0.0374313 ENSG00000149476.15 0.0374248 ENSG00000146426.17 0.0373228 ENSG00000021826.14 0.0372650 ENSG00000204740.10 0.0371954 ENSG00000114113.6 0.0370250 E.1.2 Microbiome Table E.4: HSCT microbiome weight in model 0. OTUs and their weight on the first dimension of model 0 in HSCT dataset. Bacterias ID Weight OTU_79 0.2881383 OTU_2907 0.2785132 OTU_102 -0.2784619 OTU_827 0.2194316 OTU_3161 0.2022577 OTU_9 0.1924814 OTU_1895 -0.1874757 OTU_634 0.1803819 OTU_60 -0.1749227 OTU_16 -0.1703163 OTU_83 -0.1664484 OTU_242 0.1654999 OTU_13 -0.1619381 OTU_346 0.1491495 OTU_3682 0.1472728 OTU_2861 0.1467828 OTU_2198 -0.1348251 OTU_1766 0.1302680 OTU_43 0.1301313 OTU_3791 0.1294442 OTU_357 0.1290163 OTU_2087 0.1247316 OTU_38 0.1225272 OTU_2619 0.1216535 OTU_1613 0.1198396 OTU_3462 0.1193395 OTU_142 0.1167569 OTU_216 -0.1161351 OTU_2 0.1134775 OTU_327 0.1094547 Table E.5: HSCT microbiome weight in model 1.2. OTUs and their weight on the first dimension of model 1.2 in HSCT dataset. Bacterias ID Weight OTU_53 -0.2926358 OTU_83 -0.2712193 OTU_102 -0.2663068 OTU_708 -0.2407498 OTU_1325 -0.2151213 OTU_915 -0.2130421 OTU_124 -0.2046890 OTU_2218 -0.1970560 OTU_189 -0.1943113 OTU_112 -0.1843460 OTU_20 0.1800015 OTU_161 -0.1789666 OTU_104 -0.1754370 OTU_86 -0.1541973 OTU_26 -0.1517154 OTU_226 -0.1450273 OTU_116 -0.1427346 OTU_9 0.1395169 OTU_228 -0.1287262 OTU_151 -0.1259956 OTU_195 -0.1251407 OTU_4762 -0.1191339 OTU_629 -0.1151510 OTU_15 -0.1117814 OTU_8 -0.1074008 OTU_203 -0.1031445 OTU_1084 -0.0900318 OTU_60 -0.0888786 OTU_4376 0.0876770 OTU_3823 -0.0875398 Table E.6: HSCT microbiome weight in model 2.2. OTUs and their weight on the first dimension of model 2.2 in HSCT dataset. Bacterias ID Weight OTU_102 0.3652173 OTU_83 0.2877509 OTU_20 -0.2767424 OTU_53 0.2204974 OTU_242 -0.2017950 OTU_216 0.1882468 OTU_41 0.1867378 OTU_116 0.1809677 OTU_452 0.1785050 OTU_9 -0.1746704 OTU_327 -0.1635900 OTU_5203 0.1433555 OTU_241 -0.1404794 OTU_169 0.1403548 OTU_1766 -0.1360090 OTU_157 -0.1343136 OTU_3462 -0.1284234 OTU_13 0.1269981 OTU_16 0.1269795 OTU_122 0.1242579 OTU_1895 0.1230724 OTU_300 0.1211617 OTU_1084 0.1166934 OTU_1118 0.1165312 OTU_4376 -0.1140843 OTU_629 0.1124190 OTU_26 0.1087521 OTU_500 0.1082343 OTU_33 0.1046028 OTU_4024 0.1046011 E.2 Hsler E.2.1 Genes Table E.7: Hsler genes weight in model 0. Genes and their weight on the first dimension of model 0 in Hsler dataset. Gens Weight ENSG00000166432.10 -0.0256950 ENSG00000089775.7 -0.0255069 ENSG00000256594.3 -0.0249707 ENSG00000137364.4 0.0249337 ENSG00000188643.6 0.0247278 ENSG00000257027.1 -0.0245974 ENSG00000005471.11 -0.0245969 ENSG00000128881.12 -0.0244917 ENSG00000163492.9 -0.0244566 ENSG00000180626.9 -0.0244226 ENSG00000172349.12 -0.0242140 ENSG00000164048.9 -0.0242108 ENSG00000173258.8 -0.0241094 ENSG00000254285.2 0.0240426 ENSG00000188848.11 -0.0239381 ENSG00000135426.10 -0.0238463 ENSG00000235532.1 -0.0237835 ENSG00000100100.8 -0.0237585 ENSG00000112365.4 -0.0237069 ENSG00000044115.16 0.0236926 ENSG00000108829.9 0.0236828 ENSG00000134744.9 -0.0235820 ENSG00000112182.10 -0.0235139 ENSG00000155657.19 -0.0234856 ENSG00000116497.13 -0.0234690 ENSG00000113384.9 0.0234360 ENSG00000170421.7 0.0234250 ENSG00000108799.8 -0.0234161 ENSG00000117308.10 0.0233947 ENSG00000171681.8 -0.0232961 Table E.8: Hsler genes weight in model 1.2. Genes and their weight on the first dimension of model 1.2 in Hsler dataset. Gens Weight ENSG00000168060.10 -0.0231742 ENSG00000162989.3 -0.0230893 ENSG00000108576.5 -0.0230390 ENSG00000149582.11 -0.0230267 ENSG00000172689.1 -0.0229890 ENSG00000106404.9 -0.0229805 ENSG00000120057.4 -0.0229580 ENSG00000170482.12 -0.0229343 ENSG00000176928.4 -0.0229184 ENSG00000110693.11 -0.0228633 ENSG00000110080.14 0.0228500 ENSG00000148942.10 -0.0228023 ENSG00000143627.13 -0.0227952 ENSG00000149476.10 -0.0227507 ENSG00000249948.2 -0.0227502 ENSG00000163032.7 0.0227023 ENSG00000156920.6 -0.0227009 ENSG00000158865.8 -0.0226897 ENSG00000256162.2 -0.0226878 ENSG00000105398.3 -0.0226290 ENSG00000213918.6 -0.0226275 ENSG00000173406.11 -0.0225849 ENSG00000135929.4 -0.0225431 ENSG00000146426.13 -0.0225222 ENSG00000261012.2 -0.0225182 ENSG00000229005.2 -0.0225148 ENSG00000163803.8 -0.0225005 ENSG00000178573.6 -0.0224647 ENSG00000109193.6 -0.0224641 ENSG00000134042.8 -0.0224304 Table E.9: Hsler genes weight in model 2.2. Genes and their weight on the first dimension of model 2.2 in Hsler dataset. Gens Weight ENSG00000137634.5 0.0238500 ENSG00000130700.6 -0.0237268 ENSG00000204740.5 -0.0235952 ENSG00000174885.8 -0.0235645 ENSG00000007306.10 0.0235292 ENSG00000154252.11 0.0233875 ENSG00000167230.6 -0.0233772 ENSG00000110245.7 -0.0233415 ENSG00000172318.4 0.0233192 ENSG00000176395.8 -0.0233119 ENSG00000204978.2 -0.0232979 ENSG00000165443.7 -0.0232848 ENSG00000104267.5 0.0232729 ENSG00000243766.3 0.0232634 ENSG00000019102.7 0.0232361 ENSG00000154646.4 -0.0231627 ENSG00000167588.8 -0.0231575 ENSG00000115474.6 -0.0231492 ENSG00000163581.9 -0.0231436 ENSG00000138792.5 -0.0231323 ENSG00000138823.8 -0.0230876 ENSG00000021488.8 -0.0230651 ENSG00000156222.7 -0.0230557 ENSG00000104450.8 0.0230393 ENSG00000110244.5 -0.0230369 ENSG00000159184.7 0.0229899 ENSG00000256162.2 -0.0229870 ENSG00000106031.6 0.0229779 ENSG00000109193.6 -0.0229747 ENSG00000114771.9 -0.0229468 E.2.2 Microbiome Table E.10: Hsler microbiome weight in model 0. ASVs and their weight on the first dimension of model 0 in Hsler dataset. Bacterias ID Weight Otu00100 0.0672144 Otu00856 0.0649676 Otu00322 0.0644017 Otu00396 0.0633326 Otu00038 0.0607676 Otu00607 0.0583497 Otu00839 0.0575094 Otu00021 0.0570872 Otu01072 0.0562603 Otu00013 0.0562207 Otu00394 0.0560274 Otu01275 0.0559946 Otu01327 0.0559946 Otu01356 0.0559946 Otu01371 0.0559946 Otu01413 0.0559946 Otu01534 0.0559946 Otu01551 0.0559946 Otu01612 0.0559946 Otu01887 0.0559946 Otu01911 0.0559946 Otu01966 0.0559946 Otu02014 0.0559946 Otu02027 0.0559946 Otu02143 0.0559946 Otu02155 0.0559946 Otu02255 0.0559946 Otu02345 0.0559946 Otu02363 0.0559946 Otu02463 0.0559946 Table E.11: Hsler microbiome weight in model 1.2. ASVs and their weight on the first dimension of model 1.2 in Hsler dataset. Bacterias ID Weight Otu00961 0.0564135 Otu00353 0.0541289 Otu01113 0.0483349 Otu00228 0.0475690 Otu00914 0.0471097 Otu00764 0.0461756 Otu00275 0.0459816 Otu00048 0.0451933 Otu00003 0.0429347 Otu00509 -0.0424117 Otu00915 0.0418800 Otu00450 0.0415114 Otu00773 0.0415114 Otu00984 0.0415114 Otu01049 0.0415114 Otu01076 0.0415114 Otu01127 0.0415114 Otu01187 0.0415114 Otu01197 0.0415114 Otu01239 0.0415114 Otu01278 0.0415114 Otu01322 0.0415114 Otu01369 0.0415114 Otu01511 0.0415114 Otu01519 0.0415114 Otu01535 0.0415114 Otu01549 0.0415114 Otu01550 0.0415114 Otu01601 0.0415114 Otu01679 0.0415114 Table E.12: Hsler microbiome weight in model 2.2. ASVs and their weight on the first dimension of model 2.2 in Hsler dataset. Bacterias ID Weight Otu00158 0.0686844 Otu00097 0.0674805 Otu00228 0.0673602 Otu00193 0.0673237 Otu00351 0.0669005 Otu00261 0.0658888 Otu00230 0.0655882 Otu01058 0.0631144 Otu00529 0.0613007 Otu00399 0.0593297 Otu00392 -0.0585349 Otu00069 -0.0562498 Otu00653 0.0557877 Otu00675 0.0529940 Otu00003 0.0527516 Otu00187 -0.0523768 Otu00111 -0.0504157 Otu00050 0.0503847 Otu00504 -0.0498398 Otu00806 0.0495751 Otu00220 0.0495472 Otu00969 0.0493767 Otu00052 -0.0487349 Otu00350 0.0485622 Otu00353 0.0483550 Otu00120 0.0477017 Otu00411 0.0469352 Otu00548 0.0469334 Otu00580 0.0469319 Otu00651 0.0469220 E.3 Morgan E.3.1 Genes Table E.13: Morgan genes weight in model 0. Genes and their weight on the first dimension of model 0 in Morgan dataset. Gens Weight 51095 0.1737967 51306 0.1591623 55023 0.1508991 23350 0.1327847 23517 0.1327092 6093 0.1295198 55035 0.1280594 23358 0.1229318 1385 0.1187076 23451 0.1177209 6873 0.1173943 84146 0.1172078 5922 0.1162091 9852 0.1152178 7175 0.1149911 55578 0.1138315 100130428 0.1126843 26098 0.1123347 23047 0.1118195 9044 0.1107288 167153 0.1107056 10260 0.1097313 253260 0.1085950 64895 0.1074803 286410 0.1073855 27332 0.1072184 905 0.1024215 8880 0.1003297 4659 0.0991866 7155 0.0989912 Table E.14: Morgan genes weight in model 1.2. Genes and their weight on the first dimension of model 1.2 in Morgan dataset. Gens Weight 9457 0.1921094 6622 0.1796822 28513 0.1759460 11326 0.1598010 6598 -0.1566792 387775 0.1521147 3202 -0.1512539 3201 -0.1488354 4660 0.1292649 6752 -0.1282156 9475 0.1237949 55734 -0.1196241 71 -0.1183231 5464 0.1182357 383 0.1175214 55510 0.1164200 1381 -0.1157208 5803 0.1153165 6603 -0.1129680 171019 0.1113954 406995 0.1103490 284232 -0.1073072 220002 -0.1072004 60314 -0.1057022 91355 0.1055908 6689 -0.1017615 91647 -0.1008438 6317 0.0962729 4360 0.0960040 63935 -0.0958012 Table E.15: Morgan genes weight in model 2.2. Genes and their weight on the first dimension of model 2.2 in Morgan dataset. Gens Weight 6532 0.1664379 4129 0.1473841 9154 0.1470430 9429 0.1409609 83661 0.1349351 92840 0.1327726 10004 0.1320366 8029 0.1318087 4094 0.1303898 159963 0.1282590 7512 0.1238329 9963 0.1212076 151295 0.1204538 115584 0.1187887 283375 0.1180023 151056 0.1179486 8556 0.1167189 1800 0.1162887 1600 0.1159077 2980 0.1110967 51301 0.1106059 140803 0.1061265 3795 0.1055214 22949 0.1043400 4225 0.1016994 4311 0.1015507 5243 0.1011880 79154 0.1003405 26230 0.0988540 84647 0.0983498 E.3.2 Microbiome Table E.16: Morgan microbiome weight in model 0. OTUs and their weight on the first dimension of model 0 in Morgan dataset. Bacterias ID Weight 2522 -0.0800791 566 -0.0685763 4902 -0.0674629 2698 -0.0674629 6119 -0.0674629 601 -0.0674629 5202 0.0604631 1115 -0.0594071 2749 -0.0586973 1471 -0.0573682 3509 -0.0568626 1212 -0.0564636 5186 -0.0550803 3450 -0.0540439 5435 -0.0533142 6326 -0.0530629 1053 -0.0529661 2018 -0.0521585 399 -0.0520791 6272 -0.0519789 5603 -0.0517056 6910 0.0516021 295 -0.0513494 1229 -0.0506591 303 -0.0505856 214 -0.0502970 1945 -0.0502189 325 -0.0499548 1462 -0.0497684 6285 -0.0494503 Table E.17: Morgan microbiome weight in model 1.2. OTUs and their weight on the first dimension of model 1.2 in Morgan dataset. Bacterias ID Weight 2715 -0.0590339 4430 -0.0560565 5254 -0.0557235 6478 -0.0548823 5635 -0.0544966 240 -0.0525685 111 -0.0517381 6 -0.0516542 40 -0.0513908 7 -0.0513428 3520 -0.0507224 4656 -0.0506837 26 -0.0499941 51 -0.0494708 20 -0.0493355 4433 -0.0483064 4620 -0.0474256 6126 -0.0469061 1516 -0.0467743 53 -0.0465712 45 -0.0464921 6169 -0.0452640 3364 -0.0450982 5245 -0.0448922 4538 -0.0448875 5194 -0.0446537 4667 -0.0446010 4998 -0.0445878 95 -0.0443084 4628 -0.0439571 Table E.18: Morgan microbiome weight in model 2.2. OTUs and their weight on the first dimension of model 2.2 in Morgan dataset. Bacterias ID Weight 6302 0.0838393 717 0.0720657 1838 0.0687877 2019 0.0677190 2158 0.0677190 113 0.0674896 6477 0.0660561 1253 0.0656977 2741 0.0656977 2553 0.0648255 306 0.0640717 2197 0.0637912 519 0.0615093 5772 0.0597852 2212 0.0597480 5546 0.0595234 5202 0.0587761 3348 0.0579831 4668 0.0579831 5163 0.0575430 4423 0.0568857 4578 0.0555136 6184 0.0546266 5207 0.0537541 4350 0.0536939 2213 0.0529738 1710 0.0508599 1299 0.0506356 4509 0.0499265 2853 0.0497109 E.4 Howell E.4.1 Genes Table E.19: Howell genes weight in model 0. Genes and their weight on the first dimension of model 0 in Howell dataset. Gens Weight ENSG00000165629 -0.0546586 ENSG00000125863 -0.0542015 ENSG00000100347 -0.0531023 ENSG00000184752 -0.0529031 ENSG00000004779 -0.0524148 ENSG00000109919 -0.0519989 ENSG00000143612 -0.0517753 ENSG00000156411 -0.0516415 ENSG00000147475 -0.0513040 ENSG00000148943 -0.0509856 ENSG00000119541 -0.0508802 ENSG00000116459 -0.0507788 ENSG00000144840 -0.0503280 ENSG00000108588 -0.0502693 ENSG00000137210 -0.0501921 ENSG00000142864 -0.0499362 ENSG00000140740 -0.0498572 ENSG00000143155 -0.0492047 ENSG00000154174 -0.0491224 ENSG00000184983 -0.0489342 ENSG00000198015 -0.0488989 ENSG00000166170 -0.0488463 ENSG00000204370 -0.0485859 ENSG00000164258 -0.0484551 ENSG00000143727 -0.0480934 ENSG00000053770 -0.0480545 ENSG00000143742 -0.0479293 ENSG00000164022 -0.0478868 ENSG00000138777 -0.0478589 ENSG00000014824 -0.0478026 Table E.20: Howell genes weight in model 1.2. Genes and their weight on the first dimension of model 1.2 in Howell dataset. Gens Weight ENSG00000164920 0.0523297 ENSG00000183742 0.0512658 ENSG00000130700 0.0511573 ENSG00000150527 0.0505312 ENSG00000143921 0.0502000 ENSG00000108576 0.0494316 ENSG00000204740 0.0489483 ENSG00000110245 0.0486795 ENSG00000156222 0.0484512 ENSG00000133636 0.0483357 ENSG00000167588 0.0482908 ENSG00000021488 0.0479126 ENSG00000012504 0.0478273 ENSG00000166268 0.0477829 ENSG00000138792 0.0477696 ENSG00000015413 0.0477391 ENSG00000163900 0.0477181 ENSG00000146426 0.0475924 ENSG00000138030 0.0473961 ENSG00000134042 0.0473942 ENSG00000158865 0.0473545 ENSG00000166959 0.0471633 ENSG00000114113 0.0470936 ENSG00000163581 0.0470072 ENSG00000135111 0.0469149 ENSG00000138109 0.0469076 ENSG00000172689 0.0468983 ENSG00000169116 -0.0468340 ENSG00000138823 0.0467165 ENSG00000144410 0.0466834 Table E.21: Howell genes weight in model 2.2. Genes and their weight on the first dimension of model 2.2 in Howell dataset. Gens Weight ENSG00000130700 0.0552195 ENSG00000164920 0.0538502 ENSG00000143921 0.0516188 ENSG00000204740 0.0515900 ENSG00000132517 0.0510265 ENSG00000012504 0.0508416 ENSG00000106031 -0.0507384 ENSG00000150527 0.0505005 ENSG00000183742 0.0494936 ENSG00000015413 0.0493307 ENSG00000138792 0.0491054 ENSG00000174885 0.0491027 ENSG00000166268 0.0490889 ENSG00000133636 0.0490181 ENSG00000273777 0.0490106 ENSG00000131142 0.0486012 ENSG00000136872 0.0484939 ENSG00000167588 0.0484363 ENSG00000110245 0.0484222 ENSG00000235122 0.0483907 ENSG00000179603 -0.0483898 ENSG00000021488 0.0483263 ENSG00000156222 0.0482785 ENSG00000109193 0.0482777 ENSG00000164946 0.0482170 ENSG00000166959 0.0481486 ENSG00000138823 0.0480886 ENSG00000021826 0.0480123 ENSG00000108576 0.0477467 ENSG00000146426 0.0473801 E.4.2 Microbiome Table E.22: Howell microbiome weight in model 0. OTUs and their weight on the first dimension of model 0 in Howell dataset. Bacterias ID Weight GGCGGCGCGCCTAACACATG 0.0803729 GGCGGCGTGCTTAACACATG 0.0800010 GGCGGCGCGCCTAACACATG 0.0740485 GGCGGCGTGCTTAACACATG 0.0723710 GGCGGCGTGCTTAACACATG 0.0720383 GGCGGCGTGCTTAACACATG 0.0720173 AGCTACAGGCTTAACACATG 0.0683574 GGCGGCGTGCTTAACACATG 0.0680664 AGCGACAGGCTTAACACATG 0.0654374 GGCGGCGTGCTTAACACATG 0.0649646 GGCGGCGTGCTTAACACATG 0.0647652 GGCGGCGCGCCTAACACATG 0.0644855 GGCGGCGTGCTTAACACATG 0.0639237 GGCGGCGCGCCTAACACATG 0.0637146 GGCGGCGTGCTTAACACATG 0.0636283 GGCGGCGCGCCTAACACATG 0.0635899 GGCGGCGTGCTTAACACATG 0.0635262 GGCGGCGTGCTTAACACATG 0.0634932 GGCGGCGTGCTTAACACATG 0.0634499 GGCGGCGTGCTTAACACATG 0.0632328 GGCGGCGCGCCTAACACATG 0.0632074 GGCGGCGTGCTTAACACATG 0.0631248 GGCGGCGTGCTTAACACATG 0.0630956 GGCGGCGTGCTTAACACATG 0.0627362 GGCGGCGCGCCTAACACATG 0.0626136 GGCGGCGCGCCTAACACATG 0.0625425 GGCGGCGCGCCTAACACATG 0.0625093 GGCGGCGCGCCTAACACATG 0.0624945 GGCGGCGTGCTTAACACATG 0.0624716 GGCGGCGCGCCTAACACATG 0.0622848 Table E.23: Howell microbiome weight in model 1.2. OTUs and their weight on the first dimension of model 1.2 in Howell dataset. Bacterias ID Weight GGCGGCGTGCCTAACACATG 0.0757448 GGCGGCGTGCTTAACACATG 0.0694968 GGCGGCGTGCTTAACACATG 0.0641809 GGCGGCGTGCTTAACACATG -0.0617806 GGCGGCGCGCCTAACACATG -0.0600289 GGCGGCGTGCTTAACACATG -0.0597203 GGCGGCGTGCTTAACACATG 0.0586173 GGCGGCGCGCCTAACACATG 0.0586173 GGCGGCGTGCTTAACACATG 0.0586173 GGCGGCGTGCCTAACACATG 0.0586173 GGCGGCGCGCTTAACACATG 0.0586173 GGCGGCGCGCCTAACACATG 0.0586173 GGCGGCGTGCCTAACACATG 0.0586173 GGCGGCGCGCCTAACACATG 0.0586173 GGCGGCGCGCCTAACACATG 0.0586173 GGCGGCGCGCCTAACACATG 0.0586173 GGCGGCGTGCTTAACACATG 0.0586173 GGCGGCATGCCTTACACATG -0.0580615 GGCGGCGTGCCTAATACATG 0.0576848 GGCGGCGTGCCTAATACATG 0.0556642 GGCGGCGTGCTTAACACATG -0.0542767 GGCGGCGTGCTTAACACATG 0.0540257 GGCGGCGTGCTTAACACATG -0.0524921 GGCGGCGTGCTTAACACATG 0.0523110 GGCGGCGTGCCTAACACATG 0.0523110 GGCGGCGTGCTTAACACATG 0.0523110 GGCGGCGTGCTTAACACATG 0.0523110 AGCTACAGGCTTAACACATG 0.0523110 GGCGGCGTGCTTAACACATG 0.0523110 GGCGGCGTGCTTAACACATG -0.0516570 Table E.24: Howell microbiome weight in model 2.2. OTUs and their weight on the first dimension of model 2.2 in Howell dataset. Bacterias ID Weight GGCGGCAGGCTTAACACATG -0.0720569 GGCGGCGTGCCTAACACATG -0.0704926 AGCTACAGGCTTAACACATG -0.0672298 GGCGGCGTGCCTAATACATG -0.0662263 GGCGGCGTGCCTAACACATG -0.0659790 GGCGGCGTGCCTAATACATG -0.0653346 GGCGGCAGGCTTAACACATG -0.0653203 AGCTACAGGCTTAACACATG -0.0653147 GGCGGCGCGCCTAACACATG -0.0653129 GGCGGCGTGCCTAATACATG -0.0653075 GGCGGCGCGCCTAACACATG -0.0653016 GGCGGCGCGCCTAACACATG -0.0652995 GGCGGCATGCTTTACACATG -0.0652981 GGCGGCGCGCCTAACACATG -0.0652913 AGCTACAGGCTTAACACATG -0.0652795 AGCTACAGGCTTAACACATG -0.0652778 AGCGACAGGCTTAACACATG -0.0652764 GGCGGCGCGCCTAACACATG -0.0652585 GGCGGCGTGCCTAACACATG -0.0652556 GGCGGCGCGCCTAACACATG -0.0652494 GGCGGAACGCTTTACACATG -0.0651797 GGCGGAACGCTTTACACATG -0.0651401 GGCGGCGTGCTTAACACATG -0.0651092 GGCGGCAGGCCTAACACATG -0.0650990 AGCTACAGGCTTAACACATG -0.0650823 GGCGGCGTGCCTAACACATG -0.0650731 GGCGGCGCGCCTAACACATG -0.0650576 GGCGGCGCGCCTAACACATG -0.0649906 AGCGACAGGCTTAACACATG -0.0627209 GGCGGCAGGCCTAACACATG -0.0624542 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
