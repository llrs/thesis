<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Results | Data integration on inflammatory bowel disease</title>
  <meta name="description" content="Thesis about the relationship between microbiome and transcriptome on the gastrointestinal tract on patients with IBD and some controls to discover key differences on this relationship." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Results | Data integration on inflammatory bowel disease" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://thesis.llrs.dev" />
  <meta property="og:image" content="https://thesis.llrs.dev/images/R_logo_science.png" />
  <meta property="og:description" content="Thesis about the relationship between microbiome and transcriptome on the gastrointestinal tract on patients with IBD and some controls to discover key differences on this relationship." />
  <meta name="github-repo" content="llrs/thesis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Results | Data integration on inflammatory bowel disease" />
  <meta name="twitter:site" content="@Lluis_Revilla" />
  <meta name="twitter:description" content="Thesis about the relationship between microbiome and transcriptome on the gastrointestinal tract on patients with IBD and some controls to discover key differences on this relationship." />
  <meta name="twitter:image" content="https://thesis.llrs.dev/images/R_logo_science.png" />

<meta name="author" content="Lluís Revilla Sancho" />


<meta name="date" content="2022-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="materials-and-methods.html"/>
<link rel="next" href="discussion.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Data integration on IBD</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="abstract.html"><a href="abstract.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#IBD"><i class="fa fa-check"></i><b>1.1</b> Inflammatory bowel disease</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#etiology-and-pathogenesis"><i class="fa fa-check"></i><b>1.1.1</b> Etiology and pathogenesis</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#CD"><i class="fa fa-check"></i><b>1.1.2</b> CD physiology</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#UC"><i class="fa fa-check"></i><b>1.1.3</b> UC physiology</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#treatment"><i class="fa fa-check"></i><b>1.1.4</b> Treatment</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#summary-ibd"><i class="fa fa-check"></i><b>1.1.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#integration-studies-on-ibd"><i class="fa fa-check"></i><b>1.2</b> Integration studies on IBD</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#data-origin"><i class="fa fa-check"></i><b>1.2.1</b> Data origin</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#summary-studies"><i class="fa fa-check"></i><b>1.2.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#integration"><i class="fa fa-check"></i><b>1.3</b> Integration</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#classification-of-integration-methods"><i class="fa fa-check"></i><b>1.3.1</b> Classification of integration method’s</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#interpretation"><i class="fa fa-check"></i><b>1.3.2</b> Interpretation</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#reviews"><i class="fa fa-check"></i><b>1.3.3</b> Reviews</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#methods-integration"><i class="fa fa-check"></i><b>1.3.4</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hypothesis-and-objectives.html"><a href="hypothesis-and-objectives.html"><i class="fa fa-check"></i><b>2</b> Hypothesis and objectives</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hypothesis-and-objectives.html"><a href="hypothesis-and-objectives.html#hypothesis"><i class="fa fa-check"></i><b>2.1</b> Hypothesis</a></li>
<li class="chapter" data-level="2.2" data-path="hypothesis-and-objectives.html"><a href="hypothesis-and-objectives.html#objectives"><i class="fa fa-check"></i><b>2.2</b> Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="materials-and-methods.html"><a href="materials-and-methods.html"><i class="fa fa-check"></i><b>3</b> Materials and methods</a>
<ul>
<li class="chapter" data-level="3.1" data-path="materials-and-methods.html"><a href="materials-and-methods.html#datasets"><i class="fa fa-check"></i><b>3.1</b> Datasets</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="materials-and-methods.html"><a href="materials-and-methods.html#methods-puget"><i class="fa fa-check"></i><b>3.1.1</b> Puget’s dataset</a></li>
<li class="chapter" data-level="3.1.2" data-path="materials-and-methods.html"><a href="materials-and-methods.html#methods-hsct"><i class="fa fa-check"></i><b>3.1.2</b> HSCT dataset</a></li>
<li class="chapter" data-level="3.1.3" data-path="materials-and-methods.html"><a href="materials-and-methods.html#methods-hasler"><i class="fa fa-check"></i><b>3.1.3</b> Häsler’s dataset</a></li>
<li class="chapter" data-level="3.1.4" data-path="materials-and-methods.html"><a href="materials-and-methods.html#methods-morgan"><i class="fa fa-check"></i><b>3.1.4</b> Morgan’s dataset</a></li>
<li class="chapter" data-level="3.1.5" data-path="materials-and-methods.html"><a href="materials-and-methods.html#methods-barcelona"><i class="fa fa-check"></i><b>3.1.5</b> BARCELONA dataset</a></li>
<li class="chapter" data-level="3.1.6" data-path="materials-and-methods.html"><a href="materials-and-methods.html#methods-howell"><i class="fa fa-check"></i><b>3.1.6</b> Howell’s dataset</a></li>
<li class="chapter" data-level="3.1.7" data-path="materials-and-methods.html"><a href="materials-and-methods.html#methods-hernandez"><i class="fa fa-check"></i><b>3.1.7</b> Hernández’ dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="materials-and-methods.html"><a href="materials-and-methods.html#processing-samples"><i class="fa fa-check"></i><b>3.2</b> Processing samples</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="materials-and-methods.html"><a href="materials-and-methods.html#transcriptome-sequencing"><i class="fa fa-check"></i><b>3.2.1</b> Transcriptome sequencing</a></li>
<li class="chapter" data-level="3.2.2" data-path="materials-and-methods.html"><a href="materials-and-methods.html#microbial-dna-sequencing"><i class="fa fa-check"></i><b>3.2.2</b> Microbial DNA sequencing</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="materials-and-methods.html"><a href="materials-and-methods.html#statistics"><i class="fa fa-check"></i><b>3.3</b> Statistics</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="materials-and-methods.html"><a href="materials-and-methods.html#functional-enrichment"><i class="fa fa-check"></i><b>3.3.1</b> Functional enrichment</a></li>
<li class="chapter" data-level="3.3.2" data-path="materials-and-methods.html"><a href="materials-and-methods.html#other-methods-used"><i class="fa fa-check"></i><b>3.3.2</b> Other methods used</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="materials-and-methods.html"><a href="materials-and-methods.html#regularized-generalized-canonical-correlation-analysis"><i class="fa fa-check"></i><b>3.4</b> Regularized generalized canonical correlation analysis</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="materials-and-methods.html"><a href="materials-and-methods.html#description"><i class="fa fa-check"></i><b>3.4.1</b> Description</a></li>
<li class="chapter" data-level="3.4.2" data-path="materials-and-methods.html"><a href="materials-and-methods.html#results"><i class="fa fa-check"></i><b>3.4.2</b> Results</a></li>
<li class="chapter" data-level="3.4.3" data-path="materials-and-methods.html"><a href="materials-and-methods.html#models"><i class="fa fa-check"></i><b>3.4.3</b> Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="results-1.html"><a href="results-1.html"><i class="fa fa-check"></i><b>4</b> Results</a>
<ul>
<li class="chapter" data-level="4.1" data-path="results-1.html"><a href="results-1.html#packages"><i class="fa fa-check"></i><b>4.1</b> Packages</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="results-1.html"><a href="results-1.html#experdesign-1"><i class="fa fa-check"></i><b>4.1.1</b> experDesign</a></li>
<li class="chapter" data-level="4.1.2" data-path="results-1.html"><a href="results-1.html#baseset-1"><i class="fa fa-check"></i><b>4.1.2</b> BaseSet</a></li>
<li class="chapter" data-level="4.1.3" data-path="results-1.html"><a href="results-1.html#intermodels"><i class="fa fa-check"></i><b>4.1.3</b> inteRmodels</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="results-1.html"><a href="results-1.html#analysis"><i class="fa fa-check"></i><b>4.2</b> Analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="results-1.html"><a href="results-1.html#results-puget"><i class="fa fa-check"></i><b>4.2.1</b> Puget’s dataset</a></li>
<li class="chapter" data-level="4.2.2" data-path="results-1.html"><a href="results-1.html#results-hsct"><i class="fa fa-check"></i><b>4.2.2</b> HSCT dataset</a></li>
<li class="chapter" data-level="4.2.3" data-path="results-1.html"><a href="results-1.html#results-hasler"><i class="fa fa-check"></i><b>4.2.3</b> Häsler’s dataset</a></li>
<li class="chapter" data-level="4.2.4" data-path="results-1.html"><a href="results-1.html#results-morgan"><i class="fa fa-check"></i><b>4.2.4</b> Morgan’s dataset</a></li>
<li class="chapter" data-level="4.2.5" data-path="results-1.html"><a href="results-1.html#results-barcelona"><i class="fa fa-check"></i><b>4.2.5</b> BARCELONA dataset</a></li>
<li class="chapter" data-level="4.2.6" data-path="results-1.html"><a href="results-1.html#results-howell"><i class="fa fa-check"></i><b>4.2.6</b> Howell’s dataset</a></li>
<li class="chapter" data-level="4.2.7" data-path="results-1.html"><a href="results-1.html#results-hernandez"><i class="fa fa-check"></i><b>4.2.7</b> Hernández’ dataset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>5</b> Discussion</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="discussion.html"><a href="discussion.html#other"><i class="fa fa-check"></i><b>5.0.1</b> Other</a></li>
<li class="chapter" data-level="5.1" data-path="discussion.html"><a href="discussion.html#relevance-for-other-research"><i class="fa fa-check"></i><b>5.1</b> Relevance for other research</a></li>
<li class="chapter" data-level="5.2" data-path="discussion.html"><a href="discussion.html#implications-of-research"><i class="fa fa-check"></i><b>5.2</b> Implications of research</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>6</b> Conclusions</a></li>
<li class="chapter" data-level="7" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i><b>7</b> Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a>
<ul>
<li class="chapter" data-level="7.1" data-path="appendix.html"><a href="appendix.html#online-resources"><i class="fa fa-check"></i><b>7.1</b> Online resources</a></li>
<li class="chapter" data-level="7.2" data-path="appendix.html"><a href="appendix.html#software"><i class="fa fa-check"></i><b>7.2</b> Software</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="appendix.html"><a href="appendix.html#listed"><i class="fa fa-check"></i><b>7.2.1</b> Listed</a></li>
<li class="chapter" data-level="7.2.2" data-path="appendix.html"><a href="appendix.html#by-project"><i class="fa fa-check"></i><b>7.2.2</b> By project</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data integration on inflammatory bowel disease</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = "wip">
This tesis is ongoing and still without hard date to finish it. Watch the <a href="https://github.com/llrs/thesis">GitHub repository</a> or wait for a release announcement on Twitter on <a href="https://twitter.com/Lluis_Revilla">my profile</a>.
</div>
<div id="results-1" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Results</h1>
<div id="packages" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Packages</h2>
<div id="experdesign-1" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> experDesign</h3>
<p><code>experDesign</code> package built in R was released for the first time on CRAN on 2020-09-08 after nearly a year after the initial release made on <a href="https://github.com/llrs/experDesign">github</a>.</p>
<p>The package uses functional programming to create and modify objects and the features used.
The package didn’t need a new class created to work and bases its performance on the large body of work made by the R core team.
It simply adds the needed information on the columns of the introduced <code>data.frame</code> or returns an appropriate vector.</p>
<p><code>experDesign</code> functions are divided into several categories:</p>
<ul>
<li><p>Helper functions to aid on deciding how many batches are or how many samples per batch.
There are some also that report how good a given distribution of the samples felt for a given dataset.</p></li>
<li><p>Functions generating indexes.</p></li>
<li><p>Functions distributing the samples on indexes</p></li>
</ul>
<p>Regarding time related variables <code>experDesign</code> will use them as factors, while issuing a warning to the user.</p>
<p>Since its development it has been used on a couple of batch designs, one for organoids bulk RNA-seq and another one for biopsies bulk RNA-seq from the BARCELONA cohort.</p>
<p>On both cases it worked well and no batch effect were created when sequencing samples.
However on the organoids dataset, the change on the method of producing them introduced a batch effect that made it impposible to compare samples before and after that change.</p>
<p>Since its release on CRAN it has had a median of ~400 downloads each month from RStudio package manager, so the total number of downloads is higher as not all the installations are from RStudio’s mirror.</p>
</div>
<div id="baseset-1" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> BaseSet</h3>
<p><code>BaseSet</code> package, built in R, was released for the first time on CRAN on 2020-11-11 after nearly two years after the initial work started on <a href="https://github.com/llrs/BaseSet">github</a>.</p>
<p>The package uses both functional programming and object oriented program to create and modify the TidySet S4 object defined<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.
Mixing it with S3 generic functions it provides a powerful interface compatible with the tidyverse principles, a <a href="https://www.tidyverse.org/">group of packages</a> following the same design.
The package provides a new class to handle fuzzy sets and the associate information.</p>
<p><code>BaseSet</code> methods are divided into several categories:</p>
<ul>
<li><p><a href="https://docs.ropensci.org/BaseSet/reference/index.html#general">General functions</a> to create sets of the TidySet class or convert from it to a list or about the package.</p></li>
<li><p><a href="https://docs.ropensci.org/BaseSet/reference/index.html#set-operations">Set operations</a> like adjacency cartesian product, cardinality, complement, incidence, independence, intersection, union, subtract, power set or size.</p></li>
<li><p><a href="https://docs.ropensci.org/BaseSet/reference/index.html#set-operations">Functions to work with TidySets</a> to add relationships, sets, elements or some complimentary data about them.
Remove the same or simply move around data or calculate the number of elements, relations and sets.</p></li>
<li><p><a href="https://docs.ropensci.org/BaseSet/reference/index.html#reading-files">Functions to read</a> files from formats where sets are usually stored in the bioinformatician world: GAF, GMT and OBO formats</p></li>
<li><p>Last, some <a href="https://docs.ropensci.org/BaseSet/reference/index.html#utiles">utility functions</a> to set name conventions, use set_symbols and some other auxiliary functions</p></li>
</ul>
<p>The package had a long development process with initial iterations basing on GSEABase package which was later abandoned to include also some uncertainty on the relationship of a gene with a given gene set.</p>
<p>The package also participated on an exploration on part of the Bioconductor community (project to develop, support, and disseminate free open source software that facilitates rigorous and reproducible analysis of data from current and emerging biological assay) for more modern and faster handling of sets.
There were three different packages created as part of this process, <code>BaseSet</code>, <code>BiocSet</code> published <a href="https://bioconductor.org/packages/BiocSet/">on Bioconductor</a> and <code>unisets</code>, available <a href="https://github.com/kevinrue/unisets">on github</a>.
The different approaches were presented at a birds of feather on BioC2019.</p>
<p>The package passed the review on the rOpenSci organization (<a href="https://github.com/ropensci/software-review/issues/359" title="Review on Github">See review</a>) and now is part of the packages hosted there too.</p>
<p>Since its release on CRAN it has had a median of ~400 downloads each month from RStudio package manager, so the total number of downloads is higher.</p>
</div>
<div id="intermodels" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> inteRmodels</h3>
<p>The package was build once the method used to find accurate models of the relationships of the data available of a dataset using RGCCA was established.
It simplifies the process and makes it easier to perform it.</p>
<p>The package consists of functions that can be grouped in three categories:</p>
<ul>
<li><p>To look for models and evaluate them.
There are functions to search for a model given some rules, that check them using leave-one-out methodology.</p></li>
<li><p>Reporting: To make better reports by improving handling of names or simplifying the objects or how to calculate scores.</p></li>
<li><p>Building: To easier build correct models on RGCCA, simplifying the process to create a symmetric matrix.</p></li>
</ul>
<p>Currently it is only available on github, so the number of downloads and usage is unknown but since its release a user has contacted to keep it up to date with development versions of RGCCA.
Which now it is compatible with the next release of <a href="https://github.com/rgcca-factory/RGCCA/tree/CRAN">RGCCA being prepared</a><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>.
Together with a copy of the RGCCA packages with more tests has enabled to identify changes on the RGCCA package that could affect users.</p>
</div>
</div>
<div id="analysis" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Analysis</h2>
<p>On the following sections the main results of analyzing each dataset are presented.</p>
<div id="results-puget" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Puget’s dataset</h3>
<p>On this dataset the different parameters and capabilities of RGCCA were tested.</p>
<p>The three different methods, centroid, factorial or horst were tested and compared.
The main result of this comparison was that the differences of the selection of the variables mattered more than the number of variables selected with each method.
The models were tested with different weights on all three schemes: horst, centroid and factorial.
The horst and the centroid scheme were similar while the factorial resulted in the most different AVE values (see <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0246367#pone.0246367.s001">S1 Data</a> of <span class="citation">[<a href="#ref-revilla2021" role="doc-biblioref">200</a>]</span>).
The centroid scheme was selected because it takes into account all the relationship regardless of the canonical correlation sign between the blocks and it is similarity to horst scheme.</p>
<p>The effect of the sparsity value was measured by its effect on the inner AVE scores and the combination of the different values for each block.</p>
<div class="figure"><span style="display:block;" id="fig:puget-tau2AVE"></span>
<img src="images/pugets_tau_to_AVE.png" alt="" />
<p class="caption">Figure 4.1:  Effect of tau on the inner AVE. The suggested tau value is the column between the regular grid.</p>
</div>
<p>Exploratory analysis with the superblock model was done.
The first two components of the superblock didn’t help to explain the biology or classify the tumors:</p>
<div class="figure"><span style="display:block;" id="fig:puget-superblock"></span>
<img src="images/pugets_superblock.png" alt="" />
<p class="caption">Figure 4.2:  First components of the superblock</p>
</div>
<p>The same data was used to look for a good model from the data itself including a model with a superblock but looking at the first component of the CGH and transcriptome block.
This allowed to visually inspect if each model’s components helped to classify the samples:</p>
<div class="figure"><span style="display:block;" id="fig:puget-models"></span>
<img src="images/pugets_models.png" alt="" />
<p class="caption">Figure 4.3:  Different models tried with the same data showing the first components of the CGH data and the transcriptome.</p>
</div>
<p>Showing the components of the CGH and the transcriptomics of the superblock show better classification than that of the superblock.
However the other models show a better classification of the samples with much simpler models.</p>
<!--# Slightly modified from the article!! -->
<p>To find these models the three blocks with the best tau and the centroid scheme were analyzed by changing the weights between 0 and 1 by 0.1 intervals.
According to the inner AVE, the best model was the one in which the weights (1) between the host transcriptome and location, (2) the host transcriptome and the CGH, and (3) the CGH block were linked to variables related to the location with weights of 1, 0.1 and 0.1, respectively.</p>
<p>When we added a superblock to the data, there was a slight increase of 0.01 on the inner AVE of the model.
The model with the superblock that explained most of the variance was that in which the weights of the interaction within (1) the host transcriptome, (2) between the superblock and the CGH, (3) between the host transcriptome and the localization, and (4) between CGH and the host transcriptome were 1, 1, 1 and 1/3, respectively.
To see if the superblock could classify the sample by location, we plotted the first two components of the superblock.</p>
<p>We can clearly see that they do not classify the samples according to the location of the tumor, which is known to affect the tumor phenotype <span class="citation">[<a href="#ref-puget2012" role="doc-biblioref">156</a>]</span>.</p>
<!--# TODO: Show plot of the superblock result -->
<p>Adding one block containing the age of the patient and the severity of the tumor to the model, decreased the inner AVE.
The best model with these blocks, according to the inner AVE, was that in which the interactions (1) within the host transcriptome, (2) between the host transcriptome and the localization, (3) between the host transcriptome and(4) the CGH and between the CGH and the other variables were 1, 1, 1/3 and 1/3, respectively.
The first components of each model can be seen in the figure:</p>
<div class="figure"><span style="display:block;" id="fig:puget-models-bis"></span>
<img src="images/pugets_models.png" alt="" />
<p class="caption">Figure 4.4:  Different models tried with the same data showing the first components of the CGH data and the transcriptome.</p>
</div>
<p>We can observe on the figure, the strong dependency between gene expression and location since the first model while the weaker relationship with the CGH assay <span class="citation">[<a href="#ref-puget2012" role="doc-biblioref">156</a>]</span>.
On the other hand, the major difference is the dispersion on the CGH component on each model.</p>
<p>The effect of the superblock and weights on different models to the inner AVE.
There are significant differences between having the superblock and not having it.</p>
<div class="figure"><span style="display:block;" id="fig:puget-weights"></span>
<img src="images/pugets-weights.png" alt="" />
<p class="caption">Figure 4.5:  Effect of superblock and weights on the inner AVE</p>
</div>
</div>
<div id="results-hsct" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> HSCT dataset</h3>
<p>The permanova analysis was performed on this dataset to estimate which were the variables that are more relevant.
From the many variables the location, sex, patient id and others were found to be related to the variability of the microbiome or the transcriptome on this dataset.</p>
<!--# From gourmiting 2 2018-03-13 -->
<p>With the permanova analysis we found that more of the 50% of the variance of normalized RNA-seq data and microbiome data respectively is explained by the variables of location, disease, sex, and the interaction between disease and sex.
On the transcriptome the most important factor is location which is more than 15% of the variance, while on the microbiome data the most important factor is the patient id followed by location of the sample.</p>
<!-- # Data on TRIM/intestinal_16S_RNAseq_metadb/models.RData and on TRIM/intestinal_16S_RNAseq_metadb/variance.R-->
<p><img src="images/hsct-adonis.png" /></p>
<!--# global test from the comments on TRIM/intestinal_16S_RNAseq_metadb/variance.R -->
<p>With globaltest the results were similar.
The resulting p-value was well below the 0,05 threshold defined for RNA-seq data on the models including the segment of the sample, sex and treatment.</p>
<p><img src="images/hsct-globaltest.png" /></p>
<p>On the microbiome data the results were similar but the p-value was considerably higher but still below the threshold.</p>
<!--# TODO: Include diversity index values -->
<div class="figure"><span style="display:block;" id="fig:hsct-diversity"></span>
<img src="images/hsct-ASV-diversity.png" alt="" />
<p class="caption">Figure 4.6:  Alpha diversity according to Shannon and Simpon effective measures</p>
</div>
<p>Diversity indices of the samples were explored and compared for several subsets.
Splitting by location of the sample and disease provided the highest differences and the diversity index along time did not change much.</p>
<!--# TODO: explain why WGCNA didn't work out -->
<p>Weighted gene co-expression network analysis did not provide relevant links between bacteria and transcriptome as it failed to find an acceptable scale free degree.</p>
<!--# TODO: explain why STATegRa didn't work out -->
<p>STATegRa didn’t show a value of, the assumption that there is a shared common factor without influence of other categorical variables was too much.
In addition, the model is fixed, so it didn’t allow to find new or other relationships that are not one to one.</p>
<p>With RGCCA we could select different models and use all the data available without much assumptions.
The models with the highest inner AVE of the family 1 and the family 2 models were similar to those on the Häsler dataset.
The weights of these models can be observed here:</p>
<!--# TODO: Show tables of the models -->
<p>The best model of the family 2 confirmed a relationship between the host transcriptome and the location-related variables, while the microbiome was associated with the demographic and location-related variables (see Figure and <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0246367#pone.0246367.s002">S2</a> data of <span class="citation">[<a href="#ref-revilla2021" role="doc-biblioref">200</a>]</span>).
Overall, we see that the relationships in the model affected the distribution of samples on the components of both the host transcriptome and the microbiome.</p>
<!--# TODO Add figure about the components on our own dataset -->
<p>The different models selected different variables, some of which are shared between models.
The most similar models are those that have split the metadata into 3 blocks, followed by those that have the metadata in a single block.</p>
<p>In order to analyze the accuracy of the models, one thousand bootstraps were used to integrate the data from the HSCT CD dataset.
Each bootstrap had its own dispersion on the variables according to the samples selected, the distribution of the bootstraps used are represented here:</p>
<div class="figure"><span style="display:block;" id="fig:hsct-bootstrap-quality"></span>
<img src="images/hsct-bootstrap-characteristics.png" alt="" />
<p class="caption">Figure 4.7:  Dispersion of the bootstraps on the age and percentage of colon and controls samples.</p>
</div>
<p>Evaluating the same model on each bootstrap lead to a dispersion on the inner AVE of the model.
The lower the dispersion, the more robust the model was to different conditions than in the initial testing.</p>
<div class="figure"><span style="display:block;" id="fig:hsct-bootstrap"></span>
<img src="images/hsct-bootstrap.png" alt="" />
<p class="caption">Figure 4.8:  The point with the black circle is the AVE of the original data. The dispersion is shown by the ellipses</p>
</div>
<p>With the bootstrapped models we used BaseSet to estimate the probability that each variable to be relevant for the association with a disease.
However, due to big amount of small probabilities when using the BaseSet package to calculate which variables are more relevant it couldn’t provide a good estimation on time.</p>
<p>MCIA was applied as a baseline of the integration, the first two components were represented similarly to those of the blocks when using RGCCA.</p>
<!--# TODO: Include plot with the result -->
<div class="figure"><span style="display:block;" id="fig:hsct-mcia"></span>
<img src="images/paper1_MCIA.png" alt="" />
<p class="caption">Figure 4.9:  MCIA first two synthetic variables on the IBD related cohorts.</p>
</div>
<p>The AUC of classifying the transcriptome in colon or ileum segments was compared between the two methods.</p>
<!--# TODO: Add plot of the comparison of AUC -->
<div class="figure"><span style="display:block;" id="fig:hsct-auc"></span>
<img src="images/paper1_MCIA.png" alt="" />
<p class="caption">Figure 4.10:  ROC curve of the different datasets with the models from RGCCA and the result with MCIA</p>
</div>
<p>The different models selected different variables as can be seen below:</p>
<div class="figure"><span style="display:block;" id="fig:hsct-features"></span>
<img src="images/hsct-features.png" alt="" />
<p class="caption">Figure 4.11:  Upset plot of the variables selected on each model showing the intersection between the different models</p>
</div>
</div>
<div id="results-hasler" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Häsler’s dataset</h3>
<p>In this dataset, the parameter tau behaved slightly differently than with the previous dataset but the value from the Schäfer’s method for tau was close to the best value.</p>
<!--# TODO: Show how different/what happened with tau -->
<p>In contrast to the HSCT’s dataset, the model with the highest inner AVE was model 1.2 (inner AVE value of ) but model 2.2 was close to it (inner AVE of ).
Model 2.2 has a relationship of 0.1 between microbiome and the host transcriptome and of 1 between the location and the host transcriptome.
The microbiome block is also related by a factor of 0.1 with the demographic block and of 1 with the time block.
Lastly, the time and the demographic block are related by a factor of a 0.1.
In either case the family 1 and family 2 models can correctly separate by sample location (colon or ileum) but not by disease type or inflammation status as can be seen below.</p>
<div class="figure"><span style="display:block;" id="fig:hasler-models"></span>
<img src="images/hasler-models.png" alt="" />
<p class="caption">Figure 4.12:  Models on the Häsler’s dataset</p>
</div>
<p>There is no observable cluster of IBD samples and the other samples, showing that on this dataset the differences of the microbiome between the different type of samples are less stark.</p>
<p>MCIA was applied as a baseline of the integration and compared to the different models to know which one separates best colon and ileum samples.</p>
<div class="figure"><span style="display:block;" id="fig:hasler-mcia"></span>
<img src="images/paper1_MCIA.png" alt="ROC curve of the different datasets with the models from RGCCA and the result with MCIA" />
<p class="caption">Figure 4.13:  ROC curve of the different datasets with the models from RGCCA and the result with MCIA</p>
</div>
<p>MCIA results was high but not as high as the model 2.2.</p>
</div>
<div id="results-morgan" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Morgan’s dataset</h3>
<p>We tested if results of inteRmodel were consistent on this dataset.
The different models weren’t able to separate the samples neither by location or sex.</p>
<div class="figure"><span style="display:block;" id="fig:morgan-models"></span>
<img src="images/morgans_models.png" alt="" />
<p class="caption">Figure 4.14:  First component of the transcriptome and microbiome of the Morgan’s dataset.</p>
</div>
<p>Nevertheless we compared the classification with the MCIA algorithm and still resulted that model 2.2 provide a better classification than MCIA.</p>
<p>When exploring the bootstraps of the data we found that model 1.2 is highly variable:</p>
<!--# TODO: MCIA plot-->
<div class="figure"><span style="display:block;" id="fig:morgan-bootstrap"></span>
<img src="images/morgans_bootstrap.png" alt="" />
<p class="caption">Figure 4.15:  Inner and outer AVE scores of the bootstrapped models.</p>
</div>
<p>In addition the model 2.2 usually has a lower inner AVE compared to model 1.2.</p>
<!--# TODO: AUC comparison of RGCCA and MCIA -->
</div>
<div id="results-barcelona" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> BARCELONA dataset</h3>
<p>This dataset was processed but the results are not trustable as the microbiome diversity falls off the accepted values.</p>
<p>Diversity plots</p>
<!--# TODO: Add plots of diversity -->
</div>
<div id="results-howell" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> Howell’s dataset</h3>
<p>This dataset was processed to confirm the results on the previous datasets.</p>
<p>Model 1.2 was the best according to the AVE score but perform worse when attempting to recreate known biological differences via classifying samples.
Model 2.2 was selected.</p>
<div class="figure"><span style="display:block;" id="fig:howell-models"></span>
<img src="images/howells_models.png" alt="" />
<p class="caption">Figure 4.16:  The three main models on the Howells dataset. Colored by section colon, ileum and shape according to the disease: square, ulcerative colitis; triangle, normal; circle, Crohn’s disease.</p>
</div>
<p>Model 1.2 has a 0.1 relationship between the ASV and the transcriptome and 1 between transcriptome and metadata.
While model 2.2 has a relationship of 1 between location and transcriptome and demographics and ASV but only of 0.1 between demographics and location.</p>
<div class="figure"><span style="display:block;" id="fig:howell-bootstrap"></span>
<img src="images/howells_models_bootstrap.png" alt="" />
<p class="caption">Figure 4.17:  Bootstrap of the different models.</p>
</div>
<p>The bootstrapping showed that model 1.2 has indeed higher inner AVE values than model 2.2 and is more stable than model 1.2.
While model 0 shows a high variation according to which samples are selected.</p>
<!--# TODO: show MCIA plots -->
<p>On this dataset we also focused on the most important ASV according to the model 2.2 that were present in more than 2 samples that in total were present in the whole dataset.
These ASV were summarized to a single value and then used to calculate the AUC, which was 0.85.
The dot product of the ASV and genes were also calculated and used to find out which ASV are related to which genes.</p>
<!--# TODO continue/fix this -->
</div>
<div id="results-hernandez" class="section level3" number="4.2.7">
<h3><span class="header-section-number">4.2.7</span> Hernández’ dataset</h3>
<p>This dataset was processed to confirm the results on the previous datasets.</p>
<p>The models are.
Model 1.2 is, model 2.2.</p>
<!--# TODO models -->
<!--# TODO: Bootstrap -->
<!--# TODO MCIA -->

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-puget2012" class="csl-entry">
156. Puget S, Philippe C, Bax DA, Job B, Varlet P, Junier M-P, et al. <a href="https://doi.org/10.1371/journal.pone.0030313">Mesenchymal Transition and PDGFRA Amplification/Mutation Are Key Distinct Oncogenic Events in Pediatric Diffuse Intrinsic Pontine Gliomas</a>. PLOS ONE. 2012;7:e30313.
</div>
<div id="ref-wickham2019" class="csl-entry">
199. Wickham H. <a href="https://adv-r.hadley.nz/index.html">Advanced r</a>. Second Edition. Boca Raton: Chapman &amp; Hall; 2019.
</div>
<div id="ref-revilla2021" class="csl-entry">
200. Revilla L, Mayorgas A, Corraliza AM, Masamunt MC, Metwaly A, Haller D, et al. <a href="https://doi.org/10.1371/journal.pone.0246367">Multi-omic modelling of inflammatory bowel disease with regularized canonical correlation analysis</a>. PLOS ONE. 2021;16:e0246367.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>S4 is one of the object programming paradigms on R.
For a more complete overview and differences see <a href="https://adv-r.hadley.nz/oo.html" title="2nd edition">Advanced R</a> <span class="citation">[<a href="#ref-wickham2019" role="doc-biblioref">199</a>]</span>.<a href="results-1.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>I also contributed with some comments and feedback to the package to make it easier to read the source and check the inputs and improve the documentation so that it is coherent with the code and previous results of the functions.<a href="results-1.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="materials-and-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="discussion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": {
"href": "https://github.com/llrs/thesis/"
},
"facebook": false,
"twitter": {
"href": "https://twitter.com/intent/tweet?text=Nice%20read%20of%20%40Lluis_Revilla%20thesis"
},
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/llrs/thesis/edit/master/04_results.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/llrs/thesis/blob/master/04_results.Rmd",
"text": "View"
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": false,
"toc_float": true,
"toc_appendix": true,
"toc_depth": 3,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
